angular.module("spicyTaste",["ngRoute","angular-md5","ngMaterial","ngAnimate","ngMessages"]).constant("CONSTANTS",{FB_APP_ID:0x58e0e66b31adc,FACEBOOK:"FB",EMAIL:"EMAIL",SOCIAL_PASS:"P@ssw0rd",LOCAL_STORAGE_KEY:"spicyTasteUser",LATEST_COUNT:10}),angular.module("spicyTaste").config(["$mdThemingProvider","$mdIconProvider",function(e,t){"use strict";var n=e.extendPalette("deep-orange",{500:"f27242"}),i=e.extendPalette("blue",{500:"6984b4",600:"6984b4"});e.definePalette("primaryOrange",n),e.definePalette("primaryBlue",i),e.theme("default").primaryPalette("primaryOrange").accentPalette("light-green"),e.theme("blue").primaryPalette("primaryBlue"),t.icon("menu","svg/ic_menu_24px.svg").icon("share","svg/ic_share_48px.svg").icon("login","svg/ic_account_circle_24px.svg").icon("recipes","svg/ic_event_note_48px.svg").icon("restaurants","svg/ic_restaurant_menu_48px.svg").icon("ingredients","svg/ic_receipt_48px.svg").icon("arrow","svg/ic_arrow_drop_up_48px.svg").icon("more","svg/ic_more_24px.svg").icon("time1","svg/ic_av_timer_24px.svg").icon("time2","svg/ic_access_time_24px.svg").icon("difficulty","svg/ic_track_changes_24px.svg").icon("exit","svg/ic_exit_to_app_48px.svg").icon("photo","svg/ic_mms_24px.svg").icon("check","svg/ic_check_circle_24px.svg").icon("facebook","svg/facebook.svg").icon("twitter","svg/twitter.svg").icon("pinterest","svg/pinterest.svg").icon("comments","svg/ic_chat_48px.svg").icon("menu","svg/ic_menu_48px.svg").icon("favorite","svg/ic_favorite_24px.svg").icon("delete","svg/ic_delete_48px.svg").icon("add","svg/ic_add_circle_outline_48px.svg").icon("arrow-down","svg/ic_expand_more_48px.svg")}]),angular.module("spicyTaste").run(["$rootScope","$location","$window","CONSTANTS","UserService",function(e,t,n,i,o){n.fbAsyncInit=function(){FB.init({appId:i.FB_APP_ID,cookie:!0,xfbml:!0,version:"v2.2"})},function(e,t,n){var i,o=e.getElementsByTagName(t)[0];e.getElementById(n)||(i=e.createElement(t),i.id=n,i.src="//connect.facebook.net/en_US/sdk.js",o.parentNode.insertBefore(i,o))}(document,"script","facebook-jssdk"),e.$on("$routeChangeStart",function(e,n){n.access&&o.authorize(n.access.requirePermissions).then(function(e){e||t.path("not-authorize").replace()})})}]),angular.module("spicyTaste").config(["$locationProvider","$routeProvider",function(e,t){e.html5Mode(!0),t.when("/",{templateUrl:"ng/views/pages/home.html",controller:"HomeController",controllerAs:"home"}).when("/dishes",{templateUrl:"ng/views/pages/dish/all.html",controller:"DishListController",controllerAs:"dishList"}).when("/dishes/:dish_id",{templateUrl:"ng/views/pages/dish/detail.html",controller:"DishDetailController",controllerAs:"dishDetail"}).when("/admin/dishes",{templateUrl:"ng/views/pages/admin/dish/list.html",controller:"DishListController",controllerAs:"dishList",access:{requirePermissions:["Admin"]}}).when("/admin/dishes/:dish_id",{templateUrl:"ng/views/pages/admin/dish/single.html",controller:"DishEditController",controllerAs:"dishManage",access:{requirePermissions:["Admin"]}}).when("/login",{templateUrl:"ng/views/pages/user/login.html",controller:"LoginController",controllerAs:"login"}).when("/me",{templateUrl:"ng/views/pages/user/me.html",controller:"ProfileController",controllerAs:"me"}).when("/not-authorize",{templateUrl:"ng/views/pages/not-authorize.html"})}]),angular.module("spicyTaste").controller("DishListController",["DishService","SocialService","$location",function(e,t,n){var i=this;e.all().success(function(e){i.dishes=e}),i.deleteDish=function(t){var n=i.dishes[t];e["delete"](n._id).success(function(e){i.dishes.splice(t,1)})},i.addDish=function(){e.create({name:"new dish"}).success(function(e){n.path("/admin/dishes/"+e.dish._id)})},i.goToEdit=function(e){n.path("/admin/dishes/"+e)}}]).controller("DishDetailController",["$scope","$location","$rootScope","$routeParams","$filter","$mdDialog","DishService","UserService","SocialService",function(e,t,n,i,o,s,r,c,l){function a(){h.dish={},h.relatedDishes={},r.get(i.dish_id).success(function(e){if(h.dish=e,h.dish.isCollected=!1,r.relate(h.dish._id,h.dish.tags,3).success(function(e){h.relatedDishes=e}),n.currentUser){var t=o("filter")(n.currentUser.favouriteDishes,{_id:h.dish._id},!0);t.length&&(h.dish.isCollected=!0)}})}function u(e,t,n){s.show({targetEvent:t,clickOutsideToClose:!0,templateUrl:"ng/views/dialogs/comment.html",locals:{title:e},controller:d,controllerAs:"comment"}).then(function(e){r.addComment(h.dish._id,{content:e,replyTo:n}).success(function(e){h.dish.comments.push(e)})})}function d(e,t){var n=this;n.content="",n.title=e,n.closeDialog=function(){t.cancel()},n.submit=function(){""==n.content.trim()?t.cancel():t.hide(n.content)}}var h=this;h.dish={},a(),h.enterFlipBook=function(e){s.show({targetEvent:e,clickOutsideToClose:!0,templateUrl:"ng/views/dialogs/flipbook.html",controller:"DishDetailController",controllerAs:"book"})["finally"](function(){n.shownBook=!1}),n.shownBook=!0},e.$on("onRepeatLast",function(e,t,n){angular.element(t).parents("#dishBook").booklet({width:"100%",height:600,closed:!0,autoCenter:!0,pageNumbers:!1,pagePadding:0,hoverWidth:100})}),h.closeDialog=function(){s.cancel()},h.fbShare=function(e){var n=t.absUrl()+"/"+e._id;l.fbShare(n)},h.reply=function(e,t){var n="@"+e.userName;u(n,t,e._id)},h.collect=function(t){n.currentUser?c.collect(h.dish._id).then(function(e){e.success&&(h.dish.isCollected=!0)}):e.showLoginDialog(t,!0,"Login/SignUp first to save as favorite").then(function(e){n.currentUser=e,c.collect(h.dish._id).then(function(e){e.success&&(h.dish.isCollected=!0)})})},h.showInstructionPhoto=function(e,t){null!=e&&""!=e.trim()&&s.show({targetEvent:t,clickOutsideToClose:!0,template:'<md-dialog><md-dialog-content><img src="{{photo}}"></md-dialog-content></md-dialog>',controller:["$scope",function(t){t.photo=e}]})},h.newComment=function(t){n.currentUser?u("Comment",t,null):e.showLoginDialog(t,!0,"Login/SignUp first to leave a comment").then(function(e){n.currentUser=e,u("Comment",t,null)})},d.$inject=["title","$mdDialog"]}]).controller("DishEditController",["$mdDialog","$routeParams","DishService","$location","$timeout",function(e,t,n,i,o){function s(e){var t=this;t.newPhoto="",t.closeDialog=function(){e.cancel()},t.submit=function(){e.hide(t.newPhoto)}}function r(e){var t=this;t.newInstruction={photo:"",text:""},t.closeDialog=function(){e.cancel()},t.submit=function(){e.hide(t.newInstruction)}}function c(){n.get(t.dish_id).success(function(e){l.dish=e}),l.difficulties=n.getDifficulties()}var l=this;c(),l.saveDish=function(){n.update(t.dish_id,l.dish).success(function(e){l.updateSuccess=!0,o(function(){l.updateSuccess=!1},1e3)})},l.removeInstruction=function(e){n.removeInstruction(t.dish_id,l.dish.instructions[e]._id).success(function(t){l.dish.instructions.splice(e,1)})},l.removePhoto=function(e){l.dish.photos.splice(e,1),l.saveDish()},l.showAddPhotoDialog=function(t){e.show({targetEvent:t,controller:s,controllerAs:"photoDlg",clickOutsideToClose:!0,templateUrl:"ng/views/dialogs/addPhoto.html"}).then(function(e){l.dish.photos.push(e),l.saveDish()})},l.showAddInstructionDialog=function(i){e.show({targetEvent:i,controller:r,controllerAs:"instructionDlg",clickOutsideToClose:!0,templateUrl:"ng/views/dialogs/addInstruction.html"}).then(function(e){l.dish.instructions.push(e),n.addInstruction(t.dish_id,e).success(function(e){})})},s.$inject=["$mdDialog"],r.$inject=["$mdDialog"]}]),angular.module("spicyTaste").controller("HomeController",["$scope","$mdMedia","DishService","CONSTANTS",function(e,t,n,i){function o(){r.recipeTiles=[],e.$watch(function(){return t("sm")},function(t){e.smallScreen=t}),s()}function s(){n.limit(i.LATEST_COUNT).success(function(e){angular.forEach(e,function(e,t){var n={image:e.imageUrl,title:e.name,id:e._id,prepTime:e.prepTime,totalTime:e.totalTime,difficulty:e.difficulty,tags:e.tags,span:{row:1,col:1}};switch(t+1){case 1:n.span.row=n.span.col=2;break;case 2:case 3:break;case 4:n.span.col=2;case 5:case 6:break;case 7:n.span.row=n.span.col=2;case 8:case 9:break;case 10:n.span.col=2}r.recipeTiles.push(n)})})}var r=this;o()}]),angular.module("spicyTaste").controller("MainController",["$rootScope","$scope","$location","$mdDialog","$http","SessionService","UserService","CONSTANTS",function(e,t,n,i,o,s,r,c){"use strict";function l(e,t,n,i){function r(e){var n=o.defaults.headers.common["X-Auth"];s.setLocal(c.LOCAL_STORAGE_KEY,n),t.hide(e)}var l=this;l.title=e,l.email="",l.password="",l.userName="",l.fbLogin=function(){FB.login(function(e){"connected"===e.status?FB.api("/me",function(e){var t={userName:e.name,email:e.email,password:c.SOCIAL_PASS,photoUrl:"http://graph.facebook.com/"+e.id+"/picture?type=large",linkedSocial:c.FACEBOOK};n.socialLogin(t).then(function(e){e.loginType=c.FACEBOOK,r(e)})}):"not_authorized"===e.status},{scope:"public_profile,email"})},l.login=function(){n.login(l.email,l.password).then(function(e){e.loginType=c.EMAIL,r(e)})},l.signUp=function(){var e={userName:l.userName,email:l.email,password:l.password,photoUrl:"http://www.gravatar.com/avatar/"+i.createHash(l.email),linkedSocial:c.EMAIL};n.create(e).then(function(e){e.loginType=c.EMAIL,r(e)})}}function a(){u.showMobileMenu=!1,u.scrollTargetReached=!1;var t=s.getLocal(c.LOCAL_STORAGE_KEY);t&&(console.log("token",t),o.defaults.headers.common["X-Auth"]=t,r.getCurrentUser().then(function(t){e.currentUser=t}))}var u=this;a(),u.toggleMobileMenu=function(){u.showMobileMenu=!u.showMobileMenu},t.setScrollReached=function(e){console.log("setScrollReached called",e),u.scrollTargetReached=e},t.showLoginDialog=function(t,n,o){var s=i.show({clickOutsideToClose:!0,templateUrl:"ng/views/dialogs/login.html",targetEvent:t,controller:l,controllerAs:"login",locals:{dialogTitle:o}});return n?s:void s.then(function(t){e.currentUser=t})},l.$inject=["dialogTitle","$mdDialog","UserService","md5"]}]),angular.module("spicyTaste").controller("ProfileController",["$location","$rootScope","UserService",function(e,t,n){"use strict";function i(){o.user={},n.getById(t.currentUser._id).then(function(e){o.user=e})}var o=this;i(),o.logout=function(){n.logout(),t.currentUser=null,e.path("/")}}]),angular.module("spicyTaste").directive("contenteditable",function(){return{require:"ngModel",restrict:"A",link:function(e,t,n,i){i.$render=function(){t.html(i.$viewValue||"")},t.bind("blur",function(){e.$apply(function(){i.$setViewValue(t.html())})})}}}),angular.module("spicyTaste").directive("flipbook",function(){return{transclude:!1,restrict:"E",replace:!0,templateUrl:"ng/views/templates/flipbook.html",scope:{dish:"="}}}),angular.module("spicyTaste").directive("focusOn",function(){return{restrict:"A",scope:{focusValue:"=focusOn"},link:function(e,t){e.$watch("focusValue",function(e,n){e&&!n&&t[0].focus()})}}}),angular.module("spicyTaste").directive("onLastRepeat",["$timeout",function(e){return function(t,n,i){t.$last&&e(function(){t.$emit("onRepeatLast",n,i)},0)}}]),angular.module("spicyTaste").directive("scrollReached",["$window",function(e){"use strict";return{restrict:"A",scope:!0,link:function(t,n,i){var o=n.offset().top-64;angular.element(e).on("scroll",function(){t.setScrollReached(this.pageYOffset>=o?!0:!1),t.$apply()})}}}]),angular.module("spicyTaste").directive("scrollTo",function(){return{restrict:"A",link:function(e,t,n){var i=$(n.scrollTo);t.on("click",function(){$("html, body").animate({scrollTop:i.offset().top},600)})}}}),angular.module("spicyTaste").factory("DishService",["$http",function(e){var t={};return t.all=function(){return e.get("/api/dishes")},t.limit=function(t){return e.get("/api/dishes?limit="+t)},t.relate=function(t,n,i){return e({method:"GET",url:"/api/dishes",params:{id:t,limit:i,"tags[]":n}})},t.create=function(t){return e.post("/api/dishes",t)},t.get=function(t){return e.get("/api/dishes/"+t)},t.update=function(t,n){return e.put("/api/dishes/"+t,n)},t["delete"]=function(t){return e["delete"]("/api/dishes/"+t)},t.addComment=function(t,n){return e.post("/api/dishes/"+t+"/comments",n)},t.addInstruction=function(t,n){return e.post("/api/dishes/"+t+"/instructions",n)},t.removeInstruction=function(t,n){return e["delete"]("/api/dishes/"+t+"/instructions/"+n)},t.getDifficulties=function(){return["初学","容易","一般","较难","专业"]},t}]),angular.module("spicyTaste").factory("SessionService",["$window",function(e){var t={};return t.getLocal=function(t){if(e.localStorage){var n=e.localStorage.getItem(t);return angular.fromJson(n)}return!1},t.setLocal=function(t,n){return e.localStorage&&e.localStorage.setItem(t,angular.toJson(n))},t}]),angular.module("spicyTaste").factory("SocialService",function(){var e={};return e.fbShare=function(e){FB.ui({method:"share",href:e},function(e){})},e}),angular.module("spicyTaste").factory("UserService",["$http","$rootScope","$window","CONSTANTS",function(e,t,n,i){"use strict";var o={};return o.socialLogin=function(e){return o.searchBy("email="+e.email).then(function(t){return t.success?o.login(e.email,i.SOCIAL_PASS):o.create(e)})},o.login=function(t,n){return e.post("/api/auth",{email:t,password:n}).then(function(t){return e.defaults.headers.common["X-Auth"]=t.data.token,o.getById(t.data.userId)})},o.logout=function(){delete e.defaults.headers.common["X-Auth"],n.localStorage.removeItem(i.LOCAL_STORAGE_KEY),o.loginedUser=null},o.searchBy=function(t){return e.get("/api/users?"+t).then(function(e){return e.data})},o.getCurrentUser=function(){return e.get("/api/me").then(function(e){return o.getById(e.data)})},o.getById=function(t){return e.get("/api/users/"+t).then(function(e){return e.data})},o.create=function(t){return e.post("/api/users/",t).then(function(){return o.login(t.email,t.password)})},o.update=function(t){return e.put("/api/users/"+t.user_id,t).then(function(e){return e.data})},o.collect=function(n){return e.put("/api/users/"+t.currentUser._id+"/dishes/"+n).then(function(e){return e.data})},o.authorize=function(e){return o.getCurrentUser().then(function(t){return t&&e.indexOf(t.role)>=0?!0:!1},function(e){return!1})},o}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsImRlc2lnbi5qcyIsIm1vZHVsZS5ydW4uanMiLCJyb3V0ZXMuanMiLCJjb250cm9sbGVycy9kaXNoQ29udHJvbGxlci5qcyIsImFwcC5qcyIsImNvbnRyb2xsZXJzL2hvbWVDb250cm9sbGVyLmpzIiwiY29udHJvbGxlcnMvbWFpbkNvbnRyb2xsZXIuanMiLCJjb250cm9sbGVycy9wcm9maWxlQ29udHJvbGxlci5qcyIsImRpcmVjdGl2ZXMvY29udGVudGVkaXRhYmxlRGlyZWN0aXZlLmpzIiwiZGlyZWN0aXZlcy9mbGlwQm9va0RpcmVjdGl2ZS5qcyIsImRpcmVjdGl2ZXMvZm9jdXNPbkRpcmVjdGl2ZS5qcyIsImRpcmVjdGl2ZXMvb25MYXN0UmVwZWF0LmpzIiwiZGlyZWN0aXZlcy9zY3JvbGxSZWFjaGVkRGlyZWN0aXZlLmpzIiwiZGlyZWN0aXZlcy9zY3JvbGxUb0RpcmVjdGl2ZS5qcyIsInNlcnZpY2VzL2Rpc2hTZXJ2aWNlLmpzIiwic2VydmljZXMvc2Vzc2lvblNlcnZpY2UuanMiLCJzZXJ2aWNlcy9zb2NpYWxTZXJ2aWNlLmpzIiwic2VydmljZXMvdXNlclNlcnZpY2UuanMiXSwibmFtZXMiOlsiYW5ndWxhciIsIm1vZHVsZSIsImNvbnN0YW50IiwiRkJfQVBQX0lEIiwiRkFDRUJPT0siLCJFTUFJTCIsIlNPQ0lBTF9QQVNTIiwiTE9DQUxfU1RPUkFHRV9LRVkiLCJMQVRFU1RfQ09VTlQiLCJjb25maWciLCIkbWRUaGVtaW5nUHJvdmlkZXIiLCIkbWRJY29uUHJvdmlkZXIiLCJwcmltYXJ5T3JhbmdlIiwiZXh0ZW5kUGFsZXR0ZSIsIjUwMCIsInByaW1hcnlCbHVlIiwiNjAwIiwiZGVmaW5lUGFsZXR0ZSIsInRoZW1lIiwicHJpbWFyeVBhbGV0dGUiLCJhY2NlbnRQYWxldHRlIiwiaWNvbiIsInJ1biIsIiRyb290U2NvcGUiLCIkbG9jYXRpb24iLCIkd2luZG93IiwiQ09OU1RBTlRTIiwiVXNlclNlcnZpY2UiLCJmYkFzeW5jSW5pdCIsIkZCIiwiaW5pdCIsImFwcElkIiwiY29va2llIiwieGZibWwiLCJ2ZXJzaW9uIiwiZCIsInMiLCJpZCIsImpzIiwiZmpzIiwiZ2V0RWxlbWVudHNCeVRhZ05hbWUiLCJnZXRFbGVtZW50QnlJZCIsImNyZWF0ZUVsZW1lbnQiLCJzcmMiLCJwYXJlbnROb2RlIiwiaW5zZXJ0QmVmb3JlIiwiZG9jdW1lbnQiLCIkb24iLCJldmVudCIsIm5leHQiLCJhY2Nlc3MiLCJhdXRob3JpemUiLCJyZXF1aXJlUGVybWlzc2lvbnMiLCJ0aGVuIiwicmVzdWx0IiwicGF0aCIsInJlcGxhY2UiLCIkbG9jYXRpb25Qcm92aWRlciIsIiRyb3V0ZVByb3ZpZGVyIiwiaHRtbDVNb2RlIiwid2hlbiIsInRlbXBsYXRlVXJsIiwiY29udHJvbGxlciIsImNvbnRyb2xsZXJBcyIsIkRpc2hTZXJ2aWNlIiwiU29jaWFsU2VydmljZSIsInZtIiwidGhpcyIsImFsbCIsInN1Y2Nlc3MiLCJkYXRhIiwiZGlzaGVzIiwiZGVsZXRlRGlzaCIsImluZGV4IiwiZGlzaCIsIl9pZCIsInNwbGljZSIsImFkZERpc2giLCJjcmVhdGUiLCJuYW1lIiwiZ29Ub0VkaXQiLCIkc2NvcGUiLCIkcm91dGVQYXJhbXMiLCIkZmlsdGVyIiwiJG1kRGlhbG9nIiwicmVsYXRlZERpc2hlcyIsImdldCIsImRpc2hfaWQiLCJpc0NvbGxlY3RlZCIsInJlbGF0ZSIsInRhZ3MiLCJjdXJyZW50VXNlciIsImZvdW5kIiwiZmF2b3VyaXRlRGlzaGVzIiwibGVuZ3RoIiwib3BlbkNvbW1lbnREaWFsb2ciLCJ0aXRsZSIsIiRldmVudCIsInJlcGx5VG8iLCJzaG93IiwidGFyZ2V0RXZlbnQiLCJjbGlja091dHNpZGVUb0Nsb3NlIiwibG9jYWxzIiwiY29tbWVudENvbnRyb2xsZXIiLCJjb250ZW50IiwiYWRkQ29tbWVudCIsImNvbW1lbnQiLCJjb21tZW50cyIsInB1c2giLCJkdm0iLCJjbG9zZURpYWxvZyIsImNhbmNlbCIsInN1Ym1pdCIsInRyaW0iLCJoaWRlIiwiZW50ZXJGbGlwQm9vayIsImV2biIsInNob3duQm9vayIsInNjb3BlIiwiZWxlbWVudCIsImF0dHJzIiwicGFyZW50cyIsImJvb2tsZXQiLCJ3aWR0aCIsImhlaWdodCIsImNsb3NlZCIsImF1dG9DZW50ZXIiLCJwYWdlTnVtYmVycyIsInBhZ2VQYWRkaW5nIiwiaG92ZXJXaWR0aCIsImZiU2hhcmUiLCJkaXNoTGluayIsImFic1VybCIsInJlcGx5IiwidXNlciIsImNvbW1lbnRUaXRsZSIsInVzZXJOYW1lIiwiY29sbGVjdCIsInNob3dMb2dpbkRpYWxvZyIsInNob3dJbnN0cnVjdGlvblBob3RvIiwicGhvdG9VcmwiLCJ0ZW1wbGF0ZSIsInBob3RvIiwibmV3Q29tbWVudCIsIiRpbmplY3QiLCIkdGltZW91dCIsInBob3RvRGlhbG9nQ29udHJvbGxlciIsIm5ld1Bob3RvIiwiaW5zdHJ1Y3Rpb25EaWFsb2dDb250cm9sbGVyIiwibmV3SW5zdHJ1Y3Rpb24iLCJ0ZXh0IiwiZGlmZmljdWx0aWVzIiwiZ2V0RGlmZmljdWx0aWVzIiwic2F2ZURpc2giLCJ1cGRhdGUiLCJ1cGRhdGVTdWNjZXNzIiwicmVtb3ZlSW5zdHJ1Y3Rpb24iLCJpbnN0cnVjdGlvbnMiLCJyZW1vdmVQaG90byIsInBob3RvcyIsInNob3dBZGRQaG90b0RpYWxvZyIsInNob3dBZGRJbnN0cnVjdGlvbkRpYWxvZyIsImFkZEluc3RydWN0aW9uIiwiJG1kTWVkaWEiLCJyZWNpcGVUaWxlcyIsIiR3YXRjaCIsImlzU21hbGwiLCJzbWFsbFNjcmVlbiIsImJ1aWxkR3JpZCIsImxpbWl0IiwiZm9yRWFjaCIsInRpbGUiLCJpbWFnZSIsImltYWdlVXJsIiwicHJlcFRpbWUiLCJ0b3RhbFRpbWUiLCJkaWZmaWN1bHR5Iiwic3BhbiIsInJvdyIsImNvbCIsIiRodHRwIiwiU2Vzc2lvblNlcnZpY2UiLCJsb2dpbkNvbnRyb2xsZXIiLCJkaWFsb2dUaXRsZSIsIm1kNSIsImFmdGVyQXV0aCIsInRva2VuIiwiZGVmYXVsdHMiLCJoZWFkZXJzIiwiY29tbW9uIiwic2V0TG9jYWwiLCJlbWFpbCIsInBhc3N3b3JkIiwiZmJMb2dpbiIsImxvZ2luIiwicmVzcG9uc2UiLCJzdGF0dXMiLCJhcGkiLCJmYlVzZXIiLCJsaW5rZWRTb2NpYWwiLCJzb2NpYWxMb2dpbiIsImxvZ2luVHlwZSIsInNpZ25VcCIsIm5ld1VzZXIiLCJjcmVhdGVIYXNoIiwic2hvd01vYmlsZU1lbnUiLCJzY3JvbGxUYXJnZXRSZWFjaGVkIiwibG9naW5lZFRva2VuIiwiZ2V0TG9jYWwiLCJjb25zb2xlIiwibG9nIiwiZ2V0Q3VycmVudFVzZXIiLCJ0b2dnbGVNb2JpbGVNZW51Iiwic2V0U2Nyb2xsUmVhY2hlZCIsImZsYWciLCJldiIsInBvc3RMb2dpbiIsInByb21pc2UiLCJnZXRCeUlkIiwibG9nb3V0IiwiZGlyZWN0aXZlIiwicmVxdWlyZSIsInJlc3RyaWN0IiwibGluayIsImF0dHJpYnV0cyIsIm5nTW9kZWwiLCIkcmVuZGVyIiwiaHRtbCIsIiR2aWV3VmFsdWUiLCJiaW5kIiwiJGFwcGx5IiwiJHNldFZpZXdWYWx1ZSIsInRyYW5zY2x1ZGUiLCJmb2N1c1ZhbHVlIiwiJGVsZW1lbnQiLCJjdXJyZW50VmFsdWUiLCJwcmV2aW91c1ZhbHVlIiwiZm9jdXMiLCIkYXR0cnMiLCIkbGFzdCIsIiRlbWl0Iiwib2Zmc2V0IiwidG9wIiwib24iLCJwYWdlWU9mZnNldCIsIiR0YXJnZXQiLCIkIiwic2Nyb2xsVG8iLCJhbmltYXRlIiwic2Nyb2xsVG9wIiwiZmFjdG9yeSIsImRpc2hGYWN0b3J5IiwibnVtIiwibWV0aG9kIiwidXJsIiwicGFyYW1zIiwidGFnc1tdIiwicG9zdCIsInB1dCIsImluc3RydWN0aW9uIiwiaW5zdHJ1Y3Rpb25faWQiLCJzZXNzaW9uRmFjdG9yeSIsImtleSIsImxvY2FsU3RvcmFnZSIsImdldEl0ZW0iLCJmcm9tSnNvbiIsInNldEl0ZW0iLCJ0b0pzb24iLCJzb2NpYWxGYWN0b3J5IiwidWkiLCJocmVmIiwidXNlckZhY3RvcnkiLCJzb2NpYWxVc2VyIiwic2VhcmNoQnkiLCJ1c2VySWQiLCJyZW1vdmVJdGVtIiwibG9naW5lZFVzZXIiLCJxdWVyeSIsInVzZXJfaWQiLCJpbmRleE9mIiwicm9sZSJdLCJtYXBwaW5ncyI6IkFBQUFBLFFBQUFDLE9BQUEsY0FBQSxVQUFBLGNBQUEsYUFBQSxZQUFBLGVBQ0FDLFNBQUEsYUFDQUMsVUFBQSxnQkFDQUMsU0FBQSxLQUNBQyxNQUFBLFFBQ0FDLFlBQUEsV0FDQUMsa0JBQUEsaUJBQ0FDLGFBQUEsS0NQQVIsUUFBQUMsT0FBQSxjQUNBUSxRQUFBLHFCQUFBLGtCQUFBLFNBQUFDLEVBQUFDLEdBQ0EsWUFFQSxJQUFBQyxHQUFBRixFQUFBRyxjQUFBLGVBQ0FDLElBQUEsV0FHQUMsRUFBQUwsRUFBQUcsY0FBQSxRQUNBQyxJQUFBLFNBQ0FFLElBQUEsVUFHQU4sR0FBQU8sY0FBQSxnQkFBQUwsR0FDQUYsRUFBQU8sY0FBQSxjQUFBRixHQUVBTCxFQUFBUSxNQUFBLFdBQ0FDLGVBQUEsaUJBQ0FDLGNBQUEsZUFFQVYsRUFBQVEsTUFBQSxRQUNBQyxlQUFBLGVBRUFSLEVBQUFVLEtBQUEsT0FBQSx3QkFDQUEsS0FBQSxRQUFBLHlCQUNBQSxLQUFBLFFBQUEsa0NBQ0FBLEtBQUEsVUFBQSw4QkFDQUEsS0FBQSxjQUFBLG1DQUNBQSxLQUFBLGNBQUEsMkJBQ0FBLEtBQUEsUUFBQSxpQ0FDQUEsS0FBQSxPQUFBLHdCQUNBQSxLQUFBLFFBQUEsNEJBQ0FBLEtBQUEsUUFBQSwrQkFDQUEsS0FBQSxhQUFBLGlDQUNBQSxLQUFBLE9BQUEsK0JBQ0FBLEtBQUEsUUFBQSx1QkFDQUEsS0FBQSxRQUFBLGdDQUNBQSxLQUFBLFdBQUEsb0JBQ0FBLEtBQUEsVUFBQSxtQkFDQUEsS0FBQSxZQUFBLHFCQUNBQSxLQUFBLFdBQUEsd0JBQ0FBLEtBQUEsT0FBQSx3QkFDQUEsS0FBQSxXQUFBLDRCQUNBQSxLQUFBLFNBQUEsMEJBQ0FBLEtBQUEsTUFBQSxzQ0FDQUEsS0FBQSxhQUFBLGtDQzdDQXJCLFFBQUFDLE9BQUEsY0FDQXFC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QUFBbEQsR0FDQSxNQUFBNkYsR0FBQThFLElBQUEsY0FBQTNPLEVBQUFvRSxZQUFBaEIsSUFBQSxXQUFBWSxHQUFBbEMsS0FBQSxTQUFBOEksR0FDQSxNQUFBQSxHQUFBN0gsUUFLQXlNLEVBQUE1TixVQUFBLFNBQUFDLEdBQ0EsTUFBQTJOLEdBQUE1RCxpQkFBQTlKLEtBQUEsU0FBQWlGLEdBQ0EsTUFBQUEsSUFBQWxGLEVBQUFtTyxRQUFBakosRUFBQWtKLE9BQUEsR0FDQSxHQUVBLEdBRUEsU0FBQXJGLEdBQ0EsT0FBQSxLQUlBNEUiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiYW5ndWxhci5tb2R1bGUoJ3NwaWN5VGFzdGUnLCBbJ25nUm91dGUnLCAnYW5ndWxhci1tZDUnLCAnbmdNYXRlcmlhbCcsICduZ0FuaW1hdGUnLCAnbmdNZXNzYWdlcyddKVxuICAgIC5jb25zdGFudCgnQ09OU1RBTlRTJywge1xuICAgICAgICBcIkZCX0FQUF9JRFwiOiAxNTYzNTY3Mzg3MjUzNDY4LFxuICAgICAgICBcIkZBQ0VCT09LXCI6IFwiRkJcIixcbiAgICAgICAgXCJFTUFJTFwiOiBcIkVNQUlMXCIsXG4gICAgICAgIFwiU09DSUFMX1BBU1NcIjogXCJQQHNzdzByZFwiLFxuICAgICAgICBcIkxPQ0FMX1NUT1JBR0VfS0VZXCI6IFwic3BpY3lUYXN0ZVVzZXJcIixcbiAgICAgICAgXCJMQVRFU1RfQ09VTlRcIjogMTBcbiAgICB9KTtcbiIsImFuZ3VsYXIubW9kdWxlKCdzcGljeVRhc3RlJylcbiAgICAuY29uZmlnKGZ1bmN0aW9uKCRtZFRoZW1pbmdQcm92aWRlciwgJG1kSWNvblByb3ZpZGVyKSB7XG4gICAgICAgICd1c2Ugc3RyaWN0JztcblxuICAgICAgICB2YXIgcHJpbWFyeU9yYW5nZSA9ICRtZFRoZW1pbmdQcm92aWRlci5leHRlbmRQYWxldHRlKCdkZWVwLW9yYW5nZScsIHtcbiAgICAgICAgICAgICc1MDAnOiAnZjI3MjQyJ1xuICAgICAgICB9KTtcblxuICAgICAgICB2YXIgcHJpbWFyeUJsdWUgPSAkbWRUaGVtaW5nUHJvdmlkZXIuZXh0ZW5kUGFsZXR0ZSgnYmx1ZScsIHtcbiAgICAgICAgICAgICc1MDAnOiAnNjk4NGI0JyxcbiAgICAgICAgICAgICc2MDAnOiAnNjk4NGI0J1xuICAgICAgICB9KTtcblxuICAgICAgICAkbWRUaGVtaW5nUHJvdmlkZXIuZGVmaW5lUGFsZXR0ZSgncHJpbWFyeU9yYW5nZScsIHByaW1hcnlPcmFuZ2UpO1xuICAgICAgICAkbWRUaGVtaW5nUHJvdmlkZXIuZGVmaW5lUGFsZXR0ZSgncHJpbWFyeUJsdWUnLCBwcmltYXJ5Qmx1ZSk7XG5cbiAgICAgICAgJG1kVGhlbWluZ1Byb3ZpZGVyLnRoZW1lKCdkZWZhdWx0JylcbiAgICAgICAgICAgIC5wcmltYXJ5UGFsZXR0ZSgncHJpbWFyeU9yYW5nZScpXG4gICAgICAgICAgICAuYWNjZW50UGFsZXR0ZSgnbGlnaHQtZ3JlZW4nKTtcblxuICAgICAgICAkbWRUaGVtaW5nUHJvdmlkZXIudGhlbWUoJ2JsdWUnKVxuICAgICAgICAgICAgLnByaW1hcnlQYWxldHRlKCdwcmltYXJ5Qmx1ZScpO1xuXG4gICAgICAgICRtZEljb25Qcm92aWRlci5pY29uKCdtZW51JywgJ3N2Zy9pY19tZW51XzI0cHguc3ZnJylcbiAgICAgICAgICAgIC5pY29uKCdzaGFyZScsICdzdmcvaWNfc2hhcmVfNDhweC5zdmcnKVxuICAgICAgICAgICAgLmljb24oJ2xvZ2luJywgJ3N2Zy9pY19hY2NvdW50X2NpcmNsZV8yNHB4LnN2ZycpXG4gICAgICAgICAgICAuaWNvbigncmVjaXBlcycsICdzdmcvaWNfZXZlbnRfbm90ZV80OHB4LnN2ZycpXG4gICAgICAgICAgICAuaWNvbigncmVzdGF1cmFudHMnLCAnc3ZnL2ljX3Jlc3RhdXJhbnRfbWVudV80OHB4LnN2ZycpXG4gICAgICAgICAgICAuaWNvbignaW5ncmVkaWVudHMnLCAnc3ZnL2ljX3JlY2VpcHRfNDhweC5zdmcnKVxuICAgICAgICAgICAgLmljb24oJ2Fycm93JywgJ3N2Zy9pY19hcnJvd19kcm9wX3VwXzQ4cHguc3ZnJylcbiAgICAgICAgICAgIC5pY29uKCdtb3JlJywgJ3N2Zy9pY19tb3JlXzI0cHguc3ZnJylcbiAgICAgICAgICAgIC5pY29uKCd0aW1lMScsICdzdmcvaWNfYXZfdGltZXJfMjRweC5zdmcnKVxuICAgICAgICAgICAgLmljb24oJ3RpbWUyJywgJ3N2Zy9pY19hY2Nlc3NfdGltZV8yNHB4LnN2ZycpXG4gICAgICAgICAgICAuaWNvbignZGlmZmljdWx0eScsICdzdmcvaWNfdHJhY2tfY2hhbmdlc18yNHB4LnN2ZycpXG4gICAgICAgICAgICAuaWNvbignZXhpdCcsICdzdmcvaWNfZXhpdF90b19hcHBfNDhweC5zdmcnKVxuICAgICAgICAgICAgLmljb24oJ3Bob3RvJywgJ3N2Zy9pY19tbXNfMjRweC5zdmcnKVxuICAgICAgICAgICAgLmljb24oJ2NoZWNrJywgJ3N2Zy9pY19jaGVja19jaXJjbGVfMjRweC5zdmcnKVxuICAgICAgICAgICAgLmljb24oJ2ZhY2Vib29rJywgJ3N2Zy9mYWNlYm9vay5zdmcnKVxuICAgICAgICAgICAgLmljb24oJ3R3aXR0ZXInLCAnc3ZnL3R3aXR0ZXIuc3ZnJylcbiAgICAgICAgICAgIC5pY29uKCdwaW50ZXJlc3QnLCAnc3ZnL3BpbnRlcmVzdC5zdmcnKVxuICAgICAgICAgICAgLmljb24oJ2NvbW1lbnRzJywgJ3N2Zy9pY19jaGF0XzQ4cHguc3ZnJylcbiAgICAgICAgICAgIC5pY29uKCdtZW51JywgJ3N2Zy9pY19tZW51XzQ4cHguc3ZnJylcbiAgICAgICAgICAgIC5pY29uKCdmYXZvcml0ZScsICdzdmcvaWNfZmF2b3JpdGVfMjRweC5zdmcnKVxuICAgICAgICAgICAgLmljb24oJ2RlbGV0ZScsICdzdmcvaWNfZGVsZXRlXzQ4cHguc3ZnJylcbiAgICAgICAgICAgIC5pY29uKCdhZGQnLCAnc3ZnL2ljX2FkZF9jaXJjbGVfb3V0bGluZV80OHB4LnN2ZycpXG4gICAgICAgICAgICAuaWNvbignYXJyb3ctZG93bicsICdzdmcvaWNfZXhwYW5kX21vcmVfNDhweC5zdmcnKTtcbiAgICB9KTtcbiIsImFuZ3VsYXIubW9kdWxlKCdzcGljeVRhc3RlJylcbiAgICAucnVuKGZ1bmN0aW9uKCRyb290U2NvcGUsICRsb2NhdGlvbiwgJHdpbmRvdywgQ09OU1RBTlRTLCBVc2VyU2VydmljZSkge1xuICAgICAgICAkd2luZG93LmZiQXN5bmNJbml0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBGQi5pbml0KHtcbiAgICAgICAgICAgICAgICBhcHBJZDogQ09OU1RBTlRTLkZCX0FQUF9JRCxcbiAgICAgICAgICAgICAgICBjb29raWU6IHRydWUsIC8vIGVuYWJsZSBjb29raWVzIHRvIGFsbG93IHRoZSBzZXJ2ZXIgdG8gYWNjZXNzIHRoZSBzZXNzaW9uXG4gICAgICAgICAgICAgICAgeGZibWw6IHRydWUsIC8vIHBhcnNlIHNvY2lhbCBwbHVnaW5zIG9uIHRoaXMgcGFnZVxuICAgICAgICAgICAgICAgIHZlcnNpb246ICd2Mi4yJyAvLyB1c2UgdmVyc2lvbiAyLjJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vIExvYWQgdGhlIFNESyBhc3luY2hyb25vdXNseVxuICAgICAgICAoZnVuY3Rpb24oZCwgcywgaWQpIHtcbiAgICAgICAgICAgIHZhciBqcywgZmpzID0gZC5nZXRFbGVtZW50c0J5VGFnTmFtZShzKVswXTtcbiAgICAgICAgICAgIGlmIChkLmdldEVsZW1lbnRCeUlkKGlkKSkgcmV0dXJuO1xuICAgICAgICAgICAganMgPSBkLmNyZWF0ZUVsZW1lbnQocyk7XG4gICAgICAgICAgICBqcy5pZCA9IGlkO1xuICAgICAgICAgICAganMuc3JjID0gXCIvL2Nvbm5lY3QuZmFjZWJvb2submV0L2VuX1VTL3Nkay5qc1wiO1xuICAgICAgICAgICAgZmpzLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGpzLCBmanMpO1xuICAgICAgICB9KGRvY3VtZW50LCAnc2NyaXB0JywgJ2ZhY2Vib29rLWpzc2RrJykpO1xuXG4gICAgICAgIC8vQ2hlY2sgQXV0aG9yaXphdGlvblxuICAgICAgICAkcm9vdFNjb3BlLiRvbignJHJvdXRlQ2hhbmdlU3RhcnQnLCBmdW5jdGlvbihldmVudCwgbmV4dCl7XG4gICAgICAgICAgICBpZihuZXh0LmFjY2Vzcyl7XG4gICAgICAgICAgICAgICAgVXNlclNlcnZpY2UuYXV0aG9yaXplKG5leHQuYWNjZXNzLnJlcXVpcmVQZXJtaXNzaW9ucykudGhlbihmdW5jdGlvbihyZXN1bHQpe1xuICAgICAgICAgICAgICAgICAgICBpZighcmVzdWx0KVxuICAgICAgICAgICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoJ25vdC1hdXRob3JpemUnKS5yZXBsYWNlKCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgfSk7XG4iLCJhbmd1bGFyLm1vZHVsZSgnc3BpY3lUYXN0ZScpXG4gICAgLmNvbmZpZyhmdW5jdGlvbigkbG9jYXRpb25Qcm92aWRlciwgJHJvdXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJGxvY2F0aW9uUHJvdmlkZXIuaHRtbDVNb2RlKHRydWUpO1xuXG4gICAgICAgICRyb3V0ZVByb3ZpZGVyXG4gICAgICAgIC8vaG9tZSBwYWdlXG4gICAgICAgICAgICAud2hlbignLycsIHtcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25nL3ZpZXdzL3BhZ2VzL2hvbWUuaHRtbCcsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ0hvbWVDb250cm9sbGVyJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6ICdob21lJ1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC8vc2hvdyBhbGwgZGlzaGVzIHBhZ2VcbiAgICAgICAgICAgIC53aGVuKCcvZGlzaGVzJywge1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbmcvdmlld3MvcGFnZXMvZGlzaC9hbGwuaHRtbCcsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ0Rpc2hMaXN0Q29udHJvbGxlcicsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiAnZGlzaExpc3QnXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLy9zaG93IGRpc2ggZGV0YWlsIHBhZ2VcbiAgICAgICAgICAgIC53aGVuKCcvZGlzaGVzLzpkaXNoX2lkJywge1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbmcvdmlld3MvcGFnZXMvZGlzaC9kZXRhaWwuaHRtbCcsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ0Rpc2hEZXRhaWxDb250cm9sbGVyJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6ICdkaXNoRGV0YWlsJ1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC8vbGlzdCBhZG1pbiBkaXNoIHBhZ2VcbiAgICAgICAgICAgIC53aGVuKCcvYWRtaW4vZGlzaGVzJywge1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbmcvdmlld3MvcGFnZXMvYWRtaW4vZGlzaC9saXN0Lmh0bWwnLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdEaXNoTGlzdENvbnRyb2xsZXInLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ2Rpc2hMaXN0JyxcbiAgICAgICAgICAgICAgICBhY2Nlc3M6IHtcbiAgICAgICAgICAgICAgICAgICAgcmVxdWlyZVBlcm1pc3Npb25zOiBbJ0FkbWluJ11cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLy9lZGl0IGEgZGlzaCBwYWdlXG4gICAgICAgICAgICAud2hlbignL2FkbWluL2Rpc2hlcy86ZGlzaF9pZCcsIHtcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25nL3ZpZXdzL3BhZ2VzL2FkbWluL2Rpc2gvc2luZ2xlLmh0bWwnLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdEaXNoRWRpdENvbnRyb2xsZXInLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ2Rpc2hNYW5hZ2UnLFxuICAgICAgICAgICAgICAgIGFjY2Vzczoge1xuICAgICAgICAgICAgICAgICAgICByZXF1aXJlUGVybWlzc2lvbnM6IFsnQWRtaW4nXVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAvL2xvZ2luIHVzZXJcbiAgICAgICAgICAgIC53aGVuKCcvbG9naW4nLCB7XG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICduZy92aWV3cy9wYWdlcy91c2VyL2xvZ2luLmh0bWwnLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdMb2dpbkNvbnRyb2xsZXInLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ2xvZ2luJ1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC8vdXNlciBwcm9maWxlXG4gICAgICAgICAgICAud2hlbignL21lJywge1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbmcvdmlld3MvcGFnZXMvdXNlci9tZS5odG1sJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnUHJvZmlsZUNvbnRyb2xsZXInLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ21lJ1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC53aGVuKCcvbm90LWF1dGhvcml6ZScsIHtcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25nL3ZpZXdzL3BhZ2VzL25vdC1hdXRob3JpemUuaHRtbCdcbiAgICAgICAgICAgIH0pXG4gICAgfSk7XG4iLCJhbmd1bGFyLm1vZHVsZSgnc3BpY3lUYXN0ZScpXG4gICAgLy9jb250cm9sbGVyIGFwcGxpZWQgdG8gZGlzaCBsaXN0IHBhZ2VcbiAgICAuY29udHJvbGxlcignRGlzaExpc3RDb250cm9sbGVyJywgZnVuY3Rpb24oRGlzaFNlcnZpY2UsIFNvY2lhbFNlcnZpY2UsICRsb2NhdGlvbikge1xuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuXG4gICAgICAgIC8vZ3JhYiBhbGwgdGhlIGRpc2hlcyBhdCBwYWdlIGxvYWRcbiAgICAgICAgRGlzaFNlcnZpY2UuYWxsKCkuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAvL2JpbmQgdGhlIGRpc2hlc1xuICAgICAgICAgICAgdm0uZGlzaGVzID0gZGF0YTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy9mdW5jdGlvbiB0byBkZWxldGUgYSBkaXNoXG4gICAgICAgIHZtLmRlbGV0ZURpc2ggPSBmdW5jdGlvbihpbmRleCkge1xuICAgICAgICAgICAgdmFyIGRpc2ggPSB2bS5kaXNoZXNbaW5kZXhdO1xuICAgICAgICAgICAgRGlzaFNlcnZpY2UuZGVsZXRlKGRpc2guX2lkKS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICB2bS5kaXNoZXMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIHZtLmFkZERpc2ggPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIERpc2hTZXJ2aWNlLmNyZWF0ZSh7XG4gICAgICAgICAgICAgICAgbmFtZTogJ25ldyBkaXNoJ1xuICAgICAgICAgICAgfSkuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy9hZG1pbi9kaXNoZXMvJyArIGRhdGEuZGlzaC5faWQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICB2bS5nb1RvRWRpdCA9IGZ1bmN0aW9uKGlkKSB7XG4gICAgICAgICAgICAkbG9jYXRpb24ucGF0aCgnL2FkbWluL2Rpc2hlcy8nICsgaWQpO1xuICAgICAgICB9XG5cbiAgICB9KVxuICAgIC8vY29udHJvbGxlciBhcHBsaWVkIHRvIGRpc2ggZGV0YWlsIHBhZ2VcbiAgICAuY29udHJvbGxlcignRGlzaERldGFpbENvbnRyb2xsZXInLCBmdW5jdGlvbigkc2NvcGUsICRsb2NhdGlvbiwgJHJvb3RTY29wZSwgJHJvdXRlUGFyYW1zLCAkZmlsdGVyLCAkbWREaWFsb2csIERpc2hTZXJ2aWNlLCBVc2VyU2VydmljZSwgU29jaWFsU2VydmljZSkge1xuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuICAgICAgICB2bS5kaXNoID0ge307XG4gICAgICAgIGluaXQoKTtcblxuICAgICAgICB2bS5lbnRlckZsaXBCb29rID0gZnVuY3Rpb24oZXZuKSB7XG4gICAgICAgICAgICAkbWREaWFsb2cuc2hvdyh7XG4gICAgICAgICAgICAgICAgdGFyZ2V0RXZlbnQ6IGV2bixcbiAgICAgICAgICAgICAgICBjbGlja091dHNpZGVUb0Nsb3NlOiB0cnVlLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbmcvdmlld3MvZGlhbG9ncy9mbGlwYm9vay5odG1sJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnRGlzaERldGFpbENvbnRyb2xsZXInLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ2Jvb2snXG4gICAgICAgICAgICB9KS5maW5hbGx5KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICRyb290U2NvcGUuc2hvd25Cb29rID0gZmFsc2U7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgJHJvb3RTY29wZS5zaG93bkJvb2sgPSB0cnVlO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vY2FsbCBib29rbGV0IHBsdWdpblxuICAgICAgICAkc2NvcGUuJG9uKCdvblJlcGVhdExhc3QnLCBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cnMpIHtcbiAgICAgICAgICAgIGFuZ3VsYXIuZWxlbWVudChlbGVtZW50KS5wYXJlbnRzKCcjZGlzaEJvb2snKS5ib29rbGV0KHtcbiAgICAgICAgICAgICAgICB3aWR0aDogJzEwMCUnLFxuICAgICAgICAgICAgICAgIGhlaWdodDogNjAwLFxuICAgICAgICAgICAgICAgIGNsb3NlZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICBhdXRvQ2VudGVyOiB0cnVlLFxuICAgICAgICAgICAgICAgIHBhZ2VOdW1iZXJzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBwYWdlUGFkZGluZzogMCxcbiAgICAgICAgICAgICAgICBob3ZlcldpZHRoOiAxMDBcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICB2bS5jbG9zZURpYWxvZyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgJG1kRGlhbG9nLmNhbmNlbCgpO1xuICAgICAgICB9XG5cbiAgICAgICAgdm0uZmJTaGFyZSA9IGZ1bmN0aW9uKGRpc2gpIHtcbiAgICAgICAgICAgIHZhciBkaXNoTGluayA9ICRsb2NhdGlvbi5hYnNVcmwoKSArICcvJyArIGRpc2guX2lkO1xuICAgICAgICAgICAgU29jaWFsU2VydmljZS5mYlNoYXJlKGRpc2hMaW5rKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZtLnJlcGx5ID0gZnVuY3Rpb24odXNlciwgJGV2ZW50KSB7XG4gICAgICAgICAgICB2YXIgY29tbWVudFRpdGxlID0gJ0AnICsgdXNlci51c2VyTmFtZTtcbiAgICAgICAgICAgIG9wZW5Db21tZW50RGlhbG9nKGNvbW1lbnRUaXRsZSwgJGV2ZW50LCB1c2VyLl9pZCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgdm0uY29sbGVjdCA9IGZ1bmN0aW9uKCRldmVudCkge1xuICAgICAgICAgICAgaWYgKCEkcm9vdFNjb3BlLmN1cnJlbnRVc2VyKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnNob3dMb2dpbkRpYWxvZygkZXZlbnQsIHRydWUsICdMb2dpbi9TaWduVXAgZmlyc3QgdG8gc2F2ZSBhcyBmYXZvcml0ZScpLnRoZW4oZnVuY3Rpb24odXNlcikge1xuICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmN1cnJlbnRVc2VyID0gdXNlcjtcblxuICAgICAgICAgICAgICAgICAgICBVc2VyU2VydmljZS5jb2xsZWN0KHZtLmRpc2guX2lkKS50aGVuKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2bS5kaXNoLmlzQ29sbGVjdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgVXNlclNlcnZpY2UuY29sbGVjdCh2bS5kaXNoLl9pZCkudGhlbihmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZtLmRpc2guaXNDb2xsZWN0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICB2bS5zaG93SW5zdHJ1Y3Rpb25QaG90byA9IGZ1bmN0aW9uKHBob3RvVXJsLCAkZXZlbnQpIHtcbiAgICAgICAgICAgIGlmIChwaG90b1VybCA9PSBudWxsIHx8IHBob3RvVXJsLnRyaW0oKSA9PSAnJylcbiAgICAgICAgICAgICAgICByZXR1cm47XG5cbiAgICAgICAgICAgICRtZERpYWxvZy5zaG93KHtcbiAgICAgICAgICAgICAgICB0YXJnZXRFdmVudDogJGV2ZW50LFxuICAgICAgICAgICAgICAgIGNsaWNrT3V0c2lkZVRvQ2xvc2U6IHRydWUsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGU6ICc8bWQtZGlhbG9nPicgK1xuICAgICAgICAgICAgICAgICAgICAnPG1kLWRpYWxvZy1jb250ZW50PjxpbWcgc3JjPVwie3twaG90b319XCI+PC9tZC1kaWFsb2ctY29udGVudD4nICtcbiAgICAgICAgICAgICAgICAgICAgJzwvbWQtZGlhbG9nPicsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogZnVuY3Rpb24gRGlhbG9nQ3RyKCRzY29wZSkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucGhvdG8gPSBwaG90b1VybDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZtLm5ld0NvbW1lbnQgPSBmdW5jdGlvbigkZXZlbnQpIHtcbiAgICAgICAgICAgIGlmICghJHJvb3RTY29wZS5jdXJyZW50VXNlcikge1xuICAgICAgICAgICAgICAgICRzY29wZS5zaG93TG9naW5EaWFsb2coJGV2ZW50LCB0cnVlLCAnTG9naW4vU2lnblVwIGZpcnN0IHRvIGxlYXZlIGEgY29tbWVudCcpLnRoZW4oZnVuY3Rpb24odXNlcikge1xuICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmN1cnJlbnRVc2VyID0gdXNlcjtcbiAgICAgICAgICAgICAgICAgICAgb3BlbkNvbW1lbnREaWFsb2coJ0NvbW1lbnQnLCAkZXZlbnQsIG51bGwpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIG9wZW5Db21tZW50RGlhbG9nKCdDb21tZW50JywgJGV2ZW50LCBudWxsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgICAgICAgICB2bS5kaXNoID0ge307XG4gICAgICAgICAgICB2bS5yZWxhdGVkRGlzaGVzID0ge307XG5cbiAgICAgICAgICAgIC8vZ2V0IHRoZSBkaXNoIGJ5IGlkXG4gICAgICAgICAgICBEaXNoU2VydmljZS5nZXQoJHJvdXRlUGFyYW1zLmRpc2hfaWQpLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgIHZtLmRpc2ggPSBkYXRhO1xuICAgICAgICAgICAgICAgIHZtLmRpc2guaXNDb2xsZWN0ZWQgPSBmYWxzZTtcblxuICAgICAgICAgICAgICAgIC8vZ2V0IHRoZSAzIHJlbGF0ZWQgZGlzaGVzXG4gICAgICAgICAgICAgICAgRGlzaFNlcnZpY2UucmVsYXRlKHZtLmRpc2guX2lkLCB2bS5kaXNoLnRhZ3MsIDMpLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICB2bS5yZWxhdGVkRGlzaGVzID0gZGF0YTtcbiAgICAgICAgICAgICAgICB9KVxuXG4gICAgICAgICAgICAgICAgaWYgKCRyb290U2NvcGUuY3VycmVudFVzZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZvdW5kID0gJGZpbHRlcignZmlsdGVyJykoJHJvb3RTY29wZS5jdXJyZW50VXNlci5mYXZvdXJpdGVEaXNoZXMsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9pZDogdm0uZGlzaC5faWRcbiAgICAgICAgICAgICAgICAgICAgfSwgdHJ1ZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGZvdW5kLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdm0uZGlzaC5pc0NvbGxlY3RlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gb3BlbkNvbW1lbnREaWFsb2codGl0bGUsICRldmVudCwgcmVwbHlUbykge1xuICAgICAgICAgICAgJG1kRGlhbG9nLnNob3coe1xuICAgICAgICAgICAgICAgIHRhcmdldEV2ZW50OiAkZXZlbnQsXG4gICAgICAgICAgICAgICAgY2xpY2tPdXRzaWRlVG9DbG9zZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25nL3ZpZXdzL2RpYWxvZ3MvY29tbWVudC5odG1sJyxcbiAgICAgICAgICAgICAgICBsb2NhbHM6IHtcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IHRpdGxlXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiBjb21tZW50Q29udHJvbGxlcixcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6ICdjb21tZW50J1xuICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbihjb250ZW50KSB7XG4gICAgICAgICAgICAgICAgRGlzaFNlcnZpY2UuYWRkQ29tbWVudCh2bS5kaXNoLl9pZCwge1xuICAgICAgICAgICAgICAgICAgICBjb250ZW50OiBjb250ZW50LFxuICAgICAgICAgICAgICAgICAgICByZXBseVRvOiByZXBseVRvXG4gICAgICAgICAgICAgICAgfSkuc3VjY2VzcyhmdW5jdGlvbihjb21tZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIHZtLmRpc2guY29tbWVudHMucHVzaChjb21tZW50KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gY29tbWVudENvbnRyb2xsZXIodGl0bGUsICRtZERpYWxvZykge1xuICAgICAgICAgICAgdmFyIGR2bSA9IHRoaXM7XG4gICAgICAgICAgICBkdm0uY29udGVudCA9ICcnO1xuICAgICAgICAgICAgZHZtLnRpdGxlID0gdGl0bGU7XG5cbiAgICAgICAgICAgIGR2bS5jbG9zZURpYWxvZyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICRtZERpYWxvZy5jYW5jZWwoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZHZtLnN1Ym1pdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIGlmIChkdm0uY29udGVudC50cmltKCkgPT0gJycpXG4gICAgICAgICAgICAgICAgICAgICRtZERpYWxvZy5jYW5jZWwoKVxuICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgJG1kRGlhbG9nLmhpZGUoZHZtLmNvbnRlbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSlcbiAgICAvL2NvbnRyb2xsZXIgYXBwbGllZCB0byBkaXNoIGVkaXQgcGFnZVxuICAgIC5jb250cm9sbGVyKCdEaXNoRWRpdENvbnRyb2xsZXInLCBmdW5jdGlvbigkbWREaWFsb2csICRyb3V0ZVBhcmFtcywgRGlzaFNlcnZpY2UsICRsb2NhdGlvbiwgJHRpbWVvdXQpIHtcbiAgICAgICAgdmFyIHZtID0gdGhpcztcbiAgICAgICAgaW5pdCgpO1xuXG4gICAgICAgIHZtLnNhdmVEaXNoID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBEaXNoU2VydmljZS51cGRhdGUoJHJvdXRlUGFyYW1zLmRpc2hfaWQsIHZtLmRpc2gpLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgIHZtLnVwZGF0ZVN1Y2Nlc3MgPSB0cnVlO1xuXG4gICAgICAgICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIHZtLnVwZGF0ZVN1Y2Nlc3MgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9LCAxMDAwKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH1cblxuICAgICAgICB2bS5yZW1vdmVJbnN0cnVjdGlvbiA9IGZ1bmN0aW9uKGluZGV4KSB7XG4gICAgICAgICAgICBEaXNoU2VydmljZS5yZW1vdmVJbnN0cnVjdGlvbigkcm91dGVQYXJhbXMuZGlzaF9pZCwgdm0uZGlzaC5pbnN0cnVjdGlvbnNbaW5kZXhdLl9pZCkuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgdm0uZGlzaC5pbnN0cnVjdGlvbnMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgdm0ucmVtb3ZlUGhvdG8gPSBmdW5jdGlvbihpbmRleCkge1xuICAgICAgICAgICAgdm0uZGlzaC5waG90b3Muc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICAgIHZtLnNhdmVEaXNoKCk7XG4gICAgICAgIH1cblxuICAgICAgICB2bS5zaG93QWRkUGhvdG9EaWFsb2cgPSBmdW5jdGlvbihldm4pIHtcbiAgICAgICAgICAgICRtZERpYWxvZy5zaG93KHtcbiAgICAgICAgICAgICAgICB0YXJnZXRFdmVudDogZXZuLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6IHBob3RvRGlhbG9nQ29udHJvbGxlcixcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6ICdwaG90b0RsZycsXG4gICAgICAgICAgICAgICAgY2xpY2tPdXRzaWRlVG9DbG9zZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25nL3ZpZXdzL2RpYWxvZ3MvYWRkUGhvdG8uaHRtbCdcbiAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24obmV3UGhvdG8pIHtcbiAgICAgICAgICAgICAgICB2bS5kaXNoLnBob3Rvcy5wdXNoKG5ld1Bob3RvKTtcbiAgICAgICAgICAgICAgICB2bS5zYXZlRGlzaCgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICB2bS5zaG93QWRkSW5zdHJ1Y3Rpb25EaWFsb2cgPSBmdW5jdGlvbihldm4pIHtcbiAgICAgICAgICAgICRtZERpYWxvZy5zaG93KHtcbiAgICAgICAgICAgICAgICB0YXJnZXRFdmVudDogZXZuLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6IGluc3RydWN0aW9uRGlhbG9nQ29udHJvbGxlcixcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6ICdpbnN0cnVjdGlvbkRsZycsXG4gICAgICAgICAgICAgICAgY2xpY2tPdXRzaWRlVG9DbG9zZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25nL3ZpZXdzL2RpYWxvZ3MvYWRkSW5zdHJ1Y3Rpb24uaHRtbCdcbiAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24obmV3SW5zdHJ1Y3Rpb24pIHtcbiAgICAgICAgICAgICAgICB2bS5kaXNoLmluc3RydWN0aW9ucy5wdXNoKG5ld0luc3RydWN0aW9uKTtcbiAgICAgICAgICAgICAgICBEaXNoU2VydmljZS5hZGRJbnN0cnVjdGlvbigkcm91dGVQYXJhbXMuZGlzaF9pZCwgbmV3SW5zdHJ1Y3Rpb24pLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHBob3RvRGlhbG9nQ29udHJvbGxlcigkbWREaWFsb2cpIHtcbiAgICAgICAgICAgIHZhciBkdm0gPSB0aGlzO1xuICAgICAgICAgICAgZHZtLm5ld1Bob3RvID0gJyc7XG5cbiAgICAgICAgICAgIGR2bS5jbG9zZURpYWxvZyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICRtZERpYWxvZy5jYW5jZWwoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZHZtLnN1Ym1pdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICRtZERpYWxvZy5oaWRlKGR2bS5uZXdQaG90byk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBpbnN0cnVjdGlvbkRpYWxvZ0NvbnRyb2xsZXIoJG1kRGlhbG9nKSB7XG4gICAgICAgICAgICB2YXIgZHZtID0gdGhpcztcblxuICAgICAgICAgICAgZHZtLm5ld0luc3RydWN0aW9uID0ge1xuICAgICAgICAgICAgICAgIHBob3RvOiAnJyxcbiAgICAgICAgICAgICAgICB0ZXh0OiAnJ1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgZHZtLmNsb3NlRGlhbG9nID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgJG1kRGlhbG9nLmNhbmNlbCgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBkdm0uc3VibWl0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgJG1kRGlhbG9nLmhpZGUoZHZtLm5ld0luc3RydWN0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgICAgICAgICAvL2dldCB0aGUgZGlzaCBieSBpZFxuICAgICAgICAgICAgRGlzaFNlcnZpY2UuZ2V0KCRyb3V0ZVBhcmFtcy5kaXNoX2lkKS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICB2bS5kaXNoID0gZGF0YTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdm0uZGlmZmljdWx0aWVzID0gRGlzaFNlcnZpY2UuZ2V0RGlmZmljdWx0aWVzKCk7XG4gICAgICAgIH1cbiAgICB9KTtcbiIsbnVsbCwiYW5ndWxhci5tb2R1bGUoJ3NwaWN5VGFzdGUnKVxuICAgIC5jb250cm9sbGVyKCdIb21lQ29udHJvbGxlcicsIGZ1bmN0aW9uKCRzY29wZSwgJG1kTWVkaWEsIERpc2hTZXJ2aWNlLCBDT05TVEFOVFMpIHtcbiAgICAgICAgdmFyIHZtID0gdGhpcztcbiAgICAgICAgaW5pdCgpO1xuXG4gICAgICAgIGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgICAgICAgICB2bS5yZWNpcGVUaWxlcyA9IFtdO1xuICAgICAgICAgICAgJHNjb3BlLiR3YXRjaChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJG1kTWVkaWEoJ3NtJyk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbihpc1NtYWxsKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnNtYWxsU2NyZWVuID0gaXNTbWFsbDtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBidWlsZEdyaWQoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGJ1aWxkR3JpZCgpIHtcbiAgICAgICAgICAgIERpc2hTZXJ2aWNlLmxpbWl0KENPTlNUQU5UUy5MQVRFU1RfQ09VTlQpLnN1Y2Nlc3MoZnVuY3Rpb24oZGlzaGVzKSB7XG4gICAgICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKGRpc2hlcywgZnVuY3Rpb24oZGlzaCwgaW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRpbGUgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpbWFnZTogZGlzaC5pbWFnZVVybCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiBkaXNoLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBpZDogZGlzaC5faWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBwcmVwVGltZTogZGlzaC5wcmVwVGltZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsVGltZTogZGlzaC50b3RhbFRpbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBkaWZmaWN1bHR5OiBkaXNoLmRpZmZpY3VsdHksXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdzOiBkaXNoLnRhZ3MsXG4gICAgICAgICAgICAgICAgICAgICAgICBzcGFuOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcm93OiAxLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbDogMVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoaW5kZXggKyAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGlsZS5zcGFuLnJvdyA9IHRpbGUuc3Bhbi5jb2wgPSAyO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpbGUuc3Bhbi5jb2wgPSAyO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA1OlxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA2OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA3OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpbGUuc3Bhbi5yb3cgPSB0aWxlLnNwYW4uY29sID0gMjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgODpcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgOTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGlsZS5zcGFuLmNvbCA9IDI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB2bS5yZWNpcGVUaWxlcy5wdXNoKHRpbGUpO1xuXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgfSk7XG4iLCJhbmd1bGFyLm1vZHVsZSgnc3BpY3lUYXN0ZScpXG4gICAgLmNvbnRyb2xsZXIoJ01haW5Db250cm9sbGVyJywgZnVuY3Rpb24oJHJvb3RTY29wZSwgJHNjb3BlLCAkbG9jYXRpb24sICRtZERpYWxvZywgJGh0dHAsIFNlc3Npb25TZXJ2aWNlLCBVc2VyU2VydmljZSwgQ09OU1RBTlRTKSB7XG4gICAgICAgICd1c2Ugc3RyaWN0JztcbiAgICAgICAgdmFyIHZtID0gdGhpcztcbiAgICAgICAgaW5pdCgpO1xuXG4gICAgICAgIHZtLnRvZ2dsZU1vYmlsZU1lbnUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZtLnNob3dNb2JpbGVNZW51ID0gIXZtLnNob3dNb2JpbGVNZW51O1xuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS5zZXRTY3JvbGxSZWFjaGVkID0gZnVuY3Rpb24oZmxhZykge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ3NldFNjcm9sbFJlYWNoZWQgY2FsbGVkJywgZmxhZyk7XG4gICAgICAgICAgICB2bS5zY3JvbGxUYXJnZXRSZWFjaGVkID0gZmxhZztcbiAgICAgICAgfVxuXG4gICAgICAgICRzY29wZS5zaG93TG9naW5EaWFsb2cgPSBmdW5jdGlvbihldiwgcG9zdExvZ2luLCB0aXRsZSkge1xuICAgICAgICAgICAgdmFyIHByb21pc2UgPSAkbWREaWFsb2cuc2hvdyh7XG4gICAgICAgICAgICAgICAgY2xpY2tPdXRzaWRlVG9DbG9zZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25nL3ZpZXdzL2RpYWxvZ3MvbG9naW4uaHRtbCcsXG4gICAgICAgICAgICAgICAgdGFyZ2V0RXZlbnQ6IGV2LFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6IGxvZ2luQ29udHJvbGxlcixcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6ICdsb2dpbicsXG4gICAgICAgICAgICAgICAgbG9jYWxzOiB7XG4gICAgICAgICAgICAgICAgICAgIGRpYWxvZ1RpdGxlOiB0aXRsZVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYgKHBvc3RMb2dpbikge1xuICAgICAgICAgICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBwcm9taXNlLnRoZW4oZnVuY3Rpb24odXNlcikge1xuICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmN1cnJlbnRVc2VyID0gdXNlcjtcbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgKHVzZXIucm9sZSAmJiB1c2VyLnJvbGUgPT0gXCJBZG1pblwiKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAkbG9jYXRpb24ucGF0aCgnL2FkbWluL2Rpc2hlcycpO1xuICAgICAgICAgICAgICAgICAgICAvLyB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvLyAgICAgJGxvY2F0aW9uLnBhdGgoJy8nKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIGZ1bmN0aW9uIGxvZ2luQ29udHJvbGxlcihkaWFsb2dUaXRsZSwgJG1kRGlhbG9nLCBVc2VyU2VydmljZSwgbWQ1KSB7XG4gICAgICAgICAgICB2YXIgZHZtID0gdGhpcztcbiAgICAgICAgICAgIGR2bS50aXRsZSA9IGRpYWxvZ1RpdGxlO1xuICAgICAgICAgICAgZHZtLmVtYWlsID0gJyc7XG4gICAgICAgICAgICBkdm0ucGFzc3dvcmQgPSAnJztcbiAgICAgICAgICAgIGR2bS51c2VyTmFtZSA9ICcnO1xuXG4gICAgICAgICAgICBkdm0uZmJMb2dpbiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIEZCLmxvZ2luKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09ICdjb25uZWN0ZWQnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBMb2dnZWQgaW50byB5b3VyIGFwcCBhbmQgRmFjZWJvb2suXG4gICAgICAgICAgICAgICAgICAgICAgICBGQi5hcGkoJy9tZScsIGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZiVXNlciA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlck5hbWU6IHJlc3BvbnNlLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVtYWlsOiByZXNwb25zZS5lbWFpbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFzc3dvcmQ6IENPTlNUQU5UUy5TT0NJQUxfUEFTUyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGhvdG9Vcmw6ICdodHRwOi8vZ3JhcGguZmFjZWJvb2suY29tLycgKyByZXNwb25zZS5pZCArICcvcGljdHVyZT90eXBlPWxhcmdlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlua2VkU29jaWFsOiBDT05TVEFOVFMuRkFDRUJPT0tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgVXNlclNlcnZpY2Uuc29jaWFsTG9naW4oZmJVc2VyKS50aGVuKGZ1bmN0aW9uKHVzZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlci5sb2dpblR5cGUgPSBDT05TVEFOVFMuRkFDRUJPT0s7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFmdGVyQXV0aCh1c2VyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSAnbm90X2F1dGhvcml6ZWQnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBUaGUgcGVyc29uIGlzIGxvZ2dlZCBpbnRvIEZhY2Vib29rLCBidXQgbm90IHlvdXIgYXBwLlxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhlIHBlcnNvbiBpcyBub3QgbG9nZ2VkIGludG8gRmFjZWJvb2ssIHNvIHdlJ3JlIG5vdCBzdXJlIGlmXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGV5IGFyZSBsb2dnZWQgaW50byB0aGlzIGFwcCBvciBub3QuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlOiAncHVibGljX3Byb2ZpbGUsZW1haWwnXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBkdm0ubG9naW4gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBVc2VyU2VydmljZS5sb2dpbihkdm0uZW1haWwsIGR2bS5wYXNzd29yZCkudGhlbihmdW5jdGlvbih1c2VyKSB7XG4gICAgICAgICAgICAgICAgICAgIHVzZXIubG9naW5UeXBlID0gQ09OU1RBTlRTLkVNQUlMO1xuICAgICAgICAgICAgICAgICAgICBhZnRlckF1dGgodXNlcik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBkdm0uc2lnblVwID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgdmFyIG5ld1VzZXIgPSB7XG4gICAgICAgICAgICAgICAgICAgIHVzZXJOYW1lOiBkdm0udXNlck5hbWUsXG4gICAgICAgICAgICAgICAgICAgIGVtYWlsOiBkdm0uZW1haWwsXG4gICAgICAgICAgICAgICAgICAgIHBhc3N3b3JkOiBkdm0ucGFzc3dvcmQsXG4gICAgICAgICAgICAgICAgICAgIHBob3RvVXJsOiAnaHR0cDovL3d3dy5ncmF2YXRhci5jb20vYXZhdGFyLycgKyBtZDUuY3JlYXRlSGFzaChkdm0uZW1haWwpLFxuICAgICAgICAgICAgICAgICAgICBsaW5rZWRTb2NpYWw6IENPTlNUQU5UUy5FTUFJTFxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICBVc2VyU2VydmljZS5jcmVhdGUobmV3VXNlcikudGhlbihmdW5jdGlvbih1c2VyKSB7XG4gICAgICAgICAgICAgICAgICAgIHVzZXIubG9naW5UeXBlID0gQ09OU1RBTlRTLkVNQUlMO1xuICAgICAgICAgICAgICAgICAgICBhZnRlckF1dGgodXNlcik7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGFmdGVyQXV0aCh1c2VyKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRva2VuID0gJGh0dHAuZGVmYXVsdHMuaGVhZGVycy5jb21tb25bJ1gtQXV0aCddO1xuICAgICAgICAgICAgICAgIFNlc3Npb25TZXJ2aWNlLnNldExvY2FsKENPTlNUQU5UUy5MT0NBTF9TVE9SQUdFX0tFWSwgdG9rZW4pO1xuICAgICAgICAgICAgICAgICRtZERpYWxvZy5oaWRlKHVzZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gaW5pdCgpIHtcbiAgICAgICAgICAgIHZtLnNob3dNb2JpbGVNZW51ID0gZmFsc2U7XG4gICAgICAgICAgICB2bS5zY3JvbGxUYXJnZXRSZWFjaGVkID0gZmFsc2U7XG5cbiAgICAgICAgICAgIHZhciBsb2dpbmVkVG9rZW4gPSBTZXNzaW9uU2VydmljZS5nZXRMb2NhbChDT05TVEFOVFMuTE9DQUxfU1RPUkFHRV9LRVkpO1xuICAgICAgICAgICAgaWYgKGxvZ2luZWRUb2tlbikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCd0b2tlbicsIGxvZ2luZWRUb2tlbik7XG5cbiAgICAgICAgICAgICAgICAkaHR0cC5kZWZhdWx0cy5oZWFkZXJzLmNvbW1vblsnWC1BdXRoJ10gPSBsb2dpbmVkVG9rZW47XG4gICAgICAgICAgICAgICAgVXNlclNlcnZpY2UuZ2V0Q3VycmVudFVzZXIoKS50aGVuKGZ1bmN0aW9uKHVzZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5jdXJyZW50VXNlciA9IHVzZXI7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgIH0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ3NwaWN5VGFzdGUnKVxuICAgIC5jb250cm9sbGVyKCdQcm9maWxlQ29udHJvbGxlcicsIGZ1bmN0aW9uKCRsb2NhdGlvbiwgJHJvb3RTY29wZSwgVXNlclNlcnZpY2UpIHtcbiAgICAgICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG4gICAgICAgIGluaXQoKTtcblxuICAgICAgICB2bS5sb2dvdXQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIFVzZXJTZXJ2aWNlLmxvZ291dCgpO1xuICAgICAgICAgICAgJHJvb3RTY29wZS5jdXJyZW50VXNlciA9IG51bGw7XG4gICAgICAgICAgICAkbG9jYXRpb24ucGF0aCgnLycpO1xuICAgICAgICB9O1xuXG4gICAgICAgIGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgICAgICAgICB2bS51c2VyID0ge307XG4gICAgICAgICAgICBVc2VyU2VydmljZS5nZXRCeUlkKCRyb290U2NvcGUuY3VycmVudFVzZXIuX2lkKS50aGVuKGZ1bmN0aW9uKHVzZXIpIHtcbiAgICAgICAgICAgICAgICB2bS51c2VyID0gdXNlcjtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICB9KTtcbiIsImFuZ3VsYXIubW9kdWxlKCdzcGljeVRhc3RlJylcbiAgICAuZGlyZWN0aXZlKCdjb250ZW50ZWRpdGFibGUnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJlcXVpcmU6ICduZ01vZGVsJyxcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICAgICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cmlidXRzLCBuZ01vZGVsKSB7XG4gICAgICAgICAgICAgICAgbmdNb2RlbC4kcmVuZGVyID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuaHRtbChuZ01vZGVsLiR2aWV3VmFsdWUgfHwgJycpO1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICBlbGVtZW50LmJpbmQoJ2JsdXInLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmdNb2RlbC4kc2V0Vmlld1ZhbHVlKGVsZW1lbnQuaHRtbCgpKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfSk7XG4iLCJhbmd1bGFyLm1vZHVsZSgnc3BpY3lUYXN0ZScpXG4gICAgLmRpcmVjdGl2ZSgnZmxpcGJvb2snLCBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHRyYW5zY2x1ZGU6IGZhbHNlLFxuICAgICAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgICAgIHJlcGxhY2U6IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25nL3ZpZXdzL3RlbXBsYXRlcy9mbGlwYm9vay5odG1sJyxcbiAgICAgICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICAgICAgZGlzaDogJz0nXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KVxuIiwiYW5ndWxhci5tb2R1bGUoJ3NwaWN5VGFzdGUnKVxuICAgIC5kaXJlY3RpdmUoJ2ZvY3VzT24nLCBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgICAgIGZvY3VzVmFsdWU6IFwiPWZvY3VzT25cIlxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGxpbms6IGZ1bmN0aW9uKCRzY29wZSwgJGVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuJHdhdGNoKCdmb2N1c1ZhbHVlJywgZnVuY3Rpb24oY3VycmVudFZhbHVlLCBwcmV2aW91c1ZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50VmFsdWUgJiYgIXByZXZpb3VzVmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRlbGVtZW50WzBdLmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9KTtcbiIsImFuZ3VsYXIubW9kdWxlKCdzcGljeVRhc3RlJylcbiAgICAuZGlyZWN0aXZlKCdvbkxhc3RSZXBlYXQnLCBmdW5jdGlvbigkdGltZW91dCkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24oJHNjb3BlLCAkZWxlbWVudCwgJGF0dHJzKSB7XG4gICAgICAgICAgICBpZiAoJHNjb3BlLiRsYXN0KSB7XG4gICAgICAgICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS4kZW1pdCgnb25SZXBlYXRMYXN0JywgJGVsZW1lbnQsICRhdHRycyk7XG4gICAgICAgICAgICAgICAgfSwgMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KTtcbiIsImFuZ3VsYXIubW9kdWxlKCdzcGljeVRhc3RlJylcbiAgICAuZGlyZWN0aXZlKCdzY3JvbGxSZWFjaGVkJywgZnVuY3Rpb24oJHdpbmRvdykge1xuICAgICAgICAndXNlIHN0cmljdCc7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgICAgICAgc2NvcGU6IHRydWUsXG4gICAgICAgICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgJGVsZW1lbnQsIGF0dHJzKSB7XG4gICAgICAgICAgICAgICAgdmFyIG9mZnNldCA9ICRlbGVtZW50Lm9mZnNldCgpLnRvcCAtIDY0O1xuICAgICAgICAgICAgICAgIGFuZ3VsYXIuZWxlbWVudCgkd2luZG93KS5vbignc2Nyb2xsJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnBhZ2VZT2Zmc2V0ID49IG9mZnNldCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuc2V0U2Nyb2xsUmVhY2hlZCh0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLnNldFNjcm9sbFJlYWNoZWQoZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLiRhcHBseSgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ3NwaWN5VGFzdGUnKVxuICAgIC5kaXJlY3RpdmUoJ3Njcm9sbFRvJywgZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgICAgICAgbGluazogZnVuY3Rpb24oc2NvcGUsICRlbGVtZW50LCBhdHRycykge1xuICAgICAgICAgICAgICAgIHZhciAkdGFyZ2V0ID0gJChhdHRycy5zY3JvbGxUbyk7XG4gICAgICAgICAgICAgICAgJGVsZW1lbnQub24oJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICQoJ2h0bWwsIGJvZHknKS5hbmltYXRlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjcm9sbFRvcDogJHRhcmdldC5vZmZzZXQoKS50b3BcbiAgICAgICAgICAgICAgICAgICAgfSwgNjAwKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9KTtcbiIsImFuZ3VsYXIubW9kdWxlKCdzcGljeVRhc3RlJylcbiAgICAuZmFjdG9yeSgnRGlzaFNlcnZpY2UnLCBmdW5jdGlvbigkaHR0cCkge1xuXG4gICAgICAgIC8vY3JlYXRlIGEgbmV3IG9iamVjdFxuICAgICAgICB2YXIgZGlzaEZhY3RvcnkgPSB7fTtcblxuICAgICAgICAvL2dldCBhbGwgZGlzaGVzXG4gICAgICAgIGRpc2hGYWN0b3J5LmFsbCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS9kaXNoZXMnKTtcbiAgICAgICAgfTtcblxuICAgICAgICAvL2dldCBsaW1pdGVkIGxhdGVzdCBkaXNoZXNcbiAgICAgICAgZGlzaEZhY3RvcnkubGltaXQgPSBmdW5jdGlvbihudW0pIHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvZGlzaGVzP2xpbWl0PScgKyBudW0pO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9nZXQgcmVsYXRlZCBkaXNoZXMgYnkgdGFnc1xuICAgICAgICBkaXNoRmFjdG9yeS5yZWxhdGUgPSBmdW5jdGlvbihpZCwgdGFncywgbnVtKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAoe1xuICAgICAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgICAgICAgICAgdXJsOiAnL2FwaS9kaXNoZXMnLFxuICAgICAgICAgICAgICAgIHBhcmFtczoge1xuICAgICAgICAgICAgICAgICAgICBpZDogaWQsXG4gICAgICAgICAgICAgICAgICAgIGxpbWl0OiBudW0sXG4gICAgICAgICAgICAgICAgICAgICd0YWdzW10nOiB0YWdzXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICAvL2NyZWF0ZSBhIGRpc2hcbiAgICAgICAgZGlzaEZhY3RvcnkuY3JlYXRlID0gZnVuY3Rpb24oZGlzaCkge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLnBvc3QoJy9hcGkvZGlzaGVzJywgZGlzaCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy9nZXQgYSBzaW5nbGUgZGlzaFxuICAgICAgICBkaXNoRmFjdG9yeS5nZXQgPSBmdW5jdGlvbihkaXNoX2lkKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL2Rpc2hlcy8nICsgZGlzaF9pZCk7XG4gICAgICAgIH1cblxuICAgICAgICAvL3VwZGF0ZSBhIGRpc2hcbiAgICAgICAgZGlzaEZhY3RvcnkudXBkYXRlID0gZnVuY3Rpb24oZGlzaF9pZCwgZGlzaCkge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLnB1dCgnL2FwaS9kaXNoZXMvJyArIGRpc2hfaWQsIGRpc2gpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9kZWxldGUgYSBkaXNoXG4gICAgICAgIGRpc2hGYWN0b3J5LmRlbGV0ZSA9IGZ1bmN0aW9uKGRpc2hfaWQpIHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5kZWxldGUoJy9hcGkvZGlzaGVzLycgKyBkaXNoX2lkKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vYWRkIGEgY29tbWVudFxuICAgICAgICBkaXNoRmFjdG9yeS5hZGRDb21tZW50ID0gZnVuY3Rpb24oZGlzaF9pZCwgY29tbWVudCkge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLnBvc3QoJy9hcGkvZGlzaGVzLycgKyBkaXNoX2lkICsgJy9jb21tZW50cycsIGNvbW1lbnQpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9hZGQgYSBpbnN0cnVjdGlvblxuICAgICAgICBkaXNoRmFjdG9yeS5hZGRJbnN0cnVjdGlvbiA9IGZ1bmN0aW9uKGRpc2hfaWQsIGluc3RydWN0aW9uKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9kaXNoZXMvJyArIGRpc2hfaWQgKyAnL2luc3RydWN0aW9ucycsIGluc3RydWN0aW9uKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vcmVtb3ZlIGFuIGluc3RydWN0aW9uXG4gICAgICAgIGRpc2hGYWN0b3J5LnJlbW92ZUluc3RydWN0aW9uID0gZnVuY3Rpb24oZGlzaF9pZCwgaW5zdHJ1Y3Rpb25faWQpIHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5kZWxldGUoJy9hcGkvZGlzaGVzLycgKyBkaXNoX2lkICsgJy9pbnN0cnVjdGlvbnMvJyArIGluc3RydWN0aW9uX2lkKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vZ2V0IGRpZmZpY3VsdHlcbiAgICAgICAgZGlzaEZhY3RvcnkuZ2V0RGlmZmljdWx0aWVzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gWyfliJ3lraYnLCAn5a655piTJywgJ+S4gOiIrCcsICfovoPpmr4nLCAn5LiT5LiaJ107XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGRpc2hGYWN0b3J5O1xuICAgIH0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ3NwaWN5VGFzdGUnKVxuICAgIC5mYWN0b3J5KCdTZXNzaW9uU2VydmljZScsIGZ1bmN0aW9uKCR3aW5kb3cpIHtcbiAgICAgICAgdmFyIHNlc3Npb25GYWN0b3J5ID0ge307XG5cbiAgICAgICAgc2Vzc2lvbkZhY3RvcnkuZ2V0TG9jYWwgPSBmdW5jdGlvbihrZXkpIHtcbiAgICAgICAgICAgIGlmICgkd2luZG93LmxvY2FsU3RvcmFnZSkge1xuICAgICAgICAgICAgICAgIHZhciBkYXRhID0gJHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbShrZXkpO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGFuZ3VsYXIuZnJvbUpzb24oZGF0YSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICBzZXNzaW9uRmFjdG9yeS5zZXRMb2NhbCA9IGZ1bmN0aW9uKGtleSwgZGF0YSkge1xuICAgICAgICAgICAgcmV0dXJuICR3aW5kb3cubG9jYWxTdG9yYWdlICYmICR3aW5kb3cubG9jYWxTdG9yYWdlLnNldEl0ZW0oa2V5LCBhbmd1bGFyLnRvSnNvbihkYXRhKSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gc2Vzc2lvbkZhY3Rvcnk7XG5cbiAgICB9KTtcbiIsImFuZ3VsYXIubW9kdWxlKCdzcGljeVRhc3RlJylcbiAgICAuZmFjdG9yeSgnU29jaWFsU2VydmljZScsIGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgc29jaWFsRmFjdG9yeSA9IHt9O1xuXG4gICAgICAgIHNvY2lhbEZhY3RvcnkuZmJTaGFyZSA9IGZ1bmN0aW9uKGxpbmspIHtcbiAgICAgICAgICAgIEZCLnVpKHtcbiAgICAgICAgICAgICAgICBtZXRob2Q6ICdzaGFyZScsXG4gICAgICAgICAgICAgICAgaHJlZjogbGluayxcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHJlc3BvbnNlKSB7fSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gc29jaWFsRmFjdG9yeTtcbiAgICB9KTtcbiIsImFuZ3VsYXIubW9kdWxlKCdzcGljeVRhc3RlJylcbiAgICAuZmFjdG9yeSgnVXNlclNlcnZpY2UnLCBmdW5jdGlvbigkaHR0cCwgJHJvb3RTY29wZSwgJHdpbmRvdywgQ09OU1RBTlRTKSB7XG4gICAgICAgICd1c2Ugc3RyaWN0JztcblxuICAgICAgICB2YXIgdXNlckZhY3RvcnkgPSB7fTtcblxuICAgICAgICAvL3NvY2lhbCBsb2dpblxuICAgICAgICB1c2VyRmFjdG9yeS5zb2NpYWxMb2dpbiA9IGZ1bmN0aW9uKHNvY2lhbFVzZXIpIHtcbiAgICAgICAgICAgIHJldHVybiB1c2VyRmFjdG9yeS5zZWFyY2hCeSgnZW1haWw9JyArIHNvY2lhbFVzZXIuZW1haWwpLnRoZW4oZnVuY3Rpb24oZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgaWYgKCFkYXRhLnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9ub3QgZm91bmQsIHRoZW4gY3JlYXRlXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB1c2VyRmFjdG9yeS5jcmVhdGUoc29jaWFsVXNlcik7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy9mb3VuZCB0aGUgdXNlciB3aXRoIGVtYWlsXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB1c2VyRmFjdG9yeS5sb2dpbihzb2NpYWxVc2VyLmVtYWlsLCBDT05TVEFOVFMuU09DSUFMX1BBU1MpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vbG9naW4gdXNlclxuICAgICAgICB1c2VyRmFjdG9yeS5sb2dpbiA9IGZ1bmN0aW9uKGVtYWlsLCBwYXNzd29yZCkge1xuXG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9hdXRoJywge1xuICAgICAgICAgICAgICAgIGVtYWlsOiBlbWFpbCxcbiAgICAgICAgICAgICAgICBwYXNzd29yZDogcGFzc3dvcmRcbiAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAkaHR0cC5kZWZhdWx0cy5oZWFkZXJzLmNvbW1vblsnWC1BdXRoJ10gPSByZXNwb25zZS5kYXRhLnRva2VuO1xuICAgICAgICAgICAgICAgIHJldHVybiB1c2VyRmFjdG9yeS5nZXRCeUlkKHJlc3BvbnNlLmRhdGEudXNlcklkKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vbG9nb3V0IHVzZXJcbiAgICAgICAgdXNlckZhY3RvcnkubG9nb3V0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBkZWxldGUgJGh0dHAuZGVmYXVsdHMuaGVhZGVycy5jb21tb25bJ1gtQXV0aCddO1xuICAgICAgICAgICAgJHdpbmRvdy5sb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShDT05TVEFOVFMuTE9DQUxfU1RPUkFHRV9LRVkpO1xuICAgICAgICAgICAgdXNlckZhY3RvcnkubG9naW5lZFVzZXIgPSBudWxsO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vc2VhcmNoIHVzZXIgYnkgZmllbGRcbiAgICAgICAgdXNlckZhY3Rvcnkuc2VhcmNoQnkgPSBmdW5jdGlvbihxdWVyeSkge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS91c2Vycz8nICsgcXVlcnkpLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIHVzZXJGYWN0b3J5LmdldEN1cnJlbnRVc2VyID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL21lJykudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB1c2VyRmFjdG9yeS5nZXRCeUlkKHJlc3BvbnNlLmRhdGEpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy9nZXQgdXNlciBieSBpZFxuICAgICAgICB1c2VyRmFjdG9yeS5nZXRCeUlkID0gZnVuY3Rpb24odXNlcl9pZCkge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS91c2Vycy8nICsgdXNlcl9pZCkudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5kYXRhO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy9jcmVhdGUgYSBuZXcgdXNlclxuICAgICAgICB1c2VyRmFjdG9yeS5jcmVhdGUgPSBmdW5jdGlvbih1c2VyKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS91c2Vycy8nLCB1c2VyKS50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB1c2VyRmFjdG9yeS5sb2dpbih1c2VyLmVtYWlsLCB1c2VyLnBhc3N3b3JkKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vdXBkYXRlIHVzZXJcbiAgICAgICAgdXNlckZhY3RvcnkudXBkYXRlID0gZnVuY3Rpb24odXNlcikge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLnB1dCgnL2FwaS91c2Vycy8nICsgdXNlci51c2VyX2lkLCB1c2VyKS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGE7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICAvL2NvbGxlY3QgZGlzaCBhcyBmYXZvdXJpdGVcbiAgICAgICAgdXNlckZhY3RvcnkuY29sbGVjdCA9IGZ1bmN0aW9uKGRpc2hfaWQpIHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5wdXQoJy9hcGkvdXNlcnMvJyArICRyb290U2NvcGUuY3VycmVudFVzZXIuX2lkICsgJy9kaXNoZXMvJyArIGRpc2hfaWQpLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vYXV0aG9yaXplIHVzZXJcbiAgICAgICAgdXNlckZhY3RvcnkuYXV0aG9yaXplID0gZnVuY3Rpb24ocmVxdWlyZVBlcm1pc3Npb25zKSB7XG4gICAgICAgICAgICByZXR1cm4gdXNlckZhY3RvcnkuZ2V0Q3VycmVudFVzZXIoKS50aGVuKGZ1bmN0aW9uKHVzZXIpIHtcbiAgICAgICAgICAgICAgICBpZiAodXNlciAmJiByZXF1aXJlUGVybWlzc2lvbnMuaW5kZXhPZih1c2VyLnJvbGUpID49IDApIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIHVzZXJGYWN0b3J5O1xuICAgIH0pO1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9