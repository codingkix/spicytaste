angular.module("spicyTaste",["ngRoute","angular-md5","ngMaterial","ngAnimate","ngMessages"]).constant("CONSTANTS",{FB_APP_ID:0x58e0e66b31adc,FACEBOOK:"FB",EMAIL:"EMAIL",SOCIAL_PASS:"P@ssw0rd",LOCAL_STORAGE_KEY:"spicyTasteUser",LATEST_COUNT:10}),angular.module("spicyTaste").config(["$mdThemingProvider","$mdIconProvider",function(e,t){var n=e.extendPalette("deep-orange",{500:"f27242"}),i=e.extendPalette("blue",{500:"6984b4",600:"6984b4"});e.definePalette("primaryOrange",n),e.definePalette("primaryBlue",i),e.theme("default").primaryPalette("primaryOrange").accentPalette("light-green"),e.theme("blue").primaryPalette("primaryBlue"),t.icon("menu","svg/ic_menu_24px.svg").icon("share","svg/ic_share_48px.svg").icon("login","svg/ic_account_circle_24px.svg").icon("recipes","svg/ic_event_note_48px.svg").icon("restaurants","svg/ic_restaurant_menu_48px.svg").icon("ingredients","svg/ic_receipt_48px.svg").icon("arrow","svg/ic_arrow_drop_up_48px.svg").icon("more","svg/ic_more_24px.svg").icon("time1","svg/ic_av_timer_24px.svg").icon("time2","svg/ic_access_time_24px.svg").icon("difficulty","svg/ic_track_changes_24px.svg").icon("exit","svg/ic_exit_to_app_48px.svg").icon("photo","svg/ic_mms_24px.svg").icon("check","svg/ic_check_circle_24px.svg").icon("facebook","svg/facebook.svg").icon("twitter","svg/twitter.svg").icon("pinterest","svg/pinterest.svg").icon("comments","svg/ic_chat_48px.svg").icon("menu","svg/ic_menu_48px.svg").icon("favorite","svg/ic_favorite_24px.svg").icon("delete","svg/ic_delete_48px.svg").icon("add","svg/ic_add_circle_outline_48px.svg")}]),angular.module("spicyTaste").run(["$rootScope","$location","$window","CONSTANTS","UserService",function(e,t,n,i,o){n.fbAsyncInit=function(){FB.init({appId:i.FB_APP_ID,cookie:!0,xfbml:!0,version:"v2.2"})},function(e,t,n){var i,o=e.getElementsByTagName(t)[0];e.getElementById(n)||(i=e.createElement(t),i.id=n,i.src="//connect.facebook.net/en_US/sdk.js",o.parentNode.insertBefore(i,o))}(document,"script","facebook-jssdk"),e.$on("$routeChangeStart",function(e,n){n.access&&o.authorize(n.access.requirePermissions).then(function(e){e||t.path("not-authorize").replace()})})}]),angular.module("spicyTaste").config(["$locationProvider","$routeProvider",function(e,t){e.html5Mode(!0),t.when("/",{templateUrl:"ng/views/pages/home.html",controller:"HomeController",controllerAs:"home"}).when("/dishes",{templateUrl:"ng/views/pages/dish/all.html",controller:"DishListController",controllerAs:"dishList"}).when("/dishes/:dish_id",{templateUrl:"ng/views/pages/dish/detail.html",controller:"DishDetailController",controllerAs:"dishDetail"}).when("/admin/dishes",{templateUrl:"ng/views/pages/admin/dish/list.html",controller:"DishListController",controllerAs:"dishList",access:{requirePermissions:["Admin"]}}).when("/admin/dishes/:dish_id",{templateUrl:"ng/views/pages/admin/dish/single.html",controller:"DishEditController",controllerAs:"dishManage",access:{requirePermissions:["Admin"]}}).when("/login",{templateUrl:"ng/views/pages/user/login.html",controller:"LoginController",controllerAs:"login"}).when("/me",{templateUrl:"ng/views/pages/user/me.html",controller:"ProfileController",controllerAs:"me"}).when("/not-authorize",{templateUrl:"ng/views/pages/not-authorize.html"})}]),angular.module("spicyTaste").controller("DishListController",["DishService","SocialService","$location",function(e,t,n){var i=this;e.all().success(function(e){i.dishes=e}),i.deleteDish=function(t){var n=i.dishes[t];e["delete"](n._id).success(function(e){i.dishes.splice(t,1)})},i.addDish=function(){e.create({name:"new dish"}).success(function(e){n.path("/admin/dishes/"+e.dish._id)})},i.goToEdit=function(e){n.path("/admin/dishes/"+e)}}]).controller("DishDetailController",["$scope","$location","$rootScope","$routeParams","$filter","$mdDialog","DishService","UserService","SocialService",function(e,t,n,i,o,s,r,c,l){function a(){h.dish={},h.relatedDishes={},r.get(i.dish_id).success(function(e){if(h.dish=e,h.dish.isCollected=!1,r.relate(h.dish._id,h.dish.tags,3).success(function(e){h.relatedDishes=e}),n.currentUser){var t=o("filter")(n.currentUser.favouriteDishes,{_id:h.dish._id},!0);t.length&&(h.dish.isCollected=!0)}})}function u(e,t,n){s.show({targetEvent:t,clickOutsideToClose:!0,templateUrl:"ng/views/dialogs/comment.html",locals:{title:e},controller:d,controllerAs:"comment"}).then(function(e){r.addComment(h.dish._id,{content:e,replyTo:n}).success(function(e){h.dish.comments.push(e)})})}function d(e,t){var n=this;n.content="",n.title=e,n.closeDialog=function(){t.cancel()},n.submit=function(){""==n.content.trim()?t.cancel():t.hide(n.content)}}var h=this;h.dish={},a(),h.enterFlipBook=function(e){s.show({targetEvent:e,clickOutsideToClose:!0,templateUrl:"ng/views/dialogs/flipbook.html",controller:"DishDetailController",controllerAs:"book"})["finally"](function(){n.shownBook=!1}),n.shownBook=!0},e.$on("onRepeatLast",function(e,t,n){angular.element(t).parents("#dishBook").booklet({width:"100%",height:600,closed:!0,autoCenter:!0,pageNumbers:!1,pagePadding:0,hoverWidth:100})}),h.closeDialog=function(){s.cancel()},h.fbShare=function(e){var n=t.absUrl()+"/"+e._id;l.fbShare(n)},h.reply=function(e,t){var n="@"+e.userName;u(n,t,e._id)},h.collect=function(t){n.currentUser?c.collect(h.dish._id).then(function(e){e.success&&(h.dish.isCollected=!0)}):e.showLoginDialog(t,!0,"Login/SignUp first to save as favorite").then(function(e){n.currentUser=e,c.collect(h.dish._id).then(function(e){e.success&&(h.dish.isCollected=!0)})})},h.showInstructionPhoto=function(e,t){null!=e&&""!=e.trim()&&s.show({targetEvent:t,clickOutsideToClose:!0,template:'<md-dialog><md-dialog-content><img src="{{photo}}"></md-dialog-content></md-dialog>',controller:["$scope",function(t){t.photo=e}]})},h.newComment=function(t){n.currentUser?u("Comment",t,null):e.showLoginDialog(t,!0,"Login/SignUp first to leave a comment").then(function(e){n.currentUser=e,u("Comment",t,null)})},d.$inject=["title","$mdDialog"]}]).controller("DishEditController",["$mdDialog","$routeParams","DishService","$location","$timeout",function(e,t,n,i,o){function s(e){var t=this;t.newPhoto="",t.closeDialog=function(){e.cancel()},t.submit=function(){e.hide(t.newPhoto)}}function r(e){var t=this;t.newInstruction={photo:"",text:""},t.closeDialog=function(){e.cancel()},t.submit=function(){e.hide(t.newInstruction)}}function c(){n.get(t.dish_id).success(function(e){l.dish=e}),l.difficulties=n.getDifficulties()}var l=this;c(),l.saveDish=function(){n.update(t.dish_id,l.dish).success(function(e){l.updateSuccess=!0,o(function(){l.updateSuccess=!1},1e3)})},l.removeInstruction=function(e){n.removeInstruction(t.dish_id,l.dish.instructions[e]._id).success(function(t){l.dish.instructions.splice(e,1)})},l.removePhoto=function(e){l.dish.photos.splice(e,1),l.saveDish()},l.showAddPhotoDialog=function(t){e.show({targetEvent:t,controller:s,controllerAs:"photoDlg",clickOutsideToClose:!0,templateUrl:"ng/views/dialogs/addPhoto.html"}).then(function(e){l.dish.photos.push(e),l.saveDish()})},l.showAddInstructionDialog=function(i){e.show({targetEvent:i,controller:r,controllerAs:"instructionDlg",clickOutsideToClose:!0,templateUrl:"ng/views/dialogs/addInstruction.html"}).then(function(e){l.dish.instructions.push(e),n.addInstruction(t.dish_id,e).success(function(e){})})},s.$inject=["$mdDialog"],r.$inject=["$mdDialog"]}]),angular.module("spicyTaste").controller("HomeController",["$scope","$mdMedia","DishService","CONSTANTS",function(e,t,n,i){function o(){r.recipeTiles=[],e.$watch(function(){return t("sm")},function(t){e.smallScreen=t}),s()}function s(){n.limit(i.LATEST_COUNT).success(function(e){angular.forEach(e,function(e,t){var n={image:e.imageUrl,title:e.name,id:e._id,prepTime:e.prepTime,totalTime:e.totalTime,difficulty:e.difficulty,tags:e.tags,span:{row:1,col:1}};switch(t+1){case 1:n.span.row=n.span.col=2;break;case 2:case 3:break;case 4:n.span.col=2;case 5:case 6:break;case 7:n.span.row=n.span.col=2;case 8:case 9:break;case 10:n.span.col=2}r.recipeTiles.push(n)})})}var r=this;o()}]),angular.module("spicyTaste").controller("MainController",["$rootScope","$scope","$location","$mdDialog","$http","SessionService","UserService","CONSTANTS",function(e,t,n,i,o,s,r,c){"use strict";function l(e,t,n,i){function r(e){var n=o.defaults.headers.common["X-Auth"];s.setLocal(c.LOCAL_STORAGE_KEY,n),t.hide(e)}var l=this;l.title=e,l.email="",l.password="",l.userName="",l.fbLogin=function(){FB.login(function(e){"connected"===e.status?FB.api("/me",function(e){var t={userName:e.name,email:e.email,password:c.SOCIAL_PASS,photoUrl:"http://graph.facebook.com/"+e.id+"/picture?type=large",linkedSocial:c.FACEBOOK};n.socialLogin(t).then(function(e){e.loginType=c.FACEBOOK,r(e)})}):"not_authorized"===e.status},{scope:"public_profile,email"})},l.login=function(){n.login(l.email,l.password).then(function(e){e.loginType=c.EMAIL,r(e)})},l.signUp=function(){var e={userName:l.userName,email:l.email,password:l.password,photoUrl:"http://www.gravatar.com/avatar/"+i.createHash(l.email),linkedSocial:c.EMAIL};n.create(e).then(function(e){e.loginType=c.EMAIL,r(e)})}}function a(){u.showMobileMenu=!1;var t=s.getLocal(c.LOCAL_STORAGE_KEY);t&&(console.log("token",t),o.defaults.headers.common["X-Auth"]=t,r.getCurrentUser().then(function(t){e.currentUser=t}))}var u=this;a(),u.toggleMobileMenu=function(){u.showMobileMenu=!u.showMobileMenu},t.showLoginDialog=function(t,n,o){var s=i.show({clickOutsideToClose:!0,templateUrl:"ng/views/dialogs/login.html",targetEvent:t,controller:l,controllerAs:"login",locals:{dialogTitle:o}});return n?s:void s.then(function(t){e.currentUser=t})},l.$inject=["dialogTitle","$mdDialog","UserService","md5"]}]),angular.module("spicyTaste").controller("ProfileController",["$location","$rootScope","UserService",function(e,t,n){"use strict";function i(){o.user={},n.getById(t.currentUser._id).then(function(e){o.user=e})}var o=this;i(),o.logout=function(){n.logout(),t.currentUser=null,e.path("/")}}]),angular.module("spicyTaste").directive("contenteditable",function(){return{require:"ngModel",restrict:"A",link:function(e,t,n,i){i.$render=function(){t.html(i.$viewValue||"")},t.bind("blur",function(){e.$apply(function(){i.$setViewValue(t.html())})})}}}),angular.module("spicyTaste").directive("flipbook",function(){return{transclude:!1,restrict:"E",replace:!0,templateUrl:"ng/views/templates/flipbook.html",scope:{dish:"="}}}),angular.module("spicyTaste").directive("focusOn",function(){return{restrict:"A",scope:{focusValue:"=focusOn"},link:function(e,t){e.$watch("focusValue",function(e,n){e&&!n&&t[0].focus()})}}}),angular.module("spicyTaste").directive("onLastRepeat",["$timeout",function(e){return function(t,n,i){t.$last&&e(function(){t.$emit("onRepeatLast",n,i)},0)}}]),angular.module("spicyTaste").directive("scrollTo",function(){return{restrict:"A",link:function(e,t,n){var i=$(n.scrollTo);t.on("click",function(){console.log("offset",i.offset().top),$("html, body").animate({scrollTop:i.offset().top},600)})}}}),angular.module("spicyTaste").factory("DishService",["$http",function(e){var t={};return t.all=function(){return e.get("/api/dishes")},t.limit=function(t){return e.get("/api/dishes?limit="+t)},t.relate=function(t,n,i){return e({method:"GET",url:"/api/dishes",params:{id:t,limit:i,"tags[]":n}})},t.create=function(t){return e.post("/api/dishes",t)},t.get=function(t){return e.get("/api/dishes/"+t)},t.update=function(t,n){return e.put("/api/dishes/"+t,n)},t["delete"]=function(t){return e["delete"]("/api/dishes/"+t)},t.addComment=function(t,n){return e.post("/api/dishes/"+t+"/comments",n)},t.addInstruction=function(t,n){return e.post("/api/dishes/"+t+"/instructions",n)},t.removeInstruction=function(t,n){return e["delete"]("/api/dishes/"+t+"/instructions/"+n)},t.getDifficulties=function(){return["初学","容易","一般","较难","专业"]},t}]),angular.module("spicyTaste").factory("SessionService",["$window",function(e){var t={};return t.getLocal=function(t){if(e.localStorage){var n=e.localStorage.getItem(t);return angular.fromJson(n)}return!1},t.setLocal=function(t,n){return e.localStorage&&e.localStorage.setItem(t,angular.toJson(n))},t}]),angular.module("spicyTaste").factory("SocialService",function(){var e={};return e.fbShare=function(e){FB.ui({method:"share",href:e},function(e){})},e}),angular.module("spicyTaste").factory("UserService",["$http","$rootScope","$window","CONSTANTS",function(e,t,n,i){"use strict";var o={};return o.socialLogin=function(e){return o.searchBy("email="+e.email).then(function(t){return t.success?o.login(e.email,i.SOCIAL_PASS):o.create(e)})},o.login=function(t,n){return e.post("/api/auth",{email:t,password:n}).then(function(t){return e.defaults.headers.common["X-Auth"]=t.data.token,o.getById(t.data.userId)})},o.logout=function(){delete e.defaults.headers.common["X-Auth"],n.localStorage.removeItem(i.LOCAL_STORAGE_KEY),o.loginedUser=null},o.searchBy=function(t){return e.get("/api/users?"+t).then(function(e){return e.data})},o.getCurrentUser=function(){return e.get("/api/me").then(function(e){return o.getById(e.data)})},o.getById=function(t){return e.get("/api/users/"+t).then(function(e){return e.data})},o.create=function(t){return e.post("/api/users/",t).then(function(){return o.login(t.email,t.password)})},o.update=function(t){return e.put("/api/users/"+t.user_id,t).then(function(e){return e.data})},o.collect=function(n){return e.put("/api/users/"+t.currentUser._id+"/dishes/"+n).then(function(e){return e.data})},o.authorize=function(e){return o.getCurrentUser().then(function(t){return t&&e.indexOf(t.role)>=0?!0:!1},function(e){return!1})},o}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsImRlc2lnbi5qcyIsIm1vZHVsZS5ydW4uanMiLCJyb3V0ZXMuanMiLCJjb250cm9sbGVycy9kaXNoQ29udHJvbGxlci5qcyIsImFwcC5qcyIsImNvbnRyb2xsZXJzL2hvbWVDb250cm9sbGVyLmpzIiwiY29udHJvbGxlcnMvbWFpbkNvbnRyb2xsZXIuanMiLCJjb250cm9sbGVycy9wcm9maWxlQ29udHJvbGxlci5qcyIsImRpcmVjdGl2ZXMvY29udGVudGVkaXRhYmxlRGlyZWN0aXZlLmpzIiwiZGlyZWN0aXZlcy9mbGlwQm9va0RpcmVjdGl2ZS5qcyIsImRpcmVjdGl2ZXMvZm9jdXNPbkRpcmVjdGl2ZS5qcyIsImRpcmVjdGl2ZXMvb25MYXN0UmVwZWF0LmpzIiwiZGlyZWN0aXZlcy9zY3JvbGxUb0RpcmVjdGl2ZS5qcyIsInNlcnZpY2VzL2Rpc2hTZXJ2aWNlLmpzIiwic2VydmljZXMvc2Vzc2lvblNlcnZpY2UuanMiLCJzZXJ2aWNlcy9zb2NpYWxTZXJ2aWNlLmpzIiwic2VydmljZXMvdXNlclNlcnZpY2UuanMiXSwibmFtZXMiOlsiYW5ndWxhciIsIm1vZHVsZSIsImNvbnN0YW50IiwiRkJfQVBQX0lEIiwiRkFDRUJPT0siLCJFTUFJTCIsIlNPQ0lBTF9QQVNTIiwiTE9DQUxfU1RPUkFHRV9LRVkiLCJMQVRFU1RfQ09VTlQiLCJjb25maWciLCIkbWRUaGVtaW5nUHJvdmlkZXIiLCIkbWRJY29uUHJvdmlkZXIiLCJwcmltYXJ5T3JhbmdlIiwiZXh0ZW5kUGFsZXR0ZSIsIjUwMCIsInByaW1hcnlCbHVlIiwiNjAwIiwiZGVmaW5lUGFsZXR0ZSIsInRoZW1lIiwicHJpbWFyeVBhbGV0dGUiLCJhY2NlbnRQYWxldHRlIiwiaWNvbiIsInJ1biIsIiRyb290U2NvcGUiLCIkbG9jYXRpb24iLCIkd2luZG93IiwiQ09OU1RBTlRTIiwiVXNlclNlcnZpY2UiLCJmYkFzeW5jSW5pdCIsIkZCIiwiaW5pdCIsImFwcElkIiwiY29va2llIiwieGZibWwiLCJ2ZXJzaW9uIiwiZCIsInMiLCJpZCIsImpzIiwiZmpzIiwiZ2V0RWxlbWVudHNCeVRhZ05hbWUiLCJnZXRFbGVtZW50QnlJZCIsImNyZWF0ZUVsZW1lbnQiLCJzcmMiLCJwYXJlbnROb2RlIiwiaW5zZXJ0QmVmb3JlIiwiZG9jdW1lbnQiLCIkb24iLCJldmVudCIsIm5leHQiLCJhY2Nlc3MiLCJhdXRob3JpemUiLCJyZXF1aXJlUGVybWlzc2lvbnMiLCJ0aGVuIiwicmVzdWx0IiwicGF0aCIsInJlcGxhY2UiLCIkbG9jYXRpb25Qcm92aWRlciIsIiRyb3V0ZVByb3ZpZGVyIiwiaHRtbDVNb2RlIiwid2hlbiIsInRlbXBsYXRlVXJsIiwiY29udHJvbGxlciIsImNvbnRyb2xsZXJBcyIsIkRpc2hTZXJ2aWNlIiwiU29jaWFsU2VydmljZSIsInZtIiwidGhpcyIsImFsbCIsInN1Y2Nlc3MiLCJkYXRhIiwiZGlzaGVzIiwiZGVsZXRlRGlzaCIsImluZGV4IiwiZGlzaCIsIl9pZCIsInNwbGljZSIsImFkZERpc2giLCJjcmVhdGUiLCJuYW1lIiwiZ29Ub0VkaXQiLCIkc2NvcGUiLCIkcm91dGVQYXJhbXMiLCIkZmlsdGVyIiwiJG1kRGlhbG9nIiwicmVsYXRlZERpc2hlcyIsImdldCIsImRpc2hfaWQiLCJpc0NvbGxlY3RlZCIsInJlbGF0ZSIsInRhZ3MiLCJjdXJyZW50VXNlciIsImZvdW5kIiwiZmF2b3VyaXRlRGlzaGVzIiwibGVuZ3RoIiwib3BlbkNvbW1lbnREaWFsb2ciLCJ0aXRsZSIsIiRldmVudCIsInJlcGx5VG8iLCJzaG93IiwidGFyZ2V0RXZlbnQiLCJjbGlja091dHNpZGVUb0Nsb3NlIiwibG9jYWxzIiwiY29tbWVudENvbnRyb2xsZXIiLCJjb250ZW50IiwiYWRkQ29tbWVudCIsImNvbW1lbnQiLCJjb21tZW50cyIsInB1c2giLCJkdm0iLCJjbG9zZURpYWxvZyIsImNhbmNlbCIsInN1Ym1pdCIsInRyaW0iLCJoaWRlIiwiZW50ZXJGbGlwQm9vayIsImV2biIsInNob3duQm9vayIsInNjb3BlIiwiZWxlbWVudCIsImF0dHJzIiwicGFyZW50cyIsImJvb2tsZXQiLCJ3aWR0aCIsImhlaWdodCIsImNsb3NlZCIsImF1dG9DZW50ZXIiLCJwYWdlTnVtYmVycyIsInBhZ2VQYWRkaW5nIiwiaG92ZXJXaWR0aCIsImZiU2hhcmUiLCJkaXNoTGluayIsImFic1VybCIsInJlcGx5IiwidXNlciIsImNvbW1lbnRUaXRsZSIsInVzZXJOYW1lIiwiY29sbGVjdCIsInNob3dMb2dpbkRpYWxvZyIsInNob3dJbnN0cnVjdGlvblBob3RvIiwicGhvdG9VcmwiLCJ0ZW1wbGF0ZSIsInBob3RvIiwibmV3Q29tbWVudCIsIiRpbmplY3QiLCIkdGltZW91dCIsInBob3RvRGlhbG9nQ29udHJvbGxlciIsIm5ld1Bob3RvIiwiaW5zdHJ1Y3Rpb25EaWFsb2dDb250cm9sbGVyIiwibmV3SW5zdHJ1Y3Rpb24iLCJ0ZXh0IiwiZGlmZmljdWx0aWVzIiwiZ2V0RGlmZmljdWx0aWVzIiwic2F2ZURpc2giLCJ1cGRhdGUiLCJ1cGRhdGVTdWNjZXNzIiwicmVtb3ZlSW5zdHJ1Y3Rpb24iLCJpbnN0cnVjdGlvbnMiLCJyZW1vdmVQaG90byIsInBob3RvcyIsInNob3dBZGRQaG90b0RpYWxvZyIsInNob3dBZGRJbnN0cnVjdGlvbkRpYWxvZyIsImFkZEluc3RydWN0aW9uIiwiJG1kTWVkaWEiLCJyZWNpcGVUaWxlcyIsIiR3YXRjaCIsImlzU21hbGwiLCJzbWFsbFNjcmVlbiIsImJ1aWxkR3JpZCIsImxpbWl0IiwiZm9yRWFjaCIsInRpbGUiLCJpbWFnZSIsImltYWdlVXJsIiwicHJlcFRpbWUiLCJ0b3RhbFRpbWUiLCJkaWZmaWN1bHR5Iiwic3BhbiIsInJvdyIsImNvbCIsIiRodHRwIiwiU2Vzc2lvblNlcnZpY2UiLCJsb2dpbkNvbnRyb2xsZXIiLCJkaWFsb2dUaXRsZSIsIm1kNSIsImFmdGVyQXV0aCIsInRva2VuIiwiZGVmYXVsdHMiLCJoZWFkZXJzIiwiY29tbW9uIiwic2V0TG9jYWwiLCJlbWFpbCIsInBhc3N3b3JkIiwiZmJMb2dpbiIsImxvZ2luIiwicmVzcG9uc2UiLCJzdGF0dXMiLCJhcGkiLCJmYlVzZXIiLCJsaW5rZWRTb2NpYWwiLCJzb2NpYWxMb2dpbiIsImxvZ2luVHlwZSIsInNpZ25VcCIsIm5ld1VzZXIiLCJjcmVhdGVIYXNoIiwic2hvd01vYmlsZU1lbnUiLCJsb2dpbmVkVG9rZW4iLCJnZXRMb2NhbCIsImNvbnNvbGUiLCJsb2ciLCJnZXRDdXJyZW50VXNlciIsInRvZ2dsZU1vYmlsZU1lbnUiLCJldiIsInBvc3RMb2dpbiIsInByb21pc2UiLCJnZXRCeUlkIiwibG9nb3V0IiwiZGlyZWN0aXZlIiwicmVxdWlyZSIsInJlc3RyaWN0IiwibGluayIsImF0dHJpYnV0cyIsIm5nTW9kZWwiLCIkcmVuZGVyIiwiaHRtbCIsIiR2aWV3VmFsdWUiLCJiaW5kIiwiJGFwcGx5IiwiJHNldFZpZXdWYWx1ZSIsInRyYW5zY2x1ZGUiLCJmb2N1c1ZhbHVlIiwiJGVsZW1lbnQiLCJjdXJyZW50VmFsdWUiLCJwcmV2aW91c1ZhbHVlIiwiZm9jdXMiLCIkYXR0cnMiLCIkbGFzdCIsIiRlbWl0IiwiJHRhcmdldCIsIiQiLCJzY3JvbGxUbyIsIm9uIiwib2Zmc2V0IiwidG9wIiwiYW5pbWF0ZSIsInNjcm9sbFRvcCIsImZhY3RvcnkiLCJkaXNoRmFjdG9yeSIsIm51bSIsIm1ldGhvZCIsInVybCIsInBhcmFtcyIsInRhZ3NbXSIsInBvc3QiLCJwdXQiLCJpbnN0cnVjdGlvbiIsImluc3RydWN0aW9uX2lkIiwic2Vzc2lvbkZhY3RvcnkiLCJrZXkiLCJsb2NhbFN0b3JhZ2UiLCJnZXRJdGVtIiwiZnJvbUpzb24iLCJzZXRJdGVtIiwidG9Kc29uIiwic29jaWFsRmFjdG9yeSIsInVpIiwiaHJlZiIsInVzZXJGYWN0b3J5Iiwic29jaWFsVXNlciIsInNlYXJjaEJ5IiwidXNlcklkIiwicmVtb3ZlSXRlbSIsImxvZ2luZWRVc2VyIiwicXVlcnkiLCJ1c2VyX2lkIiwiaW5kZXhPZiIsInJvbGUiXSwibWFwcGluZ3MiOiJB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QUEyTCxHQUFBNU4sS0FBQSxTQUFBOEksR0FDQSxNQUFBQSxHQUFBN0gsUUFJQXFNLEVBQUF6RCxlQUFBLFdBQ0EsTUFBQTlCLEdBQUE5RixJQUFBLFdBQUFqQyxLQUFBLFNBQUE4SSxHQUNBLE1BQUF3RSxHQUFBcEQsUUFBQXBCLEVBQUE3SCxTQUtBcU0sRUFBQXBELFFBQUEsU0FBQTJELEdBQ0EsTUFBQTlGLEdBQUE5RixJQUFBLGNBQUE0TCxHQUFBN04sS0FBQSxTQUFBOEksR0FDQSxNQUFBQSxHQUFBN0gsUUFLQXFNLEVBQUE3TCxPQUFBLFNBQUF3RCxHQUNBLE1BQUE4QyxHQUFBeUUsS0FBQSxjQUFBdkgsR0FBQWpGLEtBQUEsV0FDQSxNQUFBc04sR0FBQXpFLE1BQUE1RCxFQUFBeUQsTUFBQXpELEVBQUEwRCxhQUtBMkUsRUFBQWpILE9BQUEsU0FBQXBCLEdBQ0EsTUFBQThDLEdBQUEwRSxJQUFBLGNBQUF4SCxFQUFBNEksUUFBQTVJLEdBQUFqRixLQUFBLFNBQUE4SSxHQUNBLE1BQUFBLEdBQUE3SCxRQUtBcU0sRUFBQWxJLFFBQUEsU0FBQWxELEdBQ0EsTUFBQTZGLEdBQUEwRSxJQUFBLGNBQUF2TyxFQUFBb0UsWUFBQWhCLElBQUEsV0FBQVksR0FBQWxDLEtBQUEsU0FBQThJLEdBQ0EsTUFBQUEsR0FBQTdILFFBS0FxTSxFQUFBeE4sVUFBQSxTQUFBQyxHQUNBLE1BQUF1TixHQUFBekQsaUJBQUE3SixLQUFBLFNBQUFpRixHQUNBLE1BQUFBLElBQUFsRixFQUFBK04sUUFBQTdJLEVBQUE4SSxPQUFBLEdBQ0EsR0FFQSxHQUVBLFNBQUFqRixHQUNBLE9BQUEsS0FJQXdFIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCdzcGljeVRhc3RlJywgWyduZ1JvdXRlJywgJ2FuZ3VsYXItbWQ1JywgJ25nTWF0ZXJpYWwnLCAnbmdBbmltYXRlJywgJ25nTWVzc2FnZXMnXSlcbiAgICAuY29uc3RhbnQoJ0NPTlNUQU5UUycsIHtcbiAgICAgICAgXCJGQl9BUFBfSURcIjogMTU2MzU2NzM4NzI1MzQ2OCxcbiAgICAgICAgXCJGQUNFQk9PS1wiOiBcIkZCXCIsXG4gICAgICAgIFwiRU1BSUxcIjogXCJFTUFJTFwiLFxuICAgICAgICBcIlNPQ0lBTF9QQVNTXCI6IFwiUEBzc3cwcmRcIixcbiAgICAgICAgXCJMT0NBTF9TVE9SQUdFX0tFWVwiOiBcInNwaWN5VGFzdGVVc2VyXCIsXG4gICAgICAgIFwiTEFURVNUX0NPVU5UXCI6IDEwXG4gICAgfSk7XG4iLCJhbmd1bGFyLm1vZHVsZSgnc3BpY3lUYXN0ZScpXG4gICAgLmNvbmZpZyhmdW5jdGlvbigkbWRUaGVtaW5nUHJvdmlkZXIsICRtZEljb25Qcm92aWRlcikge1xuXG4gICAgICAgIHZhciBwcmltYXJ5T3JhbmdlID0gJG1kVGhlbWluZ1Byb3ZpZGVyLmV4dGVuZFBhbGV0dGUoJ2RlZXAtb3JhbmdlJywge1xuICAgICAgICAgICAgJzUwMCc6ICdmMjcyNDInXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHZhciBwcmltYXJ5Qmx1ZSA9ICRtZFRoZW1pbmdQcm92aWRlci5leHRlbmRQYWxldHRlKCdibHVlJywge1xuICAgICAgICAgICAgJzUwMCc6ICc2OTg0YjQnLFxuICAgICAgICAgICAgJzYwMCc6ICc2OTg0YjQnXG4gICAgICAgIH0pO1xuXG4gICAgICAgICRtZFRoZW1pbmdQcm92aWRlci5kZWZpbmVQYWxldHRlKCdwcmltYXJ5T3JhbmdlJywgcHJpbWFyeU9yYW5nZSk7XG4gICAgICAgICRtZFRoZW1pbmdQcm92aWRlci5kZWZpbmVQYWxldHRlKCdwcmltYXJ5Qmx1ZScsIHByaW1hcnlCbHVlKTtcblxuICAgICAgICAkbWRUaGVtaW5nUHJvdmlkZXIudGhlbWUoJ2RlZmF1bHQnKVxuICAgICAgICAgICAgLnByaW1hcnlQYWxldHRlKCdwcmltYXJ5T3JhbmdlJylcbiAgICAgICAgICAgIC5hY2NlbnRQYWxldHRlKCdsaWdodC1ncmVlbicpO1xuXG4gICAgICAgICRtZFRoZW1pbmdQcm92aWRlci50aGVtZSgnYmx1ZScpXG4gICAgICAgICAgICAucHJpbWFyeVBhbGV0dGUoJ3ByaW1hcnlCbHVlJyk7XG5cbiAgICAgICAgJG1kSWNvblByb3ZpZGVyLmljb24oJ21lbnUnLCAnc3ZnL2ljX21lbnVfMjRweC5zdmcnKVxuICAgICAgICAgICAgLmljb24oJ3NoYXJlJywgJ3N2Zy9pY19zaGFyZV80OHB4LnN2ZycpXG4gICAgICAgICAgICAuaWNvbignbG9naW4nLCAnc3ZnL2ljX2FjY291bnRfY2lyY2xlXzI0cHguc3ZnJylcbiAgICAgICAgICAgIC5pY29uKCdyZWNpcGVzJywgJ3N2Zy9pY19ldmVudF9ub3RlXzQ4cHguc3ZnJylcbiAgICAgICAgICAgIC5pY29uKCdyZXN0YXVyYW50cycsICdzdmcvaWNfcmVzdGF1cmFudF9tZW51XzQ4cHguc3ZnJylcbiAgICAgICAgICAgIC5pY29uKCdpbmdyZWRpZW50cycsICdzdmcvaWNfcmVjZWlwdF80OHB4LnN2ZycpXG4gICAgICAgICAgICAuaWNvbignYXJyb3cnLCAnc3ZnL2ljX2Fycm93X2Ryb3BfdXBfNDhweC5zdmcnKVxuICAgICAgICAgICAgLmljb24oJ21vcmUnLCAnc3ZnL2ljX21vcmVfMjRweC5zdmcnKVxuICAgICAgICAgICAgLmljb24oJ3RpbWUxJywgJ3N2Zy9pY19hdl90aW1lcl8yNHB4LnN2ZycpXG4gICAgICAgICAgICAuaWNvbigndGltZTInLCAnc3ZnL2ljX2FjY2Vzc190aW1lXzI0cHguc3ZnJylcbiAgICAgICAgICAgIC5pY29uKCdkaWZmaWN1bHR5JywgJ3N2Zy9pY190cmFja19jaGFuZ2VzXzI0cHguc3ZnJylcbiAgICAgICAgICAgIC5pY29uKCdleGl0JywgJ3N2Zy9pY19leGl0X3RvX2FwcF80OHB4LnN2ZycpXG4gICAgICAgICAgICAuaWNvbigncGhvdG8nLCAnc3ZnL2ljX21tc18yNHB4LnN2ZycpXG4gICAgICAgICAgICAuaWNvbignY2hlY2snLCAnc3ZnL2ljX2NoZWNrX2NpcmNsZV8yNHB4LnN2ZycpXG4gICAgICAgICAgICAuaWNvbignZmFjZWJvb2snLCAnc3ZnL2ZhY2Vib29rLnN2ZycpXG4gICAgICAgICAgICAuaWNvbigndHdpdHRlcicsICdzdmcvdHdpdHRlci5zdmcnKVxuICAgICAgICAgICAgLmljb24oJ3BpbnRlcmVzdCcsICdzdmcvcGludGVyZXN0LnN2ZycpXG4gICAgICAgICAgICAuaWNvbignY29tbWVudHMnLCAnc3ZnL2ljX2NoYXRfNDhweC5zdmcnKVxuICAgICAgICAgICAgLmljb24oJ21lbnUnLCAnc3ZnL2ljX21lbnVfNDhweC5zdmcnKVxuICAgICAgICAgICAgLmljb24oJ2Zhdm9yaXRlJywgJ3N2Zy9pY19mYXZvcml0ZV8yNHB4LnN2ZycpXG4gICAgICAgICAgICAuaWNvbignZGVsZXRlJywgJ3N2Zy9pY19kZWxldGVfNDhweC5zdmcnKVxuICAgICAgICAgICAgLmljb24oJ2FkZCcsICdzdmcvaWNfYWRkX2NpcmNsZV9vdXRsaW5lXzQ4cHguc3ZnJyk7XG4gICAgfSk7XG4iLCJhbmd1bGFyLm1vZHVsZSgnc3BpY3lUYXN0ZScpXG4gICAgLnJ1bihmdW5jdGlvbigkcm9vdFNjb3BlLCAkbG9jYXRpb24sICR3aW5kb3csIENPTlNUQU5UUywgVXNlclNlcnZpY2UpIHtcbiAgICAgICAgJHdpbmRvdy5mYkFzeW5jSW5pdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgRkIuaW5pdCh7XG4gICAgICAgICAgICAgICAgYXBwSWQ6IENPTlNUQU5UUy5GQl9BUFBfSUQsXG4gICAgICAgICAgICAgICAgY29va2llOiB0cnVlLCAvLyBlbmFibGUgY29va2llcyB0byBhbGxvdyB0aGUgc2VydmVyIHRvIGFjY2VzcyB0aGUgc2Vzc2lvblxuICAgICAgICAgICAgICAgIHhmYm1sOiB0cnVlLCAvLyBwYXJzZSBzb2NpYWwgcGx1Z2lucyBvbiB0aGlzIHBhZ2VcbiAgICAgICAgICAgICAgICB2ZXJzaW9uOiAndjIuMicgLy8gdXNlIHZlcnNpb24gMi4yXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBMb2FkIHRoZSBTREsgYXN5bmNocm9ub3VzbHlcbiAgICAgICAgKGZ1bmN0aW9uKGQsIHMsIGlkKSB7XG4gICAgICAgICAgICB2YXIganMsIGZqcyA9IGQuZ2V0RWxlbWVudHNCeVRhZ05hbWUocylbMF07XG4gICAgICAgICAgICBpZiAoZC5nZXRFbGVtZW50QnlJZChpZCkpIHJldHVybjtcbiAgICAgICAgICAgIGpzID0gZC5jcmVhdGVFbGVtZW50KHMpO1xuICAgICAgICAgICAganMuaWQgPSBpZDtcbiAgICAgICAgICAgIGpzLnNyYyA9IFwiLy9jb25uZWN0LmZhY2Vib29rLm5ldC9lbl9VUy9zZGsuanNcIjtcbiAgICAgICAgICAgIGZqcy5wYXJlbnROb2RlLmluc2VydEJlZm9yZShqcywgZmpzKTtcbiAgICAgICAgfShkb2N1bWVudCwgJ3NjcmlwdCcsICdmYWNlYm9vay1qc3NkaycpKTtcblxuICAgICAgICAvL0NoZWNrIEF1dGhvcml6YXRpb25cbiAgICAgICAgJHJvb3RTY29wZS4kb24oJyRyb3V0ZUNoYW5nZVN0YXJ0JywgZnVuY3Rpb24oZXZlbnQsIG5leHQpe1xuICAgICAgICAgICAgaWYobmV4dC5hY2Nlc3Mpe1xuICAgICAgICAgICAgICAgIFVzZXJTZXJ2aWNlLmF1dGhvcml6ZShuZXh0LmFjY2Vzcy5yZXF1aXJlUGVybWlzc2lvbnMpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KXtcbiAgICAgICAgICAgICAgICAgICAgaWYoIXJlc3VsdClcbiAgICAgICAgICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKCdub3QtYXV0aG9yaXplJykucmVwbGFjZSgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgIH0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ3NwaWN5VGFzdGUnKVxuICAgIC5jb25maWcoZnVuY3Rpb24oJGxvY2F0aW9uUHJvdmlkZXIsICRyb3V0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRsb2NhdGlvblByb3ZpZGVyLmh0bWw1TW9kZSh0cnVlKTtcblxuICAgICAgICAkcm91dGVQcm92aWRlclxuICAgICAgICAvL2hvbWUgcGFnZVxuICAgICAgICAgICAgLndoZW4oJy8nLCB7XG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICduZy92aWV3cy9wYWdlcy9ob21lLmh0bWwnLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdIb21lQ29udHJvbGxlcicsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiAnaG9tZSdcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAvL3Nob3cgYWxsIGRpc2hlcyBwYWdlXG4gICAgICAgICAgICAud2hlbignL2Rpc2hlcycsIHtcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25nL3ZpZXdzL3BhZ2VzL2Rpc2gvYWxsLmh0bWwnLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdEaXNoTGlzdENvbnRyb2xsZXInLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ2Rpc2hMaXN0J1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC8vc2hvdyBkaXNoIGRldGFpbCBwYWdlXG4gICAgICAgICAgICAud2hlbignL2Rpc2hlcy86ZGlzaF9pZCcsIHtcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25nL3ZpZXdzL3BhZ2VzL2Rpc2gvZGV0YWlsLmh0bWwnLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdEaXNoRGV0YWlsQ29udHJvbGxlcicsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiAnZGlzaERldGFpbCdcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAvL2xpc3QgYWRtaW4gZGlzaCBwYWdlXG4gICAgICAgICAgICAud2hlbignL2FkbWluL2Rpc2hlcycsIHtcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25nL3ZpZXdzL3BhZ2VzL2FkbWluL2Rpc2gvbGlzdC5odG1sJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnRGlzaExpc3RDb250cm9sbGVyJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6ICdkaXNoTGlzdCcsXG4gICAgICAgICAgICAgICAgYWNjZXNzOiB7XG4gICAgICAgICAgICAgICAgICAgIHJlcXVpcmVQZXJtaXNzaW9uczogWydBZG1pbiddXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC8vZWRpdCBhIGRpc2ggcGFnZVxuICAgICAgICAgICAgLndoZW4oJy9hZG1pbi9kaXNoZXMvOmRpc2hfaWQnLCB7XG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICduZy92aWV3cy9wYWdlcy9hZG1pbi9kaXNoL3NpbmdsZS5odG1sJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnRGlzaEVkaXRDb250cm9sbGVyJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6ICdkaXNoTWFuYWdlJyxcbiAgICAgICAgICAgICAgICBhY2Nlc3M6IHtcbiAgICAgICAgICAgICAgICAgICAgcmVxdWlyZVBlcm1pc3Npb25zOiBbJ0FkbWluJ11cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLy9sb2dpbiB1c2VyXG4gICAgICAgICAgICAud2hlbignL2xvZ2luJywge1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbmcvdmlld3MvcGFnZXMvdXNlci9sb2dpbi5odG1sJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnTG9naW5Db250cm9sbGVyJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6ICdsb2dpbidcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAvL3VzZXIgcHJvZmlsZVxuICAgICAgICAgICAgLndoZW4oJy9tZScsIHtcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25nL3ZpZXdzL3BhZ2VzL3VzZXIvbWUuaHRtbCcsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ1Byb2ZpbGVDb250cm9sbGVyJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6ICdtZSdcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAud2hlbignL25vdC1hdXRob3JpemUnLCB7XG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICduZy92aWV3cy9wYWdlcy9ub3QtYXV0aG9yaXplLmh0bWwnXG4gICAgICAgICAgICB9KVxuICAgIH0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ3NwaWN5VGFzdGUnKVxuICAgIC8vY29udHJvbGxlciBhcHBsaWVkIHRvIGRpc2ggbGlzdCBwYWdlXG4gICAgLmNvbnRyb2xsZXIoJ0Rpc2hMaXN0Q29udHJvbGxlcicsIGZ1bmN0aW9uKERpc2hTZXJ2aWNlLCBTb2NpYWxTZXJ2aWNlLCAkbG9jYXRpb24pIHtcbiAgICAgICAgdmFyIHZtID0gdGhpcztcblxuICAgICAgICAvL2dyYWIgYWxsIHRoZSBkaXNoZXMgYXQgcGFnZSBsb2FkXG4gICAgICAgIERpc2hTZXJ2aWNlLmFsbCgpLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgLy9iaW5kIHRoZSBkaXNoZXNcbiAgICAgICAgICAgIHZtLmRpc2hlcyA9IGRhdGE7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vZnVuY3Rpb24gdG8gZGVsZXRlIGEgZGlzaFxuICAgICAgICB2bS5kZWxldGVEaXNoID0gZnVuY3Rpb24oaW5kZXgpIHtcbiAgICAgICAgICAgIHZhciBkaXNoID0gdm0uZGlzaGVzW2luZGV4XTtcbiAgICAgICAgICAgIERpc2hTZXJ2aWNlLmRlbGV0ZShkaXNoLl9pZCkuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgdm0uZGlzaGVzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICB2bS5hZGREaXNoID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBEaXNoU2VydmljZS5jcmVhdGUoe1xuICAgICAgICAgICAgICAgIG5hbWU6ICduZXcgZGlzaCdcbiAgICAgICAgICAgIH0pLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKCcvYWRtaW4vZGlzaGVzLycgKyBkYXRhLmRpc2guX2lkKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgdm0uZ29Ub0VkaXQgPSBmdW5jdGlvbihpZCkge1xuICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy9hZG1pbi9kaXNoZXMvJyArIGlkKTtcbiAgICAgICAgfVxuXG4gICAgfSlcbiAgICAvL2NvbnRyb2xsZXIgYXBwbGllZCB0byBkaXNoIGRldGFpbCBwYWdlXG4gICAgLmNvbnRyb2xsZXIoJ0Rpc2hEZXRhaWxDb250cm9sbGVyJywgZnVuY3Rpb24oJHNjb3BlLCAkbG9jYXRpb24sICRyb290U2NvcGUsICRyb3V0ZVBhcmFtcywgJGZpbHRlciwgJG1kRGlhbG9nLCBEaXNoU2VydmljZSwgVXNlclNlcnZpY2UsIFNvY2lhbFNlcnZpY2UpIHtcbiAgICAgICAgdmFyIHZtID0gdGhpcztcbiAgICAgICAgdm0uZGlzaCA9IHt9O1xuICAgICAgICBpbml0KCk7XG5cbiAgICAgICAgdm0uZW50ZXJGbGlwQm9vayA9IGZ1bmN0aW9uKGV2bikge1xuICAgICAgICAgICAgJG1kRGlhbG9nLnNob3coe1xuICAgICAgICAgICAgICAgIHRhcmdldEV2ZW50OiBldm4sXG4gICAgICAgICAgICAgICAgY2xpY2tPdXRzaWRlVG9DbG9zZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25nL3ZpZXdzL2RpYWxvZ3MvZmxpcGJvb2suaHRtbCcsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ0Rpc2hEZXRhaWxDb250cm9sbGVyJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6ICdib29rJ1xuICAgICAgICAgICAgfSkuZmluYWxseShmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLnNob3duQm9vayA9IGZhbHNlO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICRyb290U2NvcGUuc2hvd25Cb29rID0gdHJ1ZTtcbiAgICAgICAgfTtcblxuICAgICAgICAvL2NhbGwgYm9va2xldCBwbHVnaW5cbiAgICAgICAgJHNjb3BlLiRvbignb25SZXBlYXRMYXN0JywgZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHJzKSB7XG4gICAgICAgICAgICBhbmd1bGFyLmVsZW1lbnQoZWxlbWVudCkucGFyZW50cygnI2Rpc2hCb29rJykuYm9va2xldCh7XG4gICAgICAgICAgICAgICAgd2lkdGg6ICcxMDAlJyxcbiAgICAgICAgICAgICAgICBoZWlnaHQ6IDYwMCxcbiAgICAgICAgICAgICAgICBjbG9zZWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgYXV0b0NlbnRlcjogdHJ1ZSxcbiAgICAgICAgICAgICAgICBwYWdlTnVtYmVyczogZmFsc2UsXG4gICAgICAgICAgICAgICAgcGFnZVBhZGRpbmc6IDAsXG4gICAgICAgICAgICAgICAgaG92ZXJXaWR0aDogMTAwXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdm0uY2xvc2VEaWFsb2cgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICRtZERpYWxvZy5jYW5jZWwoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZtLmZiU2hhcmUgPSBmdW5jdGlvbihkaXNoKSB7XG4gICAgICAgICAgICB2YXIgZGlzaExpbmsgPSAkbG9jYXRpb24uYWJzVXJsKCkgKyAnLycgKyBkaXNoLl9pZDtcbiAgICAgICAgICAgIFNvY2lhbFNlcnZpY2UuZmJTaGFyZShkaXNoTGluayk7XG4gICAgICAgIH1cblxuICAgICAgICB2bS5yZXBseSA9IGZ1bmN0aW9uKHVzZXIsICRldmVudCkge1xuICAgICAgICAgICAgdmFyIGNvbW1lbnRUaXRsZSA9ICdAJyArIHVzZXIudXNlck5hbWU7XG4gICAgICAgICAgICBvcGVuQ29tbWVudERpYWxvZyhjb21tZW50VGl0bGUsICRldmVudCwgdXNlci5faWQpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHZtLmNvbGxlY3QgPSBmdW5jdGlvbigkZXZlbnQpIHtcbiAgICAgICAgICAgIGlmICghJHJvb3RTY29wZS5jdXJyZW50VXNlcikge1xuICAgICAgICAgICAgICAgICRzY29wZS5zaG93TG9naW5EaWFsb2coJGV2ZW50LCB0cnVlLCAnTG9naW4vU2lnblVwIGZpcnN0IHRvIHNhdmUgYXMgZmF2b3JpdGUnKS50aGVuKGZ1bmN0aW9uKHVzZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5jdXJyZW50VXNlciA9IHVzZXI7XG5cbiAgICAgICAgICAgICAgICAgICAgVXNlclNlcnZpY2UuY29sbGVjdCh2bS5kaXNoLl9pZCkudGhlbihmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5zdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdm0uZGlzaC5pc0NvbGxlY3RlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIFVzZXJTZXJ2aWNlLmNvbGxlY3Qodm0uZGlzaC5faWQpLnRoZW4oZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5zdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2bS5kaXNoLmlzQ29sbGVjdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgdm0uc2hvd0luc3RydWN0aW9uUGhvdG8gPSBmdW5jdGlvbihwaG90b1VybCwgJGV2ZW50KSB7XG4gICAgICAgICAgICBpZiAocGhvdG9VcmwgPT0gbnVsbCB8fCBwaG90b1VybC50cmltKCkgPT0gJycpXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuXG4gICAgICAgICAgICAkbWREaWFsb2cuc2hvdyh7XG4gICAgICAgICAgICAgICAgdGFyZ2V0RXZlbnQ6ICRldmVudCxcbiAgICAgICAgICAgICAgICBjbGlja091dHNpZGVUb0Nsb3NlOiB0cnVlLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlOiAnPG1kLWRpYWxvZz4nICtcbiAgICAgICAgICAgICAgICAgICAgJzxtZC1kaWFsb2ctY29udGVudD48aW1nIHNyYz1cInt7cGhvdG99fVwiPjwvbWQtZGlhbG9nLWNvbnRlbnQ+JyArXG4gICAgICAgICAgICAgICAgICAgICc8L21kLWRpYWxvZz4nLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6IGZ1bmN0aW9uIERpYWxvZ0N0cigkc2NvcGUpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnBob3RvID0gcGhvdG9Vcmw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICB2bS5uZXdDb21tZW50ID0gZnVuY3Rpb24oJGV2ZW50KSB7XG4gICAgICAgICAgICBpZiAoISRyb290U2NvcGUuY3VycmVudFVzZXIpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2hvd0xvZ2luRGlhbG9nKCRldmVudCwgdHJ1ZSwgJ0xvZ2luL1NpZ25VcCBmaXJzdCB0byBsZWF2ZSBhIGNvbW1lbnQnKS50aGVuKGZ1bmN0aW9uKHVzZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5jdXJyZW50VXNlciA9IHVzZXI7XG4gICAgICAgICAgICAgICAgICAgIG9wZW5Db21tZW50RGlhbG9nKCdDb21tZW50JywgJGV2ZW50LCBudWxsKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBvcGVuQ29tbWVudERpYWxvZygnQ29tbWVudCcsICRldmVudCwgbnVsbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBpbml0KCkge1xuICAgICAgICAgICAgdm0uZGlzaCA9IHt9O1xuICAgICAgICAgICAgdm0ucmVsYXRlZERpc2hlcyA9IHt9O1xuXG4gICAgICAgICAgICAvL2dldCB0aGUgZGlzaCBieSBpZFxuICAgICAgICAgICAgRGlzaFNlcnZpY2UuZ2V0KCRyb3V0ZVBhcmFtcy5kaXNoX2lkKS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICB2bS5kaXNoID0gZGF0YTtcbiAgICAgICAgICAgICAgICB2bS5kaXNoLmlzQ29sbGVjdGVkID0gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICAvL2dldCB0aGUgMyByZWxhdGVkIGRpc2hlc1xuICAgICAgICAgICAgICAgIERpc2hTZXJ2aWNlLnJlbGF0ZSh2bS5kaXNoLl9pZCwgdm0uZGlzaC50YWdzLCAzKS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgdm0ucmVsYXRlZERpc2hlcyA9IGRhdGE7XG4gICAgICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgICAgIGlmICgkcm9vdFNjb3BlLmN1cnJlbnRVc2VyKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBmb3VuZCA9ICRmaWx0ZXIoJ2ZpbHRlcicpKCRyb290U2NvcGUuY3VycmVudFVzZXIuZmF2b3VyaXRlRGlzaGVzLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfaWQ6IHZtLmRpc2guX2lkXG4gICAgICAgICAgICAgICAgICAgIH0sIHRydWUpO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChmb3VuZC5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZtLmRpc2guaXNDb2xsZWN0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIG9wZW5Db21tZW50RGlhbG9nKHRpdGxlLCAkZXZlbnQsIHJlcGx5VG8pIHtcbiAgICAgICAgICAgICRtZERpYWxvZy5zaG93KHtcbiAgICAgICAgICAgICAgICB0YXJnZXRFdmVudDogJGV2ZW50LFxuICAgICAgICAgICAgICAgIGNsaWNrT3V0c2lkZVRvQ2xvc2U6IHRydWUsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICduZy92aWV3cy9kaWFsb2dzL2NvbW1lbnQuaHRtbCcsXG4gICAgICAgICAgICAgICAgbG9jYWxzOiB7XG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiB0aXRsZVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogY29tbWVudENvbnRyb2xsZXIsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiAnY29tbWVudCdcbiAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24oY29udGVudCkge1xuICAgICAgICAgICAgICAgIERpc2hTZXJ2aWNlLmFkZENvbW1lbnQodm0uZGlzaC5faWQsIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGVudDogY29udGVudCxcbiAgICAgICAgICAgICAgICAgICAgcmVwbHlUbzogcmVwbHlUb1xuICAgICAgICAgICAgICAgIH0pLnN1Y2Nlc3MoZnVuY3Rpb24oY29tbWVudCkge1xuICAgICAgICAgICAgICAgICAgICB2bS5kaXNoLmNvbW1lbnRzLnB1c2goY29tbWVudCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGNvbW1lbnRDb250cm9sbGVyKHRpdGxlLCAkbWREaWFsb2cpIHtcbiAgICAgICAgICAgIHZhciBkdm0gPSB0aGlzO1xuICAgICAgICAgICAgZHZtLmNvbnRlbnQgPSAnJztcbiAgICAgICAgICAgIGR2bS50aXRsZSA9IHRpdGxlO1xuXG4gICAgICAgICAgICBkdm0uY2xvc2VEaWFsb2cgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAkbWREaWFsb2cuY2FuY2VsKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGR2bS5zdWJtaXQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBpZiAoZHZtLmNvbnRlbnQudHJpbSgpID09ICcnKVxuICAgICAgICAgICAgICAgICAgICAkbWREaWFsb2cuY2FuY2VsKClcbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgICRtZERpYWxvZy5oaWRlKGR2bS5jb250ZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pXG4gICAgLy9jb250cm9sbGVyIGFwcGxpZWQgdG8gZGlzaCBlZGl0IHBhZ2VcbiAgICAuY29udHJvbGxlcignRGlzaEVkaXRDb250cm9sbGVyJywgZnVuY3Rpb24oJG1kRGlhbG9nLCAkcm91dGVQYXJhbXMsIERpc2hTZXJ2aWNlLCAkbG9jYXRpb24sICR0aW1lb3V0KSB7XG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG4gICAgICAgIGluaXQoKTtcblxuICAgICAgICB2bS5zYXZlRGlzaCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgRGlzaFNlcnZpY2UudXBkYXRlKCRyb3V0ZVBhcmFtcy5kaXNoX2lkLCB2bS5kaXNoKS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICB2bS51cGRhdGVTdWNjZXNzID0gdHJ1ZTtcblxuICAgICAgICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICB2bS51cGRhdGVTdWNjZXNzID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfSwgMTAwMCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICB9XG5cbiAgICAgICAgdm0ucmVtb3ZlSW5zdHJ1Y3Rpb24gPSBmdW5jdGlvbihpbmRleCkge1xuICAgICAgICAgICAgRGlzaFNlcnZpY2UucmVtb3ZlSW5zdHJ1Y3Rpb24oJHJvdXRlUGFyYW1zLmRpc2hfaWQsIHZtLmRpc2guaW5zdHJ1Y3Rpb25zW2luZGV4XS5faWQpLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgIHZtLmRpc2guaW5zdHJ1Y3Rpb25zLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZtLnJlbW92ZVBob3RvID0gZnVuY3Rpb24oaW5kZXgpIHtcbiAgICAgICAgICAgIHZtLmRpc2gucGhvdG9zLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICB2bS5zYXZlRGlzaCgpO1xuICAgICAgICB9XG5cbiAgICAgICAgdm0uc2hvd0FkZFBob3RvRGlhbG9nID0gZnVuY3Rpb24oZXZuKSB7XG4gICAgICAgICAgICAkbWREaWFsb2cuc2hvdyh7XG4gICAgICAgICAgICAgICAgdGFyZ2V0RXZlbnQ6IGV2bixcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiBwaG90b0RpYWxvZ0NvbnRyb2xsZXIsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiAncGhvdG9EbGcnLFxuICAgICAgICAgICAgICAgIGNsaWNrT3V0c2lkZVRvQ2xvc2U6IHRydWUsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICduZy92aWV3cy9kaWFsb2dzL2FkZFBob3RvLmh0bWwnXG4gICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uKG5ld1Bob3RvKSB7XG4gICAgICAgICAgICAgICAgdm0uZGlzaC5waG90b3MucHVzaChuZXdQaG90byk7XG4gICAgICAgICAgICAgICAgdm0uc2F2ZURpc2goKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgdm0uc2hvd0FkZEluc3RydWN0aW9uRGlhbG9nID0gZnVuY3Rpb24oZXZuKSB7XG4gICAgICAgICAgICAkbWREaWFsb2cuc2hvdyh7XG4gICAgICAgICAgICAgICAgdGFyZ2V0RXZlbnQ6IGV2bixcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiBpbnN0cnVjdGlvbkRpYWxvZ0NvbnRyb2xsZXIsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiAnaW5zdHJ1Y3Rpb25EbGcnLFxuICAgICAgICAgICAgICAgIGNsaWNrT3V0c2lkZVRvQ2xvc2U6IHRydWUsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICduZy92aWV3cy9kaWFsb2dzL2FkZEluc3RydWN0aW9uLmh0bWwnXG4gICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uKG5ld0luc3RydWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgdm0uZGlzaC5pbnN0cnVjdGlvbnMucHVzaChuZXdJbnN0cnVjdGlvbik7XG4gICAgICAgICAgICAgICAgRGlzaFNlcnZpY2UuYWRkSW5zdHJ1Y3Rpb24oJHJvdXRlUGFyYW1zLmRpc2hfaWQsIG5ld0luc3RydWN0aW9uKS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBwaG90b0RpYWxvZ0NvbnRyb2xsZXIoJG1kRGlhbG9nKSB7XG4gICAgICAgICAgICB2YXIgZHZtID0gdGhpcztcbiAgICAgICAgICAgIGR2bS5uZXdQaG90byA9ICcnO1xuXG4gICAgICAgICAgICBkdm0uY2xvc2VEaWFsb2cgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAkbWREaWFsb2cuY2FuY2VsKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGR2bS5zdWJtaXQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAkbWREaWFsb2cuaGlkZShkdm0ubmV3UGhvdG8pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gaW5zdHJ1Y3Rpb25EaWFsb2dDb250cm9sbGVyKCRtZERpYWxvZykge1xuICAgICAgICAgICAgdmFyIGR2bSA9IHRoaXM7XG5cbiAgICAgICAgICAgIGR2bS5uZXdJbnN0cnVjdGlvbiA9IHtcbiAgICAgICAgICAgICAgICBwaG90bzogJycsXG4gICAgICAgICAgICAgICAgdGV4dDogJydcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGR2bS5jbG9zZURpYWxvZyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICRtZERpYWxvZy5jYW5jZWwoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZHZtLnN1Ym1pdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICRtZERpYWxvZy5oaWRlKGR2bS5uZXdJbnN0cnVjdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBpbml0KCkge1xuICAgICAgICAgICAgLy9nZXQgdGhlIGRpc2ggYnkgaWRcbiAgICAgICAgICAgIERpc2hTZXJ2aWNlLmdldCgkcm91dGVQYXJhbXMuZGlzaF9pZCkuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgdm0uZGlzaCA9IGRhdGE7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHZtLmRpZmZpY3VsdGllcyA9IERpc2hTZXJ2aWNlLmdldERpZmZpY3VsdGllcygpO1xuICAgICAgICB9XG4gICAgfSk7XG4iLG51bGwsImFuZ3VsYXIubW9kdWxlKCdzcGljeVRhc3RlJylcbiAgICAuY29udHJvbGxlcignSG9tZUNvbnRyb2xsZXInLCBmdW5jdGlvbigkc2NvcGUsICRtZE1lZGlhLCBEaXNoU2VydmljZSwgQ09OU1RBTlRTKSB7XG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG4gICAgICAgIGluaXQoKTtcblxuICAgICAgICBmdW5jdGlvbiBpbml0KCkge1xuICAgICAgICAgICAgdm0ucmVjaXBlVGlsZXMgPSBbXTtcbiAgICAgICAgICAgICRzY29wZS4kd2F0Y2goZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICRtZE1lZGlhKCdzbScpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24oaXNTbWFsbCkge1xuICAgICAgICAgICAgICAgICRzY29wZS5zbWFsbFNjcmVlbiA9IGlzU21hbGw7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgYnVpbGRHcmlkKCk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBidWlsZEdyaWQoKSB7XG4gICAgICAgICAgICBEaXNoU2VydmljZS5saW1pdChDT05TVEFOVFMuTEFURVNUX0NPVU5UKS5zdWNjZXNzKGZ1bmN0aW9uKGRpc2hlcykge1xuICAgICAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChkaXNoZXMsIGZ1bmN0aW9uKGRpc2gsIGluZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0aWxlID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgaW1hZ2U6IGRpc2guaW1hZ2VVcmwsXG4gICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogZGlzaC5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IGRpc2guX2lkLFxuICAgICAgICAgICAgICAgICAgICAgICAgcHJlcFRpbWU6IGRpc2gucHJlcFRpbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICB0b3RhbFRpbWU6IGRpc2gudG90YWxUaW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGlmZmljdWx0eTogZGlzaC5kaWZmaWN1bHR5LFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnczogZGlzaC50YWdzLFxuICAgICAgICAgICAgICAgICAgICAgICAgc3Bhbjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvdzogMSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2w6IDFcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKGluZGV4ICsgMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpbGUuc3Bhbi5yb3cgPSB0aWxlLnNwYW4uY29sID0gMjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aWxlLnNwYW4uY29sID0gMjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNTpcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aWxlLnNwYW4ucm93ID0gdGlsZS5zcGFuLmNvbCA9IDI7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDg6XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDk6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDEwOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpbGUuc3Bhbi5jb2wgPSAyO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgdm0ucmVjaXBlVGlsZXMucHVzaCh0aWxlKTtcblxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgIH0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ3NwaWN5VGFzdGUnKVxuICAgIC5jb250cm9sbGVyKCdNYWluQ29udHJvbGxlcicsIGZ1bmN0aW9uKCRyb290U2NvcGUsICRzY29wZSwgJGxvY2F0aW9uLCAkbWREaWFsb2csICRodHRwLCBTZXNzaW9uU2VydmljZSwgVXNlclNlcnZpY2UsIENPTlNUQU5UUykge1xuICAgICAgICAndXNlIHN0cmljdCc7XG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG4gICAgICAgIGluaXQoKTtcblxuICAgICAgICB2bS50b2dnbGVNb2JpbGVNZW51ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2bS5zaG93TW9iaWxlTWVudSA9ICF2bS5zaG93TW9iaWxlTWVudTtcbiAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUuc2hvd0xvZ2luRGlhbG9nID0gZnVuY3Rpb24oZXYsIHBvc3RMb2dpbiwgdGl0bGUpIHtcbiAgICAgICAgICAgIHZhciBwcm9taXNlID0gJG1kRGlhbG9nLnNob3coe1xuICAgICAgICAgICAgICAgIGNsaWNrT3V0c2lkZVRvQ2xvc2U6IHRydWUsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICduZy92aWV3cy9kaWFsb2dzL2xvZ2luLmh0bWwnLFxuICAgICAgICAgICAgICAgIHRhcmdldEV2ZW50OiBldixcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiBsb2dpbkNvbnRyb2xsZXIsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiAnbG9naW4nLFxuICAgICAgICAgICAgICAgIGxvY2Fsczoge1xuICAgICAgICAgICAgICAgICAgICBkaWFsb2dUaXRsZTogdGl0bGVcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmIChwb3N0TG9naW4pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcHJvbWlzZS50aGVuKGZ1bmN0aW9uKHVzZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5jdXJyZW50VXNlciA9IHVzZXI7XG4gICAgICAgICAgICAgICAgICAgIC8vIGlmICh1c2VyLnJvbGUgJiYgdXNlci5yb2xlID09IFwiQWRtaW5cIikge1xuICAgICAgICAgICAgICAgICAgICAvLyAgICAgJGxvY2F0aW9uLnBhdGgoJy9hZG1pbi9kaXNoZXMnKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICRsb2NhdGlvbi5wYXRoKCcvJyk7XG4gICAgICAgICAgICAgICAgICAgIC8vIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICBmdW5jdGlvbiBsb2dpbkNvbnRyb2xsZXIoZGlhbG9nVGl0bGUsICRtZERpYWxvZywgVXNlclNlcnZpY2UsIG1kNSkge1xuICAgICAgICAgICAgdmFyIGR2bSA9IHRoaXM7XG4gICAgICAgICAgICBkdm0udGl0bGUgPSBkaWFsb2dUaXRsZTtcbiAgICAgICAgICAgIGR2bS5lbWFpbCA9ICcnO1xuICAgICAgICAgICAgZHZtLnBhc3N3b3JkID0gJyc7XG4gICAgICAgICAgICBkdm0udXNlck5hbWUgPSAnJztcblxuICAgICAgICAgICAgZHZtLmZiTG9naW4gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBGQi5sb2dpbihmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSAnY29ubmVjdGVkJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gTG9nZ2VkIGludG8geW91ciBhcHAgYW5kIEZhY2Vib29rLlxuICAgICAgICAgICAgICAgICAgICAgICAgRkIuYXBpKCcvbWUnLCBmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmYlVzZXIgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJOYW1lOiByZXNwb25zZS5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbWFpbDogcmVzcG9uc2UuZW1haWwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhc3N3b3JkOiBDT05TVEFOVFMuU09DSUFMX1BBU1MsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBob3RvVXJsOiAnaHR0cDovL2dyYXBoLmZhY2Vib29rLmNvbS8nICsgcmVzcG9uc2UuaWQgKyAnL3BpY3R1cmU/dHlwZT1sYXJnZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmtlZFNvY2lhbDogQ09OU1RBTlRTLkZBQ0VCT09LXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFVzZXJTZXJ2aWNlLnNvY2lhbExvZ2luKGZiVXNlcikudGhlbihmdW5jdGlvbih1c2VyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXIubG9naW5UeXBlID0gQ09OU1RBTlRTLkZBQ0VCT09LO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZnRlckF1dGgodXNlcik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gJ25vdF9hdXRob3JpemVkJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhlIHBlcnNvbiBpcyBsb2dnZWQgaW50byBGYWNlYm9vaywgYnV0IG5vdCB5b3VyIGFwcC5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoZSBwZXJzb24gaXMgbm90IGxvZ2dlZCBpbnRvIEZhY2Vib29rLCBzbyB3ZSdyZSBub3Qgc3VyZSBpZlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhleSBhcmUgbG9nZ2VkIGludG8gdGhpcyBhcHAgb3Igbm90LlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgICAgICBzY29wZTogJ3B1YmxpY19wcm9maWxlLGVtYWlsJ1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgZHZtLmxvZ2luID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgVXNlclNlcnZpY2UubG9naW4oZHZtLmVtYWlsLCBkdm0ucGFzc3dvcmQpLnRoZW4oZnVuY3Rpb24odXNlcikge1xuICAgICAgICAgICAgICAgICAgICB1c2VyLmxvZ2luVHlwZSA9IENPTlNUQU5UUy5FTUFJTDtcbiAgICAgICAgICAgICAgICAgICAgYWZ0ZXJBdXRoKHVzZXIpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgZHZtLnNpZ25VcCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHZhciBuZXdVc2VyID0ge1xuICAgICAgICAgICAgICAgICAgICB1c2VyTmFtZTogZHZtLnVzZXJOYW1lLFxuICAgICAgICAgICAgICAgICAgICBlbWFpbDogZHZtLmVtYWlsLFxuICAgICAgICAgICAgICAgICAgICBwYXNzd29yZDogZHZtLnBhc3N3b3JkLFxuICAgICAgICAgICAgICAgICAgICBwaG90b1VybDogJ2h0dHA6Ly93d3cuZ3JhdmF0YXIuY29tL2F2YXRhci8nICsgbWQ1LmNyZWF0ZUhhc2goZHZtLmVtYWlsKSxcbiAgICAgICAgICAgICAgICAgICAgbGlua2VkU29jaWFsOiBDT05TVEFOVFMuRU1BSUxcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgVXNlclNlcnZpY2UuY3JlYXRlKG5ld1VzZXIpLnRoZW4oZnVuY3Rpb24odXNlcikge1xuICAgICAgICAgICAgICAgICAgICB1c2VyLmxvZ2luVHlwZSA9IENPTlNUQU5UUy5FTUFJTDtcbiAgICAgICAgICAgICAgICAgICAgYWZ0ZXJBdXRoKHVzZXIpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBhZnRlckF1dGgodXNlcikge1xuICAgICAgICAgICAgICAgIHZhciB0b2tlbiA9ICRodHRwLmRlZmF1bHRzLmhlYWRlcnMuY29tbW9uWydYLUF1dGgnXTtcbiAgICAgICAgICAgICAgICBTZXNzaW9uU2VydmljZS5zZXRMb2NhbChDT05TVEFOVFMuTE9DQUxfU1RPUkFHRV9LRVksIHRva2VuKTtcbiAgICAgICAgICAgICAgICAkbWREaWFsb2cuaGlkZSh1c2VyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgICAgICAgICB2bS5zaG93TW9iaWxlTWVudSA9IGZhbHNlO1xuICAgICAgICAgICAgdmFyIGxvZ2luZWRUb2tlbiA9IFNlc3Npb25TZXJ2aWNlLmdldExvY2FsKENPTlNUQU5UUy5MT0NBTF9TVE9SQUdFX0tFWSk7XG4gICAgICAgICAgICBpZiAobG9naW5lZFRva2VuKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3Rva2VuJywgbG9naW5lZFRva2VuKTtcblxuICAgICAgICAgICAgICAgICRodHRwLmRlZmF1bHRzLmhlYWRlcnMuY29tbW9uWydYLUF1dGgnXSA9IGxvZ2luZWRUb2tlbjtcbiAgICAgICAgICAgICAgICBVc2VyU2VydmljZS5nZXRDdXJyZW50VXNlcigpLnRoZW4oZnVuY3Rpb24odXNlcikge1xuICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmN1cnJlbnRVc2VyID0gdXNlcjtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgfSk7XG4iLCJhbmd1bGFyLm1vZHVsZSgnc3BpY3lUYXN0ZScpXG4gICAgLmNvbnRyb2xsZXIoJ1Byb2ZpbGVDb250cm9sbGVyJywgZnVuY3Rpb24oJGxvY2F0aW9uLCAkcm9vdFNjb3BlLCBVc2VyU2VydmljZSkge1xuICAgICAgICAndXNlIHN0cmljdCc7XG5cbiAgICAgICAgdmFyIHZtID0gdGhpcztcbiAgICAgICAgaW5pdCgpO1xuXG4gICAgICAgIHZtLmxvZ291dCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgVXNlclNlcnZpY2UubG9nb3V0KCk7XG4gICAgICAgICAgICAkcm9vdFNjb3BlLmN1cnJlbnRVc2VyID0gbnVsbDtcbiAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKCcvJyk7XG4gICAgICAgIH07XG5cbiAgICAgICAgZnVuY3Rpb24gaW5pdCgpIHtcbiAgICAgICAgICAgIHZtLnVzZXIgPSB7fTtcbiAgICAgICAgICAgIFVzZXJTZXJ2aWNlLmdldEJ5SWQoJHJvb3RTY29wZS5jdXJyZW50VXNlci5faWQpLnRoZW4oZnVuY3Rpb24odXNlcikge1xuICAgICAgICAgICAgICAgIHZtLnVzZXIgPSB1c2VyO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgIH0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ3NwaWN5VGFzdGUnKVxuICAgIC5kaXJlY3RpdmUoJ2NvbnRlbnRlZGl0YWJsZScsIGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcmVxdWlyZTogJ25nTW9kZWwnLFxuICAgICAgICAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAgICAgICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRyaWJ1dHMsIG5nTW9kZWwpIHtcbiAgICAgICAgICAgICAgICBuZ01vZGVsLiRyZW5kZXIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5odG1sKG5nTW9kZWwuJHZpZXdWYWx1ZSB8fCAnJyk7XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIGVsZW1lbnQuYmluZCgnYmx1cicsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICBzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZ01vZGVsLiRzZXRWaWV3VmFsdWUoZWxlbWVudC5odG1sKCkpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9KTtcbiIsImFuZ3VsYXIubW9kdWxlKCdzcGljeVRhc3RlJylcbiAgICAuZGlyZWN0aXZlKCdmbGlwYm9vaycsIGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdHJhbnNjbHVkZTogZmFsc2UsXG4gICAgICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICAgICAgcmVwbGFjZTogdHJ1ZSxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbmcvdmlld3MvdGVtcGxhdGVzL2ZsaXBib29rLmh0bWwnLFxuICAgICAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgICAgICBkaXNoOiAnPSdcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pXG4iLCJhbmd1bGFyLm1vZHVsZSgnc3BpY3lUYXN0ZScpXG4gICAgLmRpcmVjdGl2ZSgnZm9jdXNPbicsIGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAgICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICAgICAgZm9jdXNWYWx1ZTogXCI9Zm9jdXNPblwiXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgbGluazogZnVuY3Rpb24oJHNjb3BlLCAkZWxlbWVudCkge1xuICAgICAgICAgICAgICAgICRzY29wZS4kd2F0Y2goJ2ZvY3VzVmFsdWUnLCBmdW5jdGlvbihjdXJyZW50VmFsdWUsIHByZXZpb3VzVmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRWYWx1ZSAmJiAhcHJldmlvdXNWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJGVsZW1lbnRbMF0uZm9jdXMoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ3NwaWN5VGFzdGUnKVxuICAgIC5kaXJlY3RpdmUoJ29uTGFzdFJlcGVhdCcsIGZ1bmN0aW9uKCR0aW1lb3V0KSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbigkc2NvcGUsICRlbGVtZW50LCAkYXR0cnMpIHtcbiAgICAgICAgICAgIGlmICgkc2NvcGUuJGxhc3QpIHtcbiAgICAgICAgICAgICAgICAkdGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLiRlbWl0KCdvblJlcGVhdExhc3QnLCAkZWxlbWVudCwgJGF0dHJzKTtcbiAgICAgICAgICAgICAgICB9LCAwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ3NwaWN5VGFzdGUnKVxuICAgIC5kaXJlY3RpdmUoJ3Njcm9sbFRvJywgZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgICAgICAgbGluazogZnVuY3Rpb24oc2NvcGUsICRlbGVtZW50LCBhdHRycykge1xuICAgICAgICAgICAgICAgIHZhciAkdGFyZ2V0ID0gJChhdHRycy5zY3JvbGxUbyk7XG4gICAgICAgICAgICAgICAgJGVsZW1lbnQub24oJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdvZmZzZXQnLCAkdGFyZ2V0Lm9mZnNldCgpLnRvcCk7XG4gICAgICAgICAgICAgICAgICAgICQoJ2h0bWwsIGJvZHknKS5hbmltYXRlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjcm9sbFRvcDogJHRhcmdldC5vZmZzZXQoKS50b3BcbiAgICAgICAgICAgICAgICAgICAgfSwgNjAwKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9KTtcbiIsImFuZ3VsYXIubW9kdWxlKCdzcGljeVRhc3RlJylcbiAgICAuZmFjdG9yeSgnRGlzaFNlcnZpY2UnLCBmdW5jdGlvbigkaHR0cCkge1xuXG4gICAgICAgIC8vY3JlYXRlIGEgbmV3IG9iamVjdFxuICAgICAgICB2YXIgZGlzaEZhY3RvcnkgPSB7fTtcblxuICAgICAgICAvL2dldCBhbGwgZGlzaGVzXG4gICAgICAgIGRpc2hGYWN0b3J5LmFsbCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS9kaXNoZXMnKTtcbiAgICAgICAgfTtcblxuICAgICAgICAvL2dldCBsaW1pdGVkIGxhdGVzdCBkaXNoZXNcbiAgICAgICAgZGlzaEZhY3RvcnkubGltaXQgPSBmdW5jdGlvbihudW0pIHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvZGlzaGVzP2xpbWl0PScgKyBudW0pO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9nZXQgcmVsYXRlZCBkaXNoZXMgYnkgdGFnc1xuICAgICAgICBkaXNoRmFjdG9yeS5yZWxhdGUgPSBmdW5jdGlvbihpZCwgdGFncywgbnVtKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAoe1xuICAgICAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgICAgICAgICAgdXJsOiAnL2FwaS9kaXNoZXMnLFxuICAgICAgICAgICAgICAgIHBhcmFtczoge1xuICAgICAgICAgICAgICAgICAgICBpZDogaWQsXG4gICAgICAgICAgICAgICAgICAgIGxpbWl0OiBudW0sXG4gICAgICAgICAgICAgICAgICAgICd0YWdzW10nOiB0YWdzXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICAvL2NyZWF0ZSBhIGRpc2hcbiAgICAgICAgZGlzaEZhY3RvcnkuY3JlYXRlID0gZnVuY3Rpb24oZGlzaCkge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLnBvc3QoJy9hcGkvZGlzaGVzJywgZGlzaCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy9nZXQgYSBzaW5nbGUgZGlzaFxuICAgICAgICBkaXNoRmFjdG9yeS5nZXQgPSBmdW5jdGlvbihkaXNoX2lkKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL2Rpc2hlcy8nICsgZGlzaF9pZCk7XG4gICAgICAgIH1cblxuICAgICAgICAvL3VwZGF0ZSBhIGRpc2hcbiAgICAgICAgZGlzaEZhY3RvcnkudXBkYXRlID0gZnVuY3Rpb24oZGlzaF9pZCwgZGlzaCkge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLnB1dCgnL2FwaS9kaXNoZXMvJyArIGRpc2hfaWQsIGRpc2gpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9kZWxldGUgYSBkaXNoXG4gICAgICAgIGRpc2hGYWN0b3J5LmRlbGV0ZSA9IGZ1bmN0aW9uKGRpc2hfaWQpIHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5kZWxldGUoJy9hcGkvZGlzaGVzLycgKyBkaXNoX2lkKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vYWRkIGEgY29tbWVudFxuICAgICAgICBkaXNoRmFjdG9yeS5hZGRDb21tZW50ID0gZnVuY3Rpb24oZGlzaF9pZCwgY29tbWVudCkge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLnBvc3QoJy9hcGkvZGlzaGVzLycgKyBkaXNoX2lkICsgJy9jb21tZW50cycsIGNvbW1lbnQpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9hZGQgYSBpbnN0cnVjdGlvblxuICAgICAgICBkaXNoRmFjdG9yeS5hZGRJbnN0cnVjdGlvbiA9IGZ1bmN0aW9uKGRpc2hfaWQsIGluc3RydWN0aW9uKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9kaXNoZXMvJyArIGRpc2hfaWQgKyAnL2luc3RydWN0aW9ucycsIGluc3RydWN0aW9uKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vcmVtb3ZlIGFuIGluc3RydWN0aW9uXG4gICAgICAgIGRpc2hGYWN0b3J5LnJlbW92ZUluc3RydWN0aW9uID0gZnVuY3Rpb24oZGlzaF9pZCwgaW5zdHJ1Y3Rpb25faWQpIHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5kZWxldGUoJy9hcGkvZGlzaGVzLycgKyBkaXNoX2lkICsgJy9pbnN0cnVjdGlvbnMvJyArIGluc3RydWN0aW9uX2lkKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vZ2V0IGRpZmZpY3VsdHlcbiAgICAgICAgZGlzaEZhY3RvcnkuZ2V0RGlmZmljdWx0aWVzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gWyfliJ3lraYnLCAn5a655piTJywgJ+S4gOiIrCcsICfovoPpmr4nLCAn5LiT5LiaJ107XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGRpc2hGYWN0b3J5O1xuICAgIH0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ3NwaWN5VGFzdGUnKVxuICAgIC5mYWN0b3J5KCdTZXNzaW9uU2VydmljZScsIGZ1bmN0aW9uKCR3aW5kb3cpIHtcbiAgICAgICAgdmFyIHNlc3Npb25GYWN0b3J5ID0ge307XG5cbiAgICAgICAgc2Vzc2lvbkZhY3RvcnkuZ2V0TG9jYWwgPSBmdW5jdGlvbihrZXkpIHtcbiAgICAgICAgICAgIGlmICgkd2luZG93LmxvY2FsU3RvcmFnZSkge1xuICAgICAgICAgICAgICAgIHZhciBkYXRhID0gJHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbShrZXkpO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGFuZ3VsYXIuZnJvbUpzb24oZGF0YSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICBzZXNzaW9uRmFjdG9yeS5zZXRMb2NhbCA9IGZ1bmN0aW9uKGtleSwgZGF0YSkge1xuICAgICAgICAgICAgcmV0dXJuICR3aW5kb3cubG9jYWxTdG9yYWdlICYmICR3aW5kb3cubG9jYWxTdG9yYWdlLnNldEl0ZW0oa2V5LCBhbmd1bGFyLnRvSnNvbihkYXRhKSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gc2Vzc2lvbkZhY3Rvcnk7XG5cbiAgICB9KTtcbiIsImFuZ3VsYXIubW9kdWxlKCdzcGljeVRhc3RlJylcbiAgICAuZmFjdG9yeSgnU29jaWFsU2VydmljZScsIGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgc29jaWFsRmFjdG9yeSA9IHt9O1xuXG4gICAgICAgIHNvY2lhbEZhY3RvcnkuZmJTaGFyZSA9IGZ1bmN0aW9uKGxpbmspIHtcbiAgICAgICAgICAgIEZCLnVpKHtcbiAgICAgICAgICAgICAgICBtZXRob2Q6ICdzaGFyZScsXG4gICAgICAgICAgICAgICAgaHJlZjogbGluayxcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHJlc3BvbnNlKSB7fSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gc29jaWFsRmFjdG9yeTtcbiAgICB9KTtcbiIsImFuZ3VsYXIubW9kdWxlKCdzcGljeVRhc3RlJylcbiAgICAuZmFjdG9yeSgnVXNlclNlcnZpY2UnLCBmdW5jdGlvbigkaHR0cCwgJHJvb3RTY29wZSwgJHdpbmRvdywgQ09OU1RBTlRTKSB7XG4gICAgICAgICd1c2Ugc3RyaWN0JztcblxuICAgICAgICB2YXIgdXNlckZhY3RvcnkgPSB7fTtcblxuICAgICAgICAvL3NvY2lhbCBsb2dpblxuICAgICAgICB1c2VyRmFjdG9yeS5zb2NpYWxMb2dpbiA9IGZ1bmN0aW9uKHNvY2lhbFVzZXIpIHtcbiAgICAgICAgICAgIHJldHVybiB1c2VyRmFjdG9yeS5zZWFyY2hCeSgnZW1haWw9JyArIHNvY2lhbFVzZXIuZW1haWwpLnRoZW4oZnVuY3Rpb24oZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgaWYgKCFkYXRhLnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9ub3QgZm91bmQsIHRoZW4gY3JlYXRlXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB1c2VyRmFjdG9yeS5jcmVhdGUoc29jaWFsVXNlcik7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy9mb3VuZCB0aGUgdXNlciB3aXRoIGVtYWlsXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB1c2VyRmFjdG9yeS5sb2dpbihzb2NpYWxVc2VyLmVtYWlsLCBDT05TVEFOVFMuU09DSUFMX1BBU1MpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vbG9naW4gdXNlclxuICAgICAgICB1c2VyRmFjdG9yeS5sb2dpbiA9IGZ1bmN0aW9uKGVtYWlsLCBwYXNzd29yZCkge1xuXG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9hdXRoJywge1xuICAgICAgICAgICAgICAgIGVtYWlsOiBlbWFpbCxcbiAgICAgICAgICAgICAgICBwYXNzd29yZDogcGFzc3dvcmRcbiAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAkaHR0cC5kZWZhdWx0cy5oZWFkZXJzLmNvbW1vblsnWC1BdXRoJ10gPSByZXNwb25zZS5kYXRhLnRva2VuO1xuICAgICAgICAgICAgICAgIHJldHVybiB1c2VyRmFjdG9yeS5nZXRCeUlkKHJlc3BvbnNlLmRhdGEudXNlcklkKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vbG9nb3V0IHVzZXJcbiAgICAgICAgdXNlckZhY3RvcnkubG9nb3V0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBkZWxldGUgJGh0dHAuZGVmYXVsdHMuaGVhZGVycy5jb21tb25bJ1gtQXV0aCddO1xuICAgICAgICAgICAgJHdpbmRvdy5sb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShDT05TVEFOVFMuTE9DQUxfU1RPUkFHRV9LRVkpO1xuICAgICAgICAgICAgdXNlckZhY3RvcnkubG9naW5lZFVzZXIgPSBudWxsO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vc2VhcmNoIHVzZXIgYnkgZmllbGRcbiAgICAgICAgdXNlckZhY3Rvcnkuc2VhcmNoQnkgPSBmdW5jdGlvbihxdWVyeSkge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS91c2Vycz8nICsgcXVlcnkpLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIHVzZXJGYWN0b3J5LmdldEN1cnJlbnRVc2VyID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL21lJykudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB1c2VyRmFjdG9yeS5nZXRCeUlkKHJlc3BvbnNlLmRhdGEpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy9nZXQgdXNlciBieSBpZFxuICAgICAgICB1c2VyRmFjdG9yeS5nZXRCeUlkID0gZnVuY3Rpb24odXNlcl9pZCkge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS91c2Vycy8nICsgdXNlcl9pZCkudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5kYXRhO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy9jcmVhdGUgYSBuZXcgdXNlclxuICAgICAgICB1c2VyRmFjdG9yeS5jcmVhdGUgPSBmdW5jdGlvbih1c2VyKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS91c2Vycy8nLCB1c2VyKS50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB1c2VyRmFjdG9yeS5sb2dpbih1c2VyLmVtYWlsLCB1c2VyLnBhc3N3b3JkKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vdXBkYXRlIHVzZXJcbiAgICAgICAgdXNlckZhY3RvcnkudXBkYXRlID0gZnVuY3Rpb24odXNlcikge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLnB1dCgnL2FwaS91c2Vycy8nICsgdXNlci51c2VyX2lkLCB1c2VyKS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGE7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICAvL2NvbGxlY3QgZGlzaCBhcyBmYXZvdXJpdGVcbiAgICAgICAgdXNlckZhY3RvcnkuY29sbGVjdCA9IGZ1bmN0aW9uKGRpc2hfaWQpIHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5wdXQoJy9hcGkvdXNlcnMvJyArICRyb290U2NvcGUuY3VycmVudFVzZXIuX2lkICsgJy9kaXNoZXMvJyArIGRpc2hfaWQpLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vYXV0aG9yaXplIHVzZXJcbiAgICAgICAgdXNlckZhY3RvcnkuYXV0aG9yaXplID0gZnVuY3Rpb24ocmVxdWlyZVBlcm1pc3Npb25zKSB7XG4gICAgICAgICAgICByZXR1cm4gdXNlckZhY3RvcnkuZ2V0Q3VycmVudFVzZXIoKS50aGVuKGZ1bmN0aW9uKHVzZXIpIHtcbiAgICAgICAgICAgICAgICBpZiAodXNlciAmJiByZXF1aXJlUGVybWlzc2lvbnMuaW5kZXhPZih1c2VyLnJvbGUpID49IDApIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIHVzZXJGYWN0b3J5O1xuICAgIH0pO1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9