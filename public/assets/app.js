angular.module("spicyTaste",["ngRoute","angular-md5","ngMaterial","ngAnimate","ngMessages"]).constant("CONSTANTS",{FB_APP_ID:0x58e0e66b31adc,FACEBOOK:"FB",EMAIL:"EMAIL",SOCIAL_PASS:"PASSWORD",LOCAL_STORAGE_KEY:"spicyTasteUser",LATEST_COUNT:10}),angular.module("spicyTaste").config(["$mdThemingProvider","$mdIconProvider",function(e,n){var t=e.extendPalette("deep-orange",{500:"f27242"}),o=e.extendPalette("blue",{500:"6984b4",600:"6984b4"});e.definePalette("primaryOrange",t),e.definePalette("primaryBlue",o),e.theme("default").primaryPalette("primaryOrange").accentPalette("light-green"),e.theme("blue").primaryPalette("primaryBlue"),n.icon("menu","svg/ic_menu_24px.svg").icon("share","svg/ic_share_24px.svg").icon("login","svg/ic_account_circle_24px.svg").icon("recipes","svg/ic_event_note_48px.svg").icon("restaurants","svg/ic_restaurant_menu_48px.svg").icon("ingredients","svg/ic_receipt_48px.svg").icon("arrow","svg/ic_arrow_drop_up_48px.svg").icon("more","svg/ic_more_24px.svg").icon("time1","svg/ic_av_timer_24px.svg").icon("time2","svg/ic_access_time_24px.svg").icon("difficulty","svg/ic_track_changes_24px.svg").icon("exit","svg/ic_exit_to_app_48px.svg").icon("photo","svg/ic_mms_24px.svg").icon("check","svg/ic_check_circle_24px.svg")}]),angular.module("spicyTaste").run(["$rootScope","$window","UserService","CONSTANTS",function(e,n,t,o){e.user=null,n.fbAsyncInit=function(){FB.init({appId:o.FB_APP_ID,cookie:!0,xfbml:!0,version:"v2.2"})},function(e,n,t){var o,i=e.getElementsByTagName(n)[0];e.getElementById(t)||(o=e.createElement(n),o.id=t,o.src="//connect.facebook.net/en_US/sdk.js",i.parentNode.insertBefore(o,i))}(document,"script","facebook-jssdk")}]),angular.module("spicyTaste").config(["$locationProvider","$routeProvider",function(e,n){e.html5Mode(!0),n.when("/",{templateUrl:"ng/views/pages/home.html",controller:"HomeController",controllerAs:"home"}).when("/dishes",{templateUrl:"ng/views/pages/dish/all.html",controller:"DishListController",controllerAs:"dishList"}).when("/dishes/:dish_id",{templateUrl:"ng/views/pages/dish/detail.html",controller:"DishDetailController",controllerAs:"detail"}).when("/admin/dishes/list",{templateUrl:"ng/views/pages/admin/dish/list.html",controller:"DishListController",controllerAs:"dishList"}).when("/admin/dishes/create",{templateUrl:"ng/views/pages/admin/dish/single.html",controller:"DishCreateController",controllerAs:"dishManage"}).when("/admin/dishes/:dish_id",{templateUrl:"ng/views/pages/admin/dish/single.html",controller:"DishEditController",controllerAs:"dishManage"}).when("/login",{templateUrl:"ng/views/pages/user/login.html",controller:"LoginController",controllerAs:"login"}).when("/me",{templateUrl:"ng/views/pages/user/me.html",controller:"ProfileController",controllerAs:"me"})}]),angular.module("spicyTaste").controller("DishListController",["DishService","SocialService","$location",function(e,n,t){var o=this;o.processing=!0,e.all().success(function(e){o.processing=!1,o.dishes=e}),o.deleteDish=function(n){o.processing=!0,e["delete"](n).success(function(n){e.all().success(function(e){o.processing=!1,o.dishes=e})})},o.addDish=function(){o.processing=!0,e.create({name:"new dish"}).success(function(e){t.path("/admin/dish/"+e.dish._id)})},o.fbShare=function(e){var o=t.absUrl()+"/"+e._id;n.fbShare(o)}}]).controller("DishDetailController",["$scope","$location","$rootScope","$routeParams","$mdDialog","DishService","UserService",function(e,n,t,o,i,s,r){function c(){e.focusOnComment=!1,a.newComment={content:"",replyTo:null},a.commentTitle="Comment"}var a=this;a.dish={},c(),s.get(o.dish_id).success(function(e){a.dish=e,a.dish.isCollected=t.user&&t.user.favouriteDishes.indexOf(a.dish._id)>=0?!0:!1}),a.addComment=function(){if(!t.user){var e=n.url();return n.path("/login").search({returnUrl:e})}s.addComment(a.dish._id,a.newComment).success(function(e){a.dish.comments.push(e)}),c()},a.reply=function(n){a.newComment.replyTo=n._id,a.commentTitle="@"+n.userName,e.focusOnComment=!0},a.collect=function(){if(!t.user){var e=n.url();return n.path("/login").search({returnUrl:e})}r.collect(a.dish._id).then(function(e){console.log("UserService.collect:",e),e.success&&(a.dish.isCollected=!0)})},a.showInstructionPhoto=function(e,n){null!=e&&""!=e.trim()&&i.show({targetEvent:n,clickOutsideToClose:!0,template:'<md-dialog>  <md-dialog-content><img src="{{photo}}"></md-dialog-content></md-dialog>',controller:["$scope",function(n){n.photo=e}]})}}]).controller("DishCreateController",["$location","DishService",function(e,n){var t=this;t.dish={name:"new dish"},t.save=function(){t.processing=!0,n.create(t.dish).success(function(n){e.path("/admin/dish/"+n.dish._id)})}}]).controller("DishEditController",["$routeParams","DishService","$location",function(e,n,t){function o(){i.newPhoto="",i.newInstruction="",i.message="",i.processing=!1}var i=this;o(),n.get(e.dish_id).success(function(e){i.dish=e}),i.addInstruction=function(){i.dish.instructions.push(i.newInstruction),i.newInstruction=""},i.removeInstruction=function(e){i.dish.instructions.splice(e,1)},i.addPhoto=function(){console.log("newPhoto: ",i.newPhoto),i.dish.photos.push(i.newPhoto),console.log("dish:",i.dish),i.newPhoto=""},i.removePhoto=function(e){i.dish.photos.splice(e,1)},i.save=function(){i.processing=!0,n.update(e.dish_id,i.dish).success(function(e){o(),i.message=e.message})}}]),angular.module("spicyTaste").controller("HomeController",["DishService","CONSTANTS",function(e,n){function t(){i.recipeTiles=[],o()}function o(){e.limit(n.LATEST_COUNT).success(function(e){angular.forEach(e,function(e,n){var t={image:e.imageUrl,title:e.name,id:e._id,prepTime:e.prepTime,totalTime:e.totalTime,difficulty:e.difficulty,tags:e.tags,span:{row:1,col:1}};switch(n+1){case 1:t.span.row=t.span.col=2;break;case 2:case 3:break;case 4:t.span.col=2;case 5:case 6:break;case 7:t.span.row=t.span.col=2;case 8:case 9:break;case 10:t.span.col=2}i.recipeTiles.push(t)})})}var i=this;t()}]),angular.module("spicyTaste").controller("MainController",["$rootScope","$location","$mdDialog","$http","SessionService","UserService","CONSTANTS",function(e,n,t,o,i,s,r){function c(e){var n=o.defaults.headers.common["X-Auth"];i.setLocal(r.LOCAL_STORAGE_KEY,n),t.hide(e)}function a(){l.showMobileMenu=!1,l.email="",l.password="",l.userName="";var n=i.getLocal(r.LOCAL_STORAGE_KEY);n&&(o.defaults.headers.common["X-Auth"]=n,s.get().then(function(n){e.currentUser=n}))}var l=this;a(),l.toggleMobileMenu=function(){l.showMobileMenu=!l.showMobileMenu},l.showLoginDialog=function(n){t.show({clickOutsideToClose:!0,templateUrl:"ng/views/dialogs/login.html",targetEvent:n,controller:"MainController",controllerAs:"main"}).then(function(n){e.currentUser=n})},l.fbLogin=function(){FB.login(function(e){"connected"===e.status?FB.api("/me",function(e){var n={userName:e.name,email:e.email,password:r.SOCIAL_PASS,photoUrl:"http://graph.facebook.com/"+e.id+"/picture?type=large",linkedSocial:r.FACEBOOK};s.socialLogin(n).then(function(e){e.loginType=r.FACEBOOK,c(e)})}):"not_authorized"===e.status},{scope:"public_profile,email"})},l.login=function(){s.login(l.email,l.password).then(function(e){e.loginType=r.EMAIL,c(e)})},l.signUp=function(){var e={userName:l.userName,email:l.email,password:l.password,photoUrl:"http://www.gravatar.com/avatar/"+md5.createHash(l.email),linkedSocial:r.EMAIL};s.create(e).then(function(e){e.loginType=r.EMAIL,c(e)})}}]),angular.module("spicyTaste").controller("ProfileController",["$location","$rootScope","UserService",function(e,n,t){function o(){i.user={},t.get().then(function(e){i.user=e})}var i=this;o(),i.logout=function(){t.logout(),n.currentUser=null,e.path("/")}}]),angular.module("spicyTaste").factory("DishService",["$http",function(e){var n={};return n.all=function(){return e.get("/api/dishes")},n.limit=function(n){return e.get("/api/dishes?limit="+n)},n.create=function(n){return e.post("/api/dishes",n)},n.get=function(n){return e.get("/api/dishes/"+n)},n.update=function(n,t){return e.put("/api/dishes/"+n,t)},n["delete"]=function(n){return e["delete"]("/api/dishes/"+n)},n.addComment=function(n,t){return e.post("/api/dishes/"+n+"/comments",t)},n.getDifficulties=function(){return["初学","容易","一般","较难","专业"]},n}]),angular.module("spicyTaste").factory("SessionService",["$window",function(e){var n={};return n.getLocal=function(n){if(e.localStorage){var t=e.localStorage.getItem(n);return angular.fromJson(t)}return!1},n.setLocal=function(n,t){return e.localStorage&&e.localStorage.setItem(n,angular.toJson(t))},n}]),angular.module("spicyTaste").factory("SocialService",function(){var e={};return e.fbShare=function(e){FB.ui({method:"share",href:e},function(e){})},e}),angular.module("spicyTaste").factory("UserService",["$http","$rootScope","$window","CONSTANTS",function(e,n,t,o){var i={};return i.socialLogin=function(e){return console.log("socialUser: ",e),i.searchBy("email="+e.email).then(function(n){if(n.success){var t=n.users[0];return t.linkedSocial.indexOf(e.linkedSocial)<0?(t.linkedSocial.push(e.linkedSocial),t.userName=e.userName,t.photoUrl=e.photoUrl,i.update(t).then(function(){return i.login(t.email,o.SOCIAL_PASS)})):i.login(t.email,o.SOCIAL_PASS)}return i.create(e)})},i.login=function(n,t){return e.post("/api/auth",{email:n,password:t}).then(function(n){return e.defaults.headers.common["X-Auth"]=n.data,i.get()})},i.logout=function(){delete e.defaults.headers.common["X-Auth"],t.localStorage.removeItem(o.LOCAL_STORAGE_KEY)},i.get=function(){return e.get("/api/users/me").then(function(e){return e.data})},i.searchBy=function(n){return e.get("/api/users?"+n).then(function(e){return e.data})},i.getById=function(n){return e.get("/api/users/"+n).then(function(e){return e.data})},i.create=function(n){return e.post("/api/users/",n).then(function(){return i.login(n.email,n.password)})},i.update=function(n,t){return e.put("/api/users/"+n,t).then(function(e){return e.data})},i.collect=function(t){return e.put("/api/users/"+n.user._id+"/dishes/"+t).then(function(e){return e.data})},i}]),angular.module("spicyTaste").directive("contenteditable",function(){return{require:"ngModel",restrict:"A",link:function(e,n,t,o){o.$render=function(){n.html(o.$viewValue||"")},n.bind("blur",function(){e.$apply(function(){o.$setViewValue(n.html())})})}}}),angular.module("spicyTaste").directive("focusOn",function(){return{restrict:"A",scope:{focusValue:"=focusOn"},link:function(e,n){e.$watch("focusValue",function(e,t){e&&!t&&n[0].focus()})}}});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsImRlc2lnbi5qcyIsImZhY2Vib29rLmpzIiwicm91dGVzLmpzIiwiY29udHJvbGxlcnMvZGlzaENvbnRyb2xsZXIuanMiLCJjb250cm9sbGVycy9ob21lQ29udHJvbGxlci5qcyIsImNvbnRyb2xsZXJzL21haW5Db250cm9sbGVyLmpzIiwiY29udHJvbGxlcnMvcHJvZmlsZUNvbnRyb2xsZXIuanMiLCJzZXJ2aWNlcy9kaXNoU2VydmljZS5qcyIsInNlcnZpY2VzL3Nlc3Npb25TZXJ2aWNlLmpzIiwic2VydmljZXMvc29jaWFsU2VydmljZS5qcyIsInNlcnZpY2VzL3VzZXJTZXJ2aWNlLmpzIiwiZGlyZWN0aXZlcy9jb250ZW50ZWRpdGFibGVEaXJlY3RpdmUuanMiLCJkaXJlY3RpdmVzL2ZvY3VzT25EaXJlY3RpdmUuanMiXSwibmFtZXMiOlsiYW5ndWxhciIsIm1vZHVsZSIsImNvbnN0YW50IiwiRkJfQVBQX0lEIiwiRkFDRUJPT0siLCJFTUFJTCIsIlNPQ0lBTF9QQVNTIiwiTE9DQUxfU1RPUkFHRV9LRVkiLCJMQVRFU1RfQ09VTlQiLCJjb25maWciLCIkbWRUaGVtaW5nUHJvdmlkZXIiLCIkbWRJY29uUHJvdmlkZXIiLCJwcmltYXJ5T3JhbmdlIiwiZXh0ZW5kUGFsZXR0ZSIsIjUwMCIsInByaW1hcnlCbHVlIiwiNjAwIiwiZGVmaW5lUGFsZXR0ZSIsInRoZW1lIiwicHJpbWFyeVBhbGV0dGUiLCJhY2NlbnRQYWxldHRlIiwiaWNvbiIsInJ1biIsIiRyb290U2NvcGUiLCIkd2luZG93IiwiVXNlclNlcnZpY2UiLCJDT05TVEFOVFMiLCJ1c2VyIiwiZmJBc3luY0luaXQiLCJGQiIsImluaXQiLCJhcHBJZCIsImNvb2tpZSIsInhmYm1sIiwidmVyc2lvbiIsImQiLCJzIiwiaWQiLCJqcyIsImZqcyIsImdldEVsZW1lbnRzQnlUYWdOYW1lIiwiZ2V0RWxlbWVudEJ5SWQiLCJjcmVhdGVFbGVtZW50Iiwic3JjIiwicGFyZW50Tm9kZSIsImluc2VydEJlZm9yZSIsImRvY3VtZW50IiwiJGxvY2F0aW9uUHJvdmlkZXIiLCIkcm91dGVQcm92aWRlciIsImh0bWw1TW9kZSIsIndoZW4iLCJ0ZW1wbGF0ZVVybCIsImNvbnRyb2xsZXIiLCJjb250cm9sbGVyQXMiLCJEaXNoU2VydmljZSIsIlNvY2lhbFNlcnZpY2UiLCIkbG9jYXRpb24iLCJ2bSIsInRoaXMiLCJwcm9jZXNzaW5nIiwiYWxsIiwic3VjY2VzcyIsImRhdGEiLCJkaXNoZXMiLCJkZWxldGVEaXNoIiwiYWRkRGlzaCIsImNyZWF0ZSIsIm5hbWUiLCJwYXRoIiwiZGlzaCIsIl9pZCIsImZiU2hhcmUiLCJkaXNoTGluayIsImFic1VybCIsIiRzY29wZSIsIiRyb3V0ZVBhcmFtcyIsIiRtZERpYWxvZyIsImZvY3VzT25Db21tZW50IiwibmV3Q29tbWVudCIsImNvbnRlbnQiLCJyZXBseVRvIiwiY29tbWVudFRpdGxlIiwiZ2V0IiwiZGlzaF9pZCIsImlzQ29sbGVjdGVkIiwiZmF2b3VyaXRlRGlzaGVzIiwiaW5kZXhPZiIsImFkZENvbW1lbnQiLCJyZXR1cm5VcmwiLCJ1cmwiLCJzZWFyY2giLCJjb21tZW50IiwiY29tbWVudHMiLCJwdXNoIiwicmVwbHkiLCJ1c2VyTmFtZSIsImNvbGxlY3QiLCJ0aGVuIiwiY29uc29sZSIsImxvZyIsInNob3dJbnN0cnVjdGlvblBob3RvIiwicGhvdG9VcmwiLCIkZXZlbnQiLCJ0cmltIiwic2hvdyIsInRhcmdldEV2ZW50IiwiY2xpY2tPdXRzaWRlVG9DbG9zZSIsInRlbXBsYXRlIiwicGhvdG8iLCJzYXZlIiwibmV3UGhvdG8iLCJuZXdJbnN0cnVjdGlvbiIsIm1lc3NhZ2UiLCJhZGRJbnN0cnVjdGlvbiIsImluc3RydWN0aW9ucyIsInJlbW92ZUluc3RydWN0aW9uIiwiaW5kZXgiLCJzcGxpY2UiLCJhZGRQaG90byIsInBob3RvcyIsInJlbW92ZVBob3RvIiwidXBkYXRlIiwicmVjaXBlVGlsZXMiLCJidWlsZEdyaWQiLCJsaW1pdCIsImZvckVhY2giLCJ0aWxlIiwiaW1hZ2UiLCJpbWFnZVVybCIsInRpdGxlIiwicHJlcFRpbWUiLCJ0b3RhbFRpbWUiLCJkaWZmaWN1bHR5IiwidGFncyIsInNwYW4iLCJyb3ciLCJjb2wiLCIkaHR0cCIsIlNlc3Npb25TZXJ2aWNlIiwiYWZ0ZXJBdXRoIiwidG9rZW4iLCJkZWZhdWx0cyIsImhlYWRlcnMiLCJjb21tb24iLCJzZXRMb2NhbCIsImhpZGUiLCJzaG93TW9iaWxlTWVudSIsImVtYWlsIiwicGFzc3dvcmQiLCJsb2dpbmVkVG9rZW4iLCJnZXRMb2NhbCIsImN1cnJlbnRVc2VyIiwidG9nZ2xlTW9iaWxlTWVudSIsInNob3dMb2dpbkRpYWxvZyIsImV2IiwiZmJMb2dpbiIsImxvZ2luIiwicmVzcG9uc2UiLCJzdGF0dXMiLCJhcGkiLCJmYlVzZXIiLCJsaW5rZWRTb2NpYWwiLCJzb2NpYWxMb2dpbiIsImxvZ2luVHlwZSIsInNjb3BlIiwic2lnblVwIiwibmV3VXNlciIsIm1kNSIsImNyZWF0ZUhhc2giLCJsb2dvdXQiLCJmYWN0b3J5IiwiZGlzaEZhY3RvcnkiLCJudW0iLCJwb3N0IiwicHV0IiwiZ2V0RGlmZmljdWx0aWVzIiwic2Vzc2lvbkZhY3RvcnkiLCJrZXkiLCJsb2NhbFN0b3JhZ2UiLCJnZXRJdGVtIiwiZnJvbUpzb24iLCJzZXRJdGVtIiwidG9Kc29uIiwic29jaWFsRmFjdG9yeSIsImxpbmsiLCJ1aSIsIm1ldGhvZCIsImhyZWYiLCJ1c2VyRmFjdG9yeSIsInNvY2lhbFVzZXIiLCJzZWFyY2hCeSIsInVzZXJzIiwicmVtb3ZlSXRlbSIsInF1ZXJ5IiwiZ2V0QnlJZCIsInVzZXJfaWQiLCJkaXJlY3RpdmUiLCJyZXF1aXJlIiwicmVzdHJpY3QiLCJlbGVtZW50IiwiYXR0cmlidXRzIiwibmdNb2RlbCIsIiRyZW5kZXIiLCJodG1sIiwiJHZpZXdWYWx1ZSIsImJpbmQiLCIkYXBwbHkiLCIkc2V0Vmlld1ZhbHVlIiwiZm9jdXNWYWx1ZSIsIiRlbGVtZW50IiwiJHdhdGNoIiwiY3VycmVudFZh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dWxhci5tb2R1bGUoJ3NwaWN5VGFzdGUnLCBbJ25nUm91dGUnLCAnYW5ndWxhci1tZDUnLCAnbmdNYXRlcmlhbCcsICduZ0FuaW1hdGUnLCAnbmdNZXNzYWdlcyddKVxuICAgIC5jb25zdGFudCgnQ09OU1RBTlRTJywge1xuICAgICAgICBcIkZCX0FQUF9JRFwiOiAxNTYzNTY3Mzg3MjUzNDY4LFxuICAgICAgICBcIkZBQ0VCT09LXCI6IFwiRkJcIixcbiAgICAgICAgXCJFTUFJTFwiOiBcIkVNQUlMXCIsXG4gICAgICAgIFwiU09DSUFMX1BBU1NcIjogXCJQQVNTV09SRFwiLFxuICAgICAgICBcIkxPQ0FMX1NUT1JBR0VfS0VZXCI6IFwic3BpY3lUYXN0ZVVzZXJcIixcbiAgICAgICAgXCJMQVRFU1RfQ09VTlRcIjogMTBcbiAgICB9KTtcbiIsImFuZ3VsYXIubW9kdWxlKCdzcGljeVRhc3RlJylcbiAgICAuY29uZmlnKGZ1bmN0aW9uKCRtZFRoZW1pbmdQcm92aWRlciwgJG1kSWNvblByb3ZpZGVyKSB7XG5cbiAgICAgICAgdmFyIHByaW1hcnlPcmFuZ2UgPSAkbWRUaGVtaW5nUHJvdmlkZXIuZXh0ZW5kUGFsZXR0ZSgnZGVlcC1vcmFuZ2UnLCB7XG4gICAgICAgICAgICAnNTAwJzogJ2YyNzI0MidcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdmFyIHByaW1hcnlCbHVlID0gJG1kVGhlbWluZ1Byb3ZpZGVyLmV4dGVuZFBhbGV0dGUoJ2JsdWUnLCB7XG4gICAgICAgICAgICAnNTAwJzogJzY5ODRiNCcsXG4gICAgICAgICAgICAnNjAwJzogJzY5ODRiNCdcbiAgICAgICAgfSk7XG5cbiAgICAgICAgJG1kVGhlbWluZ1Byb3ZpZGVyLmRlZmluZVBhbGV0dGUoJ3ByaW1hcnlPcmFuZ2UnLCBwcmltYXJ5T3JhbmdlKTtcbiAgICAgICAgJG1kVGhlbWluZ1Byb3ZpZGVyLmRlZmluZVBhbGV0dGUoJ3ByaW1hcnlCbHVlJywgcHJpbWFyeUJsdWUpO1xuXG4gICAgICAgICRtZFRoZW1pbmdQcm92aWRlci50aGVtZSgnZGVmYXVsdCcpXG4gICAgICAgICAgICAucHJpbWFyeVBhbGV0dGUoJ3ByaW1hcnlPcmFuZ2UnKVxuICAgICAgICAgICAgLmFjY2VudFBhbGV0dGUoJ2xpZ2h0LWdyZWVuJyk7XG5cbiAgICAgICAgJG1kVGhlbWluZ1Byb3ZpZGVyLnRoZW1lKCdibHVlJylcbiAgICAgICAgICAgIC5wcmltYXJ5UGFsZXR0ZSgncHJpbWFyeUJsdWUnKTtcblxuICAgICAgICAkbWRJY29uUHJvdmlkZXIuaWNvbignbWVudScsICdzdmcvaWNfbWVudV8yNHB4LnN2ZycpXG4gICAgICAgICAgICAuaWNvbignc2hhcmUnLCAnc3ZnL2ljX3NoYXJlXzI0cHguc3ZnJylcbiAgICAgICAgICAgIC5pY29uKCdsb2dpbicsICdzdmcvaWNfYWNjb3VudF9jaXJjbGVfMjRweC5zdmcnKVxuICAgICAgICAgICAgLmljb24oJ3JlY2lwZXMnLCAnc3ZnL2ljX2V2ZW50X25vdGVfNDhweC5zdmcnKVxuICAgICAgICAgICAgLmljb24oJ3Jlc3RhdXJhbnRzJywgJ3N2Zy9pY19yZXN0YXVyYW50X21lbnVfNDhweC5zdmcnKVxuICAgICAgICAgICAgLmljb24oJ2luZ3JlZGllbnRzJywgJ3N2Zy9pY19yZWNlaXB0XzQ4cHguc3ZnJylcbiAgICAgICAgICAgIC5pY29uKCdhcnJvdycsICdzdmcvaWNfYXJyb3dfZHJvcF91cF80OHB4LnN2ZycpXG4gICAgICAgICAgICAuaWNvbignbW9yZScsICdzdmcvaWNfbW9yZV8yNHB4LnN2ZycpXG4gICAgICAgICAgICAuaWNvbigndGltZTEnLCAnc3ZnL2ljX2F2X3RpbWVyXzI0cHguc3ZnJylcbiAgICAgICAgICAgIC5pY29uKCd0aW1lMicsICdzdmcvaWNfYWNjZXNzX3RpbWVfMjRweC5zdmcnKVxuICAgICAgICAgICAgLmljb24oJ2RpZmZpY3VsdHknLCAnc3ZnL2ljX3RyYWNrX2NoYW5nZXNfMjRweC5zdmcnKVxuICAgICAgICAgICAgLmljb24oJ2V4aXQnLCAnc3ZnL2ljX2V4aXRfdG9fYXBwXzQ4cHguc3ZnJylcbiAgICAgICAgICAgIC5pY29uKCdwaG90bycsICdzdmcvaWNfbW1zXzI0cHguc3ZnJylcbiAgICAgICAgICAgIC5pY29uKCdjaGVjaycsICdzdmcvaWNfY2hlY2tfY2lyY2xlXzI0cHguc3ZnJyk7XG4gICAgfSk7XG4iLCJhbmd1bGFyLm1vZHVsZSgnc3BpY3lUYXN0ZScpXG4gICAgLnJ1bihmdW5jdGlvbigkcm9vdFNjb3BlLCAkd2luZG93LCBVc2VyU2VydmljZSwgQ09OU1RBTlRTKSB7XG4gICAgICAgICRyb290U2NvcGUudXNlciA9IG51bGw7XG5cbiAgICAgICAgJHdpbmRvdy5mYkFzeW5jSW5pdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgRkIuaW5pdCh7XG4gICAgICAgICAgICAgICAgYXBwSWQ6IENPTlNUQU5UUy5GQl9BUFBfSUQsXG4gICAgICAgICAgICAgICAgY29va2llOiB0cnVlLCAvLyBlbmFibGUgY29va2llcyB0byBhbGxvdyB0aGUgc2VydmVyIHRvIGFjY2VzcyB0aGUgc2Vzc2lvblxuICAgICAgICAgICAgICAgIHhmYm1sOiB0cnVlLCAvLyBwYXJzZSBzb2NpYWwgcGx1Z2lucyBvbiB0aGlzIHBhZ2VcbiAgICAgICAgICAgICAgICB2ZXJzaW9uOiAndjIuMicgLy8gdXNlIHZlcnNpb24gMi4yXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBMb2FkIHRoZSBTREsgYXN5bmNocm9ub3VzbHlcbiAgICAgICAgKGZ1bmN0aW9uKGQsIHMsIGlkKSB7XG4gICAgICAgICAgICB2YXIganMsIGZqcyA9IGQuZ2V0RWxlbWVudHNCeVRhZ05hbWUocylbMF07XG4gICAgICAgICAgICBpZiAoZC5nZXRFbGVtZW50QnlJZChpZCkpIHJldHVybjtcbiAgICAgICAgICAgIGpzID0gZC5jcmVhdGVFbGVtZW50KHMpO1xuICAgICAgICAgICAganMuaWQgPSBpZDtcbiAgICAgICAgICAgIGpzLnNyYyA9IFwiLy9jb25uZWN0LmZhY2Vib29rLm5ldC9lbl9VUy9zZGsuanNcIjtcbiAgICAgICAgICAgIGZqcy5wYXJlbnROb2RlLmluc2VydEJlZm9yZShqcywgZmpzKTtcbiAgICAgICAgfShkb2N1bWVudCwgJ3NjcmlwdCcsICdmYWNlYm9vay1qc3NkaycpKTtcbiAgICB9KTtcbiIsImFuZ3VsYXIubW9kdWxlKCdzcGljeVRhc3RlJylcbiAgICAuY29uZmlnKGZ1bmN0aW9uKCRsb2NhdGlvblByb3ZpZGVyLCAkcm91dGVQcm92aWRlcikge1xuICAgICAgICAkbG9jYXRpb25Qcm92aWRlci5odG1sNU1vZGUodHJ1ZSk7XG5cbiAgICAgICAgJHJvdXRlUHJvdmlkZXJcbiAgICAgICAgLy9ob21lIHBhZ2VcbiAgICAgICAgICAgIC53aGVuKCcvJywge1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbmcvdmlld3MvcGFnZXMvaG9tZS5odG1sJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnSG9tZUNvbnRyb2xsZXInLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ2hvbWUnXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLy9zaG93IGFsbCBkaXNoZXMgcGFnZVxuICAgICAgICAgICAgLndoZW4oJy9kaXNoZXMnLCB7XG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICduZy92aWV3cy9wYWdlcy9kaXNoL2FsbC5odG1sJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnRGlzaExpc3RDb250cm9sbGVyJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6ICdkaXNoTGlzdCdcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAvL3Nob3cgZGlzaCBkZXRhaWwgcGFnZVxuICAgICAgICAgICAgLndoZW4oJy9kaXNoZXMvOmRpc2hfaWQnLCB7XG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICduZy92aWV3cy9wYWdlcy9kaXNoL2RldGFpbC5odG1sJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnRGlzaERldGFpbENvbnRyb2xsZXInLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ2RldGFpbCdcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAvL2xpc3QgYWRtaW4gZGlzaCBwYWdlXG4gICAgICAgICAgICAud2hlbignL2FkbWluL2Rpc2hlcy9saXN0Jywge1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbmcvdmlld3MvcGFnZXMvYWRtaW4vZGlzaC9saXN0Lmh0bWwnLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdEaXNoTGlzdENvbnRyb2xsZXInLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ2Rpc2hMaXN0J1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC8vY3JlYXRlIGEgbmV3IGRpc2ggcGFnZVxuICAgICAgICAgICAgLndoZW4oJy9hZG1pbi9kaXNoZXMvY3JlYXRlJywge1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbmcvdmlld3MvcGFnZXMvYWRtaW4vZGlzaC9zaW5nbGUuaHRtbCcsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ0Rpc2hDcmVhdGVDb250cm9sbGVyJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6ICdkaXNoTWFuYWdlJ1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC8vZWRpdCBhIGRpc2ggcGFnZVxuICAgICAgICAgICAgLndoZW4oJy9hZG1pbi9kaXNoZXMvOmRpc2hfaWQnLCB7XG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICduZy92aWV3cy9wYWdlcy9hZG1pbi9kaXNoL3NpbmdsZS5odG1sJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnRGlzaEVkaXRDb250cm9sbGVyJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6ICdkaXNoTWFuYWdlJ1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC8vbG9naW4gdXNlclxuICAgICAgICAgICAgLndoZW4oJy9sb2dpbicsIHtcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25nL3ZpZXdzL3BhZ2VzL3VzZXIvbG9naW4uaHRtbCcsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ0xvZ2luQ29udHJvbGxlcicsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiAnbG9naW4nXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLy91c2VyIHByb2ZpbGVcbiAgICAgICAgICAgIC53aGVuKCcvbWUnLCB7XG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICduZy92aWV3cy9wYWdlcy91c2VyL21lLmh0bWwnLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdQcm9maWxlQ29udHJvbGxlcicsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiAnbWUnXG4gICAgICAgICAgICB9KVxuICAgIH0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ3NwaWN5VGFzdGUnKVxuICAgIC8vY29udHJvbGxlciBhcHBsaWVkIHRvIGRpc2ggbGlzdCBwYWdlXG4gICAgLmNvbnRyb2xsZXIoJ0Rpc2hMaXN0Q29udHJvbGxlcicsIGZ1bmN0aW9uKERpc2hTZXJ2aWNlLCBTb2NpYWxTZXJ2aWNlLCAkbG9jYXRpb24pIHtcbiAgICAgICAgdmFyIHZtID0gdGhpcztcblxuICAgICAgICAvL3NldCBhIHByb2Nlc3NpbmcgdmFyaWFibGUgdG8gc2hvdyBsb2FkaW5nXG4gICAgICAgIHZtLnByb2Nlc3NpbmcgPSB0cnVlO1xuXG4gICAgICAgIC8vZ3JhYiBhbGwgdGhlIGRpc2hlcyBhdCBwYWdlIGxvYWRcbiAgICAgICAgRGlzaFNlcnZpY2UuYWxsKCkuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAvL3doZW4gYWxsIGRpc2hlcyBmZXRjaGVkLCByZW1vdmUgcHJvY2Vzc2luZyB2YXJpYWJsZVxuICAgICAgICAgICAgdm0ucHJvY2Vzc2luZyA9IGZhbHNlO1xuXG4gICAgICAgICAgICAvL2JpbmQgdGhlIGRpc2hlc1xuICAgICAgICAgICAgdm0uZGlzaGVzID0gZGF0YTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy9mdW5jdGlvbiB0byBkZWxldGUgYSBkaXNoXG4gICAgICAgIHZtLmRlbGV0ZURpc2ggPSBmdW5jdGlvbihpZCkge1xuICAgICAgICAgICAgdm0ucHJvY2Vzc2luZyA9IHRydWU7XG5cbiAgICAgICAgICAgIERpc2hTZXJ2aWNlLmRlbGV0ZShpZCkuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgRGlzaFNlcnZpY2UuYWxsKCkuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIHZtLnByb2Nlc3NpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgdm0uZGlzaGVzID0gZGF0YTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIHZtLmFkZERpc2ggPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZtLnByb2Nlc3NpbmcgPSB0cnVlO1xuXG4gICAgICAgICAgICBEaXNoU2VydmljZS5jcmVhdGUoe1xuICAgICAgICAgICAgICAgIG5hbWU6ICduZXcgZGlzaCdcbiAgICAgICAgICAgIH0pLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKCcvYWRtaW4vZGlzaC8nICsgZGF0YS5kaXNoLl9pZCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZtLmZiU2hhcmUgPSBmdW5jdGlvbihkaXNoKSB7XG4gICAgICAgICAgICB2YXIgZGlzaExpbmsgPSAkbG9jYXRpb24uYWJzVXJsKCkgKyAnLycgKyBkaXNoLl9pZDtcbiAgICAgICAgICAgIFNvY2lhbFNlcnZpY2UuZmJTaGFyZShkaXNoTGluayk7XG4gICAgICAgIH1cblxuICAgIH0pXG4gICAgLy9jb250cm9sbGVyIGFwcGxpZWQgdG8gZGlzaCBkZXRhaWwgcGFnZVxuICAgIC5jb250cm9sbGVyKCdEaXNoRGV0YWlsQ29udHJvbGxlcicsIGZ1bmN0aW9uKCRzY29wZSwgJGxvY2F0aW9uLCAkcm9vdFNjb3BlLCAkcm91dGVQYXJhbXMsICRtZERpYWxvZywgRGlzaFNlcnZpY2UsIFVzZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG4gICAgICAgIHZtLmRpc2ggPSB7fTtcbiAgICAgICAgaW5pdCgpO1xuXG4gICAgICAgIC8vZ2V0IHRoZSBkaXNoIGJ5IGlkXG4gICAgICAgIERpc2hTZXJ2aWNlLmdldCgkcm91dGVQYXJhbXMuZGlzaF9pZCkuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICB2bS5kaXNoID0gZGF0YTtcbiAgICAgICAgICAgIGlmICgkcm9vdFNjb3BlLnVzZXIgJiYgJHJvb3RTY29wZS51c2VyLmZhdm91cml0ZURpc2hlcy5pbmRleE9mKHZtLmRpc2guX2lkKSA+PSAwKSB7XG4gICAgICAgICAgICAgICAgdm0uZGlzaC5pc0NvbGxlY3RlZCA9IHRydWU7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHZtLmRpc2guaXNDb2xsZWN0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9KTtcblxuICAgICAgICB2bS5hZGRDb21tZW50ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBpZiAoISRyb290U2NvcGUudXNlcikge1xuICAgICAgICAgICAgICAgIHZhciByZXR1cm5VcmwgPSAkbG9jYXRpb24udXJsKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuICRsb2NhdGlvbi5wYXRoKCcvbG9naW4nKS5zZWFyY2goe1xuICAgICAgICAgICAgICAgICAgICByZXR1cm5Vcmw6IHJldHVyblVybFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBEaXNoU2VydmljZS5hZGRDb21tZW50KHZtLmRpc2guX2lkLCB2bS5uZXdDb21tZW50KS5zdWNjZXNzKGZ1bmN0aW9uKGNvbW1lbnQpIHtcbiAgICAgICAgICAgICAgICB2bS5kaXNoLmNvbW1lbnRzLnB1c2goY29tbWVudCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgaW5pdCgpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHZtLnJlcGx5ID0gZnVuY3Rpb24odXNlcikge1xuICAgICAgICAgICAgdm0ubmV3Q29tbWVudC5yZXBseVRvID0gdXNlci5faWQ7XG4gICAgICAgICAgICB2bS5jb21tZW50VGl0bGUgPSAnQCcgKyB1c2VyLnVzZXJOYW1lO1xuICAgICAgICAgICAgJHNjb3BlLmZvY3VzT25Db21tZW50ID0gdHJ1ZTtcbiAgICAgICAgfTtcblxuICAgICAgICB2bS5jb2xsZWN0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBpZiAoISRyb290U2NvcGUudXNlcikge1xuICAgICAgICAgICAgICAgIHZhciByZXR1cm5VcmwgPSAkbG9jYXRpb24udXJsKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuICRsb2NhdGlvbi5wYXRoKCcvbG9naW4nKS5zZWFyY2goe1xuICAgICAgICAgICAgICAgICAgICByZXR1cm5Vcmw6IHJldHVyblVybFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBVc2VyU2VydmljZS5jb2xsZWN0KHZtLmRpc2guX2lkKS50aGVuKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlVzZXJTZXJ2aWNlLmNvbGxlY3Q6XCIsIGRhdGEpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGRhdGEuc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICB2bS5kaXNoLmlzQ29sbGVjdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZtLnNob3dJbnN0cnVjdGlvblBob3RvID0gZnVuY3Rpb24ocGhvdG9VcmwsICRldmVudCkge1xuICAgICAgICAgICAgaWYgKHBob3RvVXJsID09IG51bGwgfHwgcGhvdG9VcmwudHJpbSgpID09ICcnKVxuICAgICAgICAgICAgICAgIHJldHVybjtcblxuICAgICAgICAgICAgJG1kRGlhbG9nLnNob3coe1xuICAgICAgICAgICAgICAgIHRhcmdldEV2ZW50OiAkZXZlbnQsXG4gICAgICAgICAgICAgICAgY2xpY2tPdXRzaWRlVG9DbG9zZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZTogJzxtZC1kaWFsb2c+JyArXG4gICAgICAgICAgICAgICAgICAgICcgIDxtZC1kaWFsb2ctY29udGVudD48aW1nIHNyYz1cInt7cGhvdG99fVwiPjwvbWQtZGlhbG9nLWNvbnRlbnQ+JyArXG4gICAgICAgICAgICAgICAgICAgICc8L21kLWRpYWxvZz4nLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6IGZ1bmN0aW9uIERpYWxvZ0N0cigkc2NvcGUpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnBob3RvID0gcGhvdG9Vcmw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBpbml0KCkge1xuICAgICAgICAgICAgJHNjb3BlLmZvY3VzT25Db21tZW50ID0gZmFsc2U7XG4gICAgICAgICAgICB2bS5uZXdDb21tZW50ID0ge1xuICAgICAgICAgICAgICAgIGNvbnRlbnQ6ICcnLFxuICAgICAgICAgICAgICAgIHJlcGx5VG86IG51bGwsXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdm0uY29tbWVudFRpdGxlID0gJ0NvbW1lbnQnO1xuICAgICAgICB9XG4gICAgfSlcbiAgICAvL2NvbnRyb2xsZXIgYXBwbGllZCB0byBkaXNoIGNyZWF0aW9uIHBhZ2VcbiAgICAvL25vdCB1c2UgYW55bW9yZVxuICAgIC5jb250cm9sbGVyKCdEaXNoQ3JlYXRlQ29udHJvbGxlcicsIGZ1bmN0aW9uKCRsb2NhdGlvbiwgRGlzaFNlcnZpY2UpIHtcbiAgICAgICAgdmFyIHZtID0gdGhpcztcblxuICAgICAgICB2bS5kaXNoID0ge1xuICAgICAgICAgICAgbmFtZTogJ25ldyBkaXNoJ1xuICAgICAgICB9O1xuXG4gICAgICAgIHZtLnNhdmUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZtLnByb2Nlc3NpbmcgPSB0cnVlO1xuXG4gICAgICAgICAgICBEaXNoU2VydmljZS5jcmVhdGUodm0uZGlzaCkuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy9hZG1pbi9kaXNoLycgKyBkYXRhLmRpc2guX2lkKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG5cblxuICAgICAgICBmdW5jdGlvbiBpbml0KCkge1xuICAgICAgICAgICAgdm0udHlwZSA9ICdjcmVhdGUnO1xuICAgICAgICAgICAgdm0uZGlzaCA9IHtcbiAgICAgICAgICAgICAgICBpbnN0cnVjdGlvbnM6IFtdLFxuICAgICAgICAgICAgICAgIHBob3RvOiBbXVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHZtLm5ld0luc3RydWN0aW9uID0gJyc7XG4gICAgICAgICAgICB2bS5uZXdQaG90byA9ICcnO1xuICAgICAgICAgICAgdm0ubWVzc2FnZSA9ICcnO1xuICAgICAgICAgICAgdm0ucHJvY2Vzc2luZyA9IGZhbHNlO1xuICAgICAgICAgICAgdm0uZGlzaC5pbnN0cnVjdGlvbnMubGVuZ3RoID0gMDtcbiAgICAgICAgICAgIHZtLmRpc2gucGhvdG9zLmxlbmd0aCA9IDA7XG4gICAgICAgIH1cbiAgICB9KVxuICAgIC8vY29udHJvbGxlciBhcHBsaWVkIHRvIGRpc2ggZWRpdCBwYWdlXG4gICAgLmNvbnRyb2xsZXIoJ0Rpc2hFZGl0Q29udHJvbGxlcicsIGZ1bmN0aW9uKCRyb3V0ZVBhcmFtcywgRGlzaFNlcnZpY2UsICRsb2NhdGlvbikge1xuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuICAgICAgICBpbml0KCk7XG5cbiAgICAgICAgLy9nZXQgdGhlIGRpc2ggYnkgaWRcbiAgICAgICAgRGlzaFNlcnZpY2UuZ2V0KCRyb3V0ZVBhcmFtcy5kaXNoX2lkKS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgIHZtLmRpc2ggPSBkYXRhO1xuICAgICAgICB9KTtcblxuICAgICAgICB2bS5hZGRJbnN0cnVjdGlvbiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdm0uZGlzaC5pbnN0cnVjdGlvbnMucHVzaCh2bS5uZXdJbnN0cnVjdGlvbik7XG4gICAgICAgICAgICB2bS5uZXdJbnN0cnVjdGlvbiA9ICcnO1xuICAgICAgICB9XG5cbiAgICAgICAgdm0ucmVtb3ZlSW5zdHJ1Y3Rpb24gPSBmdW5jdGlvbihpbmRleCkge1xuICAgICAgICAgICAgdm0uZGlzaC5pbnN0cnVjdGlvbnMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZtLmFkZFBob3RvID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIm5ld1Bob3RvOiBcIiwgdm0ubmV3UGhvdG8pO1xuICAgICAgICAgICAgdm0uZGlzaC5waG90b3MucHVzaCh2bS5uZXdQaG90byk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcImRpc2g6XCIsIHZtLmRpc2gpO1xuICAgICAgICAgICAgdm0ubmV3UGhvdG8gPSAnJztcbiAgICAgICAgfVxuXG4gICAgICAgIHZtLnJlbW92ZVBob3RvID0gZnVuY3Rpb24oaW5kZXgpIHtcbiAgICAgICAgICAgIHZtLmRpc2gucGhvdG9zLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgIH1cblxuICAgICAgICB2bS5zYXZlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2bS5wcm9jZXNzaW5nID0gdHJ1ZTtcblxuICAgICAgICAgICAgRGlzaFNlcnZpY2UudXBkYXRlKCRyb3V0ZVBhcmFtcy5kaXNoX2lkLCB2bS5kaXNoKS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICBpbml0KCk7XG4gICAgICAgICAgICAgICAgdm0ubWVzc2FnZSA9IGRhdGEubWVzc2FnZTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBpbml0KCkge1xuICAgICAgICAgICAgdm0ubmV3UGhvdG8gPSAnJztcbiAgICAgICAgICAgIHZtLm5ld0luc3RydWN0aW9uID0gJyc7XG4gICAgICAgICAgICB2bS5tZXNzYWdlID0gJyc7XG4gICAgICAgICAgICB2bS5wcm9jZXNzaW5nID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9KTtcbiIsImFuZ3VsYXIubW9kdWxlKCdzcGljeVRhc3RlJylcbiAgICAuY29udHJvbGxlcignSG9tZUNvbnRyb2xsZXInLCBmdW5jdGlvbihEaXNoU2VydmljZSwgQ09OU1RBTlRTKSB7XG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG4gICAgICAgIGluaXQoKTtcblxuICAgICAgICBmdW5jdGlvbiBpbml0KCkge1xuICAgICAgICAgICAgdm0ucmVjaXBlVGlsZXMgPSBbXTtcbiAgICAgICAgICAgIGJ1aWxkR3JpZCgpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gYnVpbGRHcmlkKCkge1xuICAgICAgICAgICAgRGlzaFNlcnZpY2UubGltaXQoQ09OU1RBTlRTLkxBVEVTVF9DT1VOVCkuc3VjY2VzcyhmdW5jdGlvbihkaXNoZXMpIHtcbiAgICAgICAgICAgICAgICBhbmd1bGFyLmZvckVhY2goZGlzaGVzLCBmdW5jdGlvbihkaXNoLCBpbmRleCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdGlsZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGltYWdlOiBkaXNoLmltYWdlVXJsLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGRpc2gubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBkaXNoLl9pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZXBUaW1lOiBkaXNoLnByZXBUaW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxUaW1lOiBkaXNoLnRvdGFsVGltZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpZmZpY3VsdHk6IGRpc2guZGlmZmljdWx0eSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ3M6IGRpc2gudGFncyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNwYW46IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3c6IDEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sOiAxXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChpbmRleCArIDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aWxlLnNwYW4ucm93ID0gdGlsZS5zcGFuLmNvbCA9IDI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGlsZS5zcGFuLmNvbCA9IDI7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDY6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGlsZS5zcGFuLnJvdyA9IHRpbGUuc3Bhbi5jb2wgPSAyO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA4OlxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA5OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxMDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aWxlLnNwYW4uY29sID0gMjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIHZtLnJlY2lwZVRpbGVzLnB1c2godGlsZSk7XG5cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICB9KTtcbiIsImFuZ3VsYXIubW9kdWxlKCdzcGljeVRhc3RlJylcbiAgICAuY29udHJvbGxlcignTWFpbkNvbnRyb2xsZXInLCBmdW5jdGlvbigkcm9vdFNjb3BlLCAkbG9jYXRpb24sICRtZERpYWxvZywgJGh0dHAsIFNlc3Npb25TZXJ2aWNlLCBVc2VyU2VydmljZSwgQ09OU1RBTlRTKSB7XG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG4gICAgICAgIGluaXQoKTtcblxuICAgICAgICB2bS50b2dnbGVNb2JpbGVNZW51ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2bS5zaG93TW9iaWxlTWVudSA9ICF2bS5zaG93TW9iaWxlTWVudTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZtLnNob3dMb2dpbkRpYWxvZyA9IGZ1bmN0aW9uKGV2KSB7XG4gICAgICAgICAgICAkbWREaWFsb2cuc2hvdyh7XG4gICAgICAgICAgICAgICAgY2xpY2tPdXRzaWRlVG9DbG9zZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25nL3ZpZXdzL2RpYWxvZ3MvbG9naW4uaHRtbCcsXG4gICAgICAgICAgICAgICAgdGFyZ2V0RXZlbnQ6IGV2LFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdNYWluQ29udHJvbGxlcicsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiAnbWFpbidcbiAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24odXNlcikge1xuICAgICAgICAgICAgICAgICRyb290U2NvcGUuY3VycmVudFVzZXIgPSB1c2VyO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgdm0uZmJMb2dpbiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgRkIubG9naW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSAnY29ubmVjdGVkJykge1xuICAgICAgICAgICAgICAgICAgICAvLyBMb2dnZWQgaW50byB5b3VyIGFwcCBhbmQgRmFjZWJvb2suXG4gICAgICAgICAgICAgICAgICAgIEZCLmFwaSgnL21lJywgZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmYlVzZXIgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlck5hbWU6IHJlc3BvbnNlLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZW1haWw6IHJlc3BvbnNlLmVtYWlsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhc3N3b3JkOiBDT05TVEFOVFMuU09DSUFMX1BBU1MsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGhvdG9Vcmw6ICdodHRwOi8vZ3JhcGguZmFjZWJvb2suY29tLycgKyByZXNwb25zZS5pZCArICcvcGljdHVyZT90eXBlPWxhcmdlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5rZWRTb2NpYWw6IENPTlNUQU5UUy5GQUNFQk9PS1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgVXNlclNlcnZpY2Uuc29jaWFsTG9naW4oZmJVc2VyKS50aGVuKGZ1bmN0aW9uKHVzZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VyLmxvZ2luVHlwZSA9IENPTlNUQU5UUy5GQUNFQk9PSztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZnRlckF1dGgodXNlcik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSAnbm90X2F1dGhvcml6ZWQnKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFRoZSBwZXJzb24gaXMgbG9nZ2VkIGludG8gRmFjZWJvb2ssIGJ1dCBub3QgeW91ciBhcHAuXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gVGhlIHBlcnNvbiBpcyBub3QgbG9nZ2VkIGludG8gRmFjZWJvb2ssIHNvIHdlJ3JlIG5vdCBzdXJlIGlmXG4gICAgICAgICAgICAgICAgICAgIC8vIHRoZXkgYXJlIGxvZ2dlZCBpbnRvIHRoaXMgYXBwIG9yIG5vdC5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAgc2NvcGU6ICdwdWJsaWNfcHJvZmlsZSxlbWFpbCdcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgdm0ubG9naW4gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIFVzZXJTZXJ2aWNlLmxvZ2luKHZtLmVtYWlsLCB2bS5wYXNzd29yZCkudGhlbihmdW5jdGlvbih1c2VyKSB7XG4gICAgICAgICAgICAgICAgdXNlci5sb2dpblR5cGUgPSBDT05TVEFOVFMuRU1BSUw7XG4gICAgICAgICAgICAgICAgYWZ0ZXJBdXRoKHVzZXIpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICB2bS5zaWduVXAgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBuZXdVc2VyID0ge1xuICAgICAgICAgICAgICAgIHVzZXJOYW1lOiB2bS51c2VyTmFtZSxcbiAgICAgICAgICAgICAgICBlbWFpbDogdm0uZW1haWwsXG4gICAgICAgICAgICAgICAgcGFzc3dvcmQ6IHZtLnBhc3N3b3JkLFxuICAgICAgICAgICAgICAgIHBob3RvVXJsOiAnaHR0cDovL3d3dy5ncmF2YXRhci5jb20vYXZhdGFyLycgKyBtZDUuY3JlYXRlSGFzaCh2bS5lbWFpbCksXG4gICAgICAgICAgICAgICAgbGlua2VkU29jaWFsOiBDT05TVEFOVFMuRU1BSUxcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIFVzZXJTZXJ2aWNlLmNyZWF0ZShuZXdVc2VyKS50aGVuKGZ1bmN0aW9uKHVzZXIpIHtcbiAgICAgICAgICAgICAgICB1c2VyLmxvZ2luVHlwZSA9IENPTlNUQU5UUy5FTUFJTDtcbiAgICAgICAgICAgICAgICBhZnRlckF1dGgodXNlcik7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gYWZ0ZXJBdXRoKHVzZXIpIHtcbiAgICAgICAgICAgIHZhciB0b2tlbiA9ICRodHRwLmRlZmF1bHRzLmhlYWRlcnMuY29tbW9uWydYLUF1dGgnXTtcbiAgICAgICAgICAgIFNlc3Npb25TZXJ2aWNlLnNldExvY2FsKENPTlNUQU5UUy5MT0NBTF9TVE9SQUdFX0tFWSwgdG9rZW4pO1xuICAgICAgICAgICAgJG1kRGlhbG9nLmhpZGUodXNlcik7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBpbml0KCkge1xuICAgICAgICAgICAgdm0uc2hvd01vYmlsZU1lbnUgPSBmYWxzZTtcbiAgICAgICAgICAgIHZtLmVtYWlsID0gXCJcIjtcbiAgICAgICAgICAgIHZtLnBhc3N3b3JkID0gXCJcIjtcbiAgICAgICAgICAgIHZtLnVzZXJOYW1lID0gXCJcIjtcblxuICAgICAgICAgICAgdmFyIGxvZ2luZWRUb2tlbiA9IFNlc3Npb25TZXJ2aWNlLmdldExvY2FsKENPTlNUQU5UUy5MT0NBTF9TVE9SQUdFX0tFWSk7XG4gICAgICAgICAgICBpZiAobG9naW5lZFRva2VuKSB7XG4gICAgICAgICAgICAgICAgJGh0dHAuZGVmYXVsdHMuaGVhZGVycy5jb21tb25bJ1gtQXV0aCddID0gbG9naW5lZFRva2VuO1xuICAgICAgICAgICAgICAgIFVzZXJTZXJ2aWNlLmdldCgpLnRoZW4oZnVuY3Rpb24odXNlcikge1xuICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmN1cnJlbnRVc2VyID0gdXNlcjtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgfSk7XG4iLCJhbmd1bGFyLm1vZHVsZSgnc3BpY3lUYXN0ZScpXG4gICAgLmNvbnRyb2xsZXIoJ1Byb2ZpbGVDb250cm9sbGVyJywgZnVuY3Rpb24oJGxvY2F0aW9uLCAkcm9vdFNjb3BlLCBVc2VyU2VydmljZSkge1xuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuICAgICAgICBpbml0KCk7XG5cbiAgICAgICAgdm0ubG9nb3V0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBVc2VyU2VydmljZS5sb2dvdXQoKTtcbiAgICAgICAgICAgICRyb290U2NvcGUuY3VycmVudFVzZXIgPSBudWxsO1xuICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy8nKTtcbiAgICAgICAgfTtcblxuICAgICAgICBmdW5jdGlvbiBpbml0KCkge1xuICAgICAgICAgICAgdm0udXNlciA9IHt9O1xuICAgICAgICAgICAgVXNlclNlcnZpY2UuZ2V0KCkudGhlbihmdW5jdGlvbih1c2VyKSB7XG4gICAgICAgICAgICAgICAgdm0udXNlciA9IHVzZXI7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgfSk7XG4iLCJhbmd1bGFyLm1vZHVsZSgnc3BpY3lUYXN0ZScpXG4gICAgLmZhY3RvcnkoJ0Rpc2hTZXJ2aWNlJywgZnVuY3Rpb24oJGh0dHApIHtcblxuICAgICAgICAvL2NyZWF0ZSBhIG5ldyBvYmplY3RcbiAgICAgICAgdmFyIGRpc2hGYWN0b3J5ID0ge307XG5cbiAgICAgICAgLy9nZXQgYWxsIGRpc2hlc1xuICAgICAgICBkaXNoRmFjdG9yeS5hbGwgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvZGlzaGVzJyk7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy9nZXQgbGltaXRlZCBsYXRlc3QgZGlzaGVzXG4gICAgICAgIGRpc2hGYWN0b3J5LmxpbWl0ID0gZnVuY3Rpb24obnVtKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL2Rpc2hlcz9saW1pdD0nICsgbnVtKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vY3JlYXRlIGEgZGlzaFxuICAgICAgICBkaXNoRmFjdG9yeS5jcmVhdGUgPSBmdW5jdGlvbihkaXNoKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9kaXNoZXMnLCBkaXNoKTtcbiAgICAgICAgfTtcblxuICAgICAgICAvL2dldCBhIHNpbmdsZSBkaXNoXG4gICAgICAgIGRpc2hGYWN0b3J5LmdldCA9IGZ1bmN0aW9uKGRpc2hfaWQpIHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvZGlzaGVzLycgKyBkaXNoX2lkKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vdXBkYXRlIGEgZGlzaFxuICAgICAgICBkaXNoRmFjdG9yeS51cGRhdGUgPSBmdW5jdGlvbihkaXNoX2lkLCBkaXNoKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucHV0KCcvYXBpL2Rpc2hlcy8nICsgZGlzaF9pZCwgZGlzaCk7XG4gICAgICAgIH1cblxuICAgICAgICAvL2RlbGV0ZSBhIGRpc2hcbiAgICAgICAgZGlzaEZhY3RvcnkuZGVsZXRlID0gZnVuY3Rpb24oZGlzaF9pZCkge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLmRlbGV0ZSgnL2FwaS9kaXNoZXMvJyArIGRpc2hfaWQpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9hZGQgYSBjb21tZW50XG4gICAgICAgIGRpc2hGYWN0b3J5LmFkZENvbW1lbnQgPSBmdW5jdGlvbihkaXNoX2lkLCBjb21tZW50KSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9kaXNoZXMvJyArIGRpc2hfaWQgKyAnL2NvbW1lbnRzJywgY29tbWVudCk7XG4gICAgICAgIH1cblxuICAgICAgICAvL2dldCBkaWZmaWN1bHR5XG4gICAgICAgIGRpc2hGYWN0b3J5LmdldERpZmZpY3VsdGllcyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIFsn5Yid5a2mJywgJ+WuueaYkycsICfkuIDoiKwnLCAn6L6D6Zq+JywgJ+S4k+S4middO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBkaXNoRmFjdG9yeTtcbiAgICB9KTtcbiIsImFuZ3VsYXIubW9kdWxlKCdzcGljeVRhc3RlJylcbiAgICAuZmFjdG9yeSgnU2Vzc2lvblNlcnZpY2UnLCBmdW5jdGlvbigkd2luZG93KSB7XG4gICAgICAgIHZhciBzZXNzaW9uRmFjdG9yeSA9IHt9O1xuXG4gICAgICAgIHNlc3Npb25GYWN0b3J5LmdldExvY2FsID0gZnVuY3Rpb24oa2V5KSB7XG4gICAgICAgICAgICBpZiAoJHdpbmRvdy5sb2NhbFN0b3JhZ2UpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGF0YSA9ICR3aW5kb3cubG9jYWxTdG9yYWdlLmdldEl0ZW0oa2V5KTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBhbmd1bGFyLmZyb21Kc29uKGRhdGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgc2Vzc2lvbkZhY3Rvcnkuc2V0TG9jYWwgPSBmdW5jdGlvbihrZXksIGRhdGEpIHtcbiAgICAgICAgICAgIHJldHVybiAkd2luZG93LmxvY2FsU3RvcmFnZSAmJiAkd2luZG93LmxvY2FsU3RvcmFnZS5zZXRJdGVtKGtleSwgYW5ndWxhci50b0pzb24oZGF0YSkpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHNlc3Npb25GYWN0b3J5O1xuXG4gICAgfSk7XG4iLCJhbmd1bGFyLm1vZHVsZSgnc3BpY3lUYXN0ZScpXG4gICAgLmZhY3RvcnkoJ1NvY2lhbFNlcnZpY2UnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHNvY2lhbEZhY3RvcnkgPSB7fTtcblxuICAgICAgICBzb2NpYWxGYWN0b3J5LmZiU2hhcmUgPSBmdW5jdGlvbihsaW5rKSB7XG4gICAgICAgICAgICBGQi51aSh7XG4gICAgICAgICAgICAgICAgbWV0aG9kOiAnc2hhcmUnLFxuICAgICAgICAgICAgICAgIGhyZWY6IGxpbmssXG4gICAgICAgICAgICB9LCBmdW5jdGlvbihyZXNwb25zZSkge30pO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHNvY2lhbEZhY3Rvcnk7XG4gICAgfSk7XG4iLCJhbmd1bGFyLm1vZHVsZSgnc3BpY3lUYXN0ZScpXG4gICAgLmZhY3RvcnkoJ1VzZXJTZXJ2aWNlJywgZnVuY3Rpb24oJGh0dHAsICRyb290U2NvcGUsICR3aW5kb3csIENPTlNUQU5UUykge1xuICAgICAgICB2YXIgdXNlckZhY3RvcnkgPSB7fTtcbiAgICAgICAgLy9zb2NpYWwgbG9naW5cbiAgICAgICAgdXNlckZhY3Rvcnkuc29jaWFsTG9naW4gPSBmdW5jdGlvbihzb2NpYWxVc2VyKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcInNvY2lhbFVzZXI6IFwiLCBzb2NpYWxVc2VyKTtcblxuICAgICAgICAgICAgcmV0dXJuIHVzZXJGYWN0b3J5LnNlYXJjaEJ5KCdlbWFpbD0nICsgc29jaWFsVXNlci5lbWFpbCkudGhlbihmdW5jdGlvbihkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICBpZiAoIWRhdGEuc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICAvL25vdCBmb3VuZCwgdGhlbiBjcmVhdGVcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVzZXJGYWN0b3J5LmNyZWF0ZShzb2NpYWxVc2VyKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvL2ZvdW5kIHRoZSB1c2VyIHdpdGggZW1haWxcbiAgICAgICAgICAgICAgICAgICAgLy91cGRhdGUgdGhlIGxpbmtlZCBzb2NpYWwgaWYgbm90IGFkZGVkXG4gICAgICAgICAgICAgICAgICAgIHZhciB1c2VyID0gZGF0YS51c2Vyc1swXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHVzZXIubGlua2VkU29jaWFsLmluZGV4T2Yoc29jaWFsVXNlci5saW5rZWRTb2NpYWwpIDwgMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdXNlci5saW5rZWRTb2NpYWwucHVzaChzb2NpYWxVc2VyLmxpbmtlZFNvY2lhbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VyLnVzZXJOYW1lID0gc29jaWFsVXNlci51c2VyTmFtZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXIucGhvdG9VcmwgPSBzb2NpYWxVc2VyLnBob3RvVXJsO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdXNlckZhY3RvcnkudXBkYXRlKHVzZXIpLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVzZXJGYWN0b3J5LmxvZ2luKHVzZXIuZW1haWwsIENPTlNUQU5UUy5TT0NJQUxfUEFTUyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB1c2VyRmFjdG9yeS5sb2dpbih1c2VyLmVtYWlsLCBDT05TVEFOVFMuU09DSUFMX1BBU1MpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICAvL2xvZ2luIHVzZXJcbiAgICAgICAgdXNlckZhY3RvcnkubG9naW4gPSBmdW5jdGlvbihlbWFpbCwgcGFzc3dvcmQpIHtcblxuICAgICAgICAgICAgcmV0dXJuICRodHRwLnBvc3QoJy9hcGkvYXV0aCcsIHtcbiAgICAgICAgICAgICAgICBlbWFpbDogZW1haWwsXG4gICAgICAgICAgICAgICAgcGFzc3dvcmQ6IHBhc3N3b3JkXG4gICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgJGh0dHAuZGVmYXVsdHMuaGVhZGVycy5jb21tb25bJ1gtQXV0aCddID0gcmVzcG9uc2UuZGF0YTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdXNlckZhY3RvcnkuZ2V0KCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICB9XG5cbiAgICAgICAgLy9sb2dvdXQgdXNlclxuICAgICAgICB1c2VyRmFjdG9yeS5sb2dvdXQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGRlbGV0ZSAkaHR0cC5kZWZhdWx0cy5oZWFkZXJzLmNvbW1vblsnWC1BdXRoJ107XG4gICAgICAgICAgICAkd2luZG93LmxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKENPTlNUQU5UUy5MT0NBTF9TVE9SQUdFX0tFWSk7XG4gICAgICAgIH1cblxuICAgICAgICAvL2dldCBjdXJyZW50IHVzZXJcbiAgICAgICAgdXNlckZhY3RvcnkuZ2V0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3VzZXJzL21lJykudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5kYXRhO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICAvL3NlYXJjaCB1c2VyIGJ5IGZpZWxkXG4gICAgICAgIHVzZXJGYWN0b3J5LnNlYXJjaEJ5ID0gZnVuY3Rpb24ocXVlcnkpIHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvdXNlcnM/JyArIHF1ZXJ5KS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGE7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vZ2V0IHVzZXIgYnkgaWRcbiAgICAgICAgdXNlckZhY3RvcnkuZ2V0QnlJZCA9IGZ1bmN0aW9uKHVzZXJfaWQpIHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvdXNlcnMvJyArIHVzZXJfaWQpLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9jcmVhdGUgYSBuZXcgdXNlclxuICAgICAgICB1c2VyRmFjdG9yeS5jcmVhdGUgPSBmdW5jdGlvbih1c2VyKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS91c2Vycy8nLCB1c2VyKS50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB1c2VyRmFjdG9yeS5sb2dpbih1c2VyLmVtYWlsLCB1c2VyLnBhc3N3b3JkKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgLy91cGRhdGUgdXNlclxuICAgICAgICB1c2VyRmFjdG9yeS51cGRhdGUgPSBmdW5jdGlvbih1c2VyX2lkLCB1c2VyKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucHV0KCcvYXBpL3VzZXJzLycgKyB1c2VyX2lkLCB1c2VyKS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGE7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vY29sbGVjdCBkaXNoIGFzIGZhdm91cml0ZVxuICAgICAgICB1c2VyRmFjdG9yeS5jb2xsZWN0ID0gZnVuY3Rpb24oZGlzaF9pZCkge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLnB1dCgnL2FwaS91c2Vycy8nICsgJHJvb3RTY29wZS51c2VyLl9pZCArICcvZGlzaGVzLycgKyBkaXNoX2lkKS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGE7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB1c2VyRmFjdG9yeTtcbiAgICB9KTtcbiIsImFuZ3VsYXIubW9kdWxlKCdzcGljeVRhc3RlJylcbiAgICAuZGlyZWN0aXZlKCdjb250ZW50ZWRpdGFibGUnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJlcXVpcmU6ICduZ01vZGVsJyxcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICAgICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cmlidXRzLCBuZ01vZGVsKSB7XG4gICAgICAgICAgICAgICAgbmdNb2RlbC4kcmVuZGVyID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuaHRtbChuZ01vZGVsLiR2aWV3VmFsdWUgfHwgJycpO1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICBlbGVtZW50LmJpbmQoJ2JsdXInLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmdNb2RlbC4kc2V0Vmlld1ZhbHVlKGVsZW1lbnQuaHRtbCgpKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfSk7XG4iLCJhbmd1bGFyLm1vZHVsZSgnc3BpY3lUYXN0ZScpXG4gICAgLmRpcmVjdGl2ZSgnZm9jdXNPbicsIGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAgICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICAgICAgZm9jdXNWYWx1ZTogXCI9Zm9jdXNPblwiXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgbGluazogZnVuY3Rpb24oJHNjb3BlLCAkZWxlbWVudCkge1xuICAgICAgICAgICAgICAgICRzY29wZS4kd2F0Y2goJ2ZvY3VzVmFsdWUnLCBmdW5jdGlvbihjdXJyZW50VmFsdWUsIHByZXZpb3VzVmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRWYWx1ZSAmJiAhcHJldmlvdXNWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJGVsZW1lbnRbMF0uZm9jdXMoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH0pO1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9