angular.module("spicyTaste",["ngRoute","angular-md5","ngMaterial","ngAnimate","ngMessages"]).constant("CONSTANTS",{FB_APP_ID:0x58e0e66b31adc,FACEBOOK:"FB",EMAIL:"EMAIL",SOCIAL_PASS:"PASSWORD",LOCAL_STORAGE_KEY:"spicyTasteUser",LATEST_COUNT:10}),angular.module("spicyTaste").config(["$mdThemingProvider","$mdIconProvider",function(e,t){var n=e.extendPalette("deep-orange",{500:"f27242"}),o=e.extendPalette("blue",{500:"6984b4",600:"6984b4"});e.definePalette("primaryOrange",n),e.definePalette("primaryBlue",o),e.theme("default").primaryPalette("primaryOrange").accentPalette("light-green"),e.theme("blue").primaryPalette("primaryBlue"),t.icon("menu","svg/ic_menu_24px.svg").icon("share","svg/ic_share_48px.svg").icon("login","svg/ic_account_circle_24px.svg").icon("recipes","svg/ic_event_note_48px.svg").icon("restaurants","svg/ic_restaurant_menu_48px.svg").icon("ingredients","svg/ic_receipt_48px.svg").icon("arrow","svg/ic_arrow_drop_up_48px.svg").icon("more","svg/ic_more_24px.svg").icon("time1","svg/ic_av_timer_24px.svg").icon("time2","svg/ic_access_time_24px.svg").icon("difficulty","svg/ic_track_changes_24px.svg").icon("exit","svg/ic_exit_to_app_48px.svg").icon("photo","svg/ic_mms_24px.svg").icon("check","svg/ic_check_circle_24px.svg").icon("facebook","svg/facebook.svg").icon("twitter","svg/twitter.svg").icon("pinterest","svg/pinterest.svg").icon("comments","svg/ic_chat_48px.svg")}]),angular.module("spicyTaste").run(["$rootScope","$window","UserService","CONSTANTS",function(e,t,n,o){e.user=null,t.fbAsyncInit=function(){FB.init({appId:o.FB_APP_ID,cookie:!0,xfbml:!0,version:"v2.2"})},function(e,t,n){var o,i=e.getElementsByTagName(t)[0];e.getElementById(n)||(o=e.createElement(t),o.id=n,o.src="//connect.facebook.net/en_US/sdk.js",i.parentNode.insertBefore(o,i))}(document,"script","facebook-jssdk")}]),angular.module("spicyTaste").config(["$locationProvider","$routeProvider",function(e,t){e.html5Mode(!0),t.when("/",{templateUrl:"ng/views/pages/home.html",controller:"HomeController",controllerAs:"home"}).when("/dishes",{templateUrl:"ng/views/pages/dish/all.html",controller:"DishListController",controllerAs:"dishList"}).when("/dishes/:dish_id",{templateUrl:"ng/views/pages/dish/detail.html",controller:"DishDetailController",controllerAs:"detail"}).when("/admin/dishes/list",{templateUrl:"ng/views/pages/admin/dish/list.html",controller:"DishListController",controllerAs:"dishList"}).when("/admin/dishes/create",{templateUrl:"ng/views/pages/admin/dish/single.html",controller:"DishCreateController",controllerAs:"dishManage"}).when("/admin/dishes/:dish_id",{templateUrl:"ng/views/pages/admin/dish/single.html",controller:"DishEditController",controllerAs:"dishManage"}).when("/login",{templateUrl:"ng/views/pages/user/login.html",controller:"LoginController",controllerAs:"login"}).when("/me",{templateUrl:"ng/views/pages/user/me.html",controller:"ProfileController",controllerAs:"me"})}]),angular.module("spicyTaste").controller("DishListController",["DishService","SocialService","$location",function(e,t,n){var o=this;o.processing=!0,e.all().success(function(e){o.processing=!1,o.dishes=e}),o.deleteDish=function(t){o.processing=!0,e["delete"](t).success(function(t){e.all().success(function(e){o.processing=!1,o.dishes=e})})},o.addDish=function(){o.processing=!0,e.create({name:"new dish"}).success(function(e){n.path("/admin/dish/"+e.dish._id)})},o.fbShare=function(e){var o=n.absUrl()+"/"+e._id;t.fbShare(o)}}]).controller("DishDetailController",["$scope","$location","$rootScope","$routeParams","$mdDialog","DishService","UserService",function(e,t,n,o,i,s,r){function c(){}function a(e,t,n){i.show({targetEvent:t,clickOutsideToClose:!0,templateUrl:"ng/views/dialogs/comment.html",locals:{title:e},controller:l,controllerAs:"comment"}).then(function(e){s.addComment(u.dish._id,{content:e,replyTo:n}).success(function(e){u.dish.comments.push(e)})})}function l(e,t){var n=this;n.content="",n.title=e,n.closeDialog=function(){t.cancel()},n.submit=function(){""==n.content.trim()?t.cancel():t.hide(n.content)}}var u=this;u.dish={},c(),s.get(o.dish_id).success(function(e){u.dish=e,u.dish.isCollected=n.user&&n.user.favouriteDishes.indexOf(u.dish._id)>=0?!0:!1}),u.reply=function(e,t){var n="@"+e.userName;a(n,t,e._id)},u.collect=function(){if(!n.user){var e=t.url();return t.path("/login").search({returnUrl:e})}r.collect(u.dish._id).then(function(e){console.log("UserService.collect:",e),e.success&&(u.dish.isCollected=!0)})},u.showInstructionPhoto=function(e,t){null!=e&&""!=e.trim()&&i.show({targetEvent:t,clickOutsideToClose:!0,template:'<md-dialog>  <md-dialog-content><img src="{{photo}}"></md-dialog-content></md-dialog>',controller:["$scope",function(t){t.photo=e}]})},u.newComment=function(e){a("Comment",e,null)},l.$inject=["title","$mdDialog"]}]).controller("DishCreateController",["$location","DishService",function(e,t){var n=this;n.dish={name:"new dish"},n.save=function(){n.processing=!0,t.create(n.dish).success(function(t){e.path("/admin/dish/"+t.dish._id)})}}]).controller("DishEditController",["$routeParams","DishService","$location",function(e,t,n){function o(){i.newPhoto="",i.newInstruction="",i.message="",i.processing=!1}var i=this;o(),t.get(e.dish_id).success(function(e){i.dish=e}),i.addInstruction=function(){i.dish.instructions.push(i.newInstruction),i.newInstruction=""},i.removeInstruction=function(e){i.dish.instructions.splice(e,1)},i.addPhoto=function(){console.log("newPhoto: ",i.newPhoto),i.dish.photos.push(i.newPhoto),console.log("dish:",i.dish),i.newPhoto=""},i.removePhoto=function(e){i.dish.photos.splice(e,1)},i.save=function(){i.processing=!0,t.update(e.dish_id,i.dish).success(function(e){o(),i.message=e.message})}}]),angular.module("spicyTaste").controller("HomeController",["DishService","CONSTANTS",function(e,t){function n(){i.recipeTiles=[],o()}function o(){e.limit(t.LATEST_COUNT).success(function(e){angular.forEach(e,function(e,t){var n={image:e.imageUrl,title:e.name,id:e._id,prepTime:e.prepTime,totalTime:e.totalTime,difficulty:e.difficulty,tags:e.tags,span:{row:1,col:1}};switch(t+1){case 1:n.span.row=n.span.col=2;break;case 2:case 3:break;case 4:n.span.col=2;case 5:case 6:break;case 7:n.span.row=n.span.col=2;case 8:case 9:break;case 10:n.span.col=2}i.recipeTiles.push(n)})})}var i=this;n()}]),angular.module("spicyTaste").controller("MainController",["$rootScope","$location","$mdDialog","$http","SessionService","UserService","CONSTANTS",function(e,t,n,o,i,s,r){function c(e){var t=o.defaults.headers.common["X-Auth"];i.setLocal(r.LOCAL_STORAGE_KEY,t),n.hide(e)}function a(){l.showMobileMenu=!1,l.email="",l.password="",l.userName="";var t=i.getLocal(r.LOCAL_STORAGE_KEY);t&&(o.defaults.headers.common["X-Auth"]=t,s.get().then(function(t){e.currentUser=t}))}var l=this;a(),l.toggleMobileMenu=function(){l.showMobileMenu=!l.showMobileMenu},l.showLoginDialog=function(t){n.show({clickOutsideToClose:!0,templateUrl:"ng/views/dialogs/login.html",targetEvent:t,controller:"MainController",controllerAs:"main"}).then(function(t){e.currentUser=t})},l.fbLogin=function(){FB.login(function(e){"connected"===e.status?FB.api("/me",function(e){var t={userName:e.name,email:e.email,password:r.SOCIAL_PASS,photoUrl:"http://graph.facebook.com/"+e.id+"/picture?type=large",linkedSocial:r.FACEBOOK};s.socialLogin(t).then(function(e){e.loginType=r.FACEBOOK,c(e)})}):"not_authorized"===e.status},{scope:"public_profile,email"})},l.login=function(){s.login(l.email,l.password).then(function(e){e.loginType=r.EMAIL,c(e)})},l.signUp=function(){var e={userName:l.userName,email:l.email,password:l.password,photoUrl:"http://www.gravatar.com/avatar/"+md5.createHash(l.email),linkedSocial:r.EMAIL};s.create(e).then(function(e){e.loginType=r.EMAIL,c(e)})}}]),angular.module("spicyTaste").controller("ProfileController",["$location","$rootScope","UserService",function(e,t,n){function o(){i.user={},n.get().then(function(e){i.user=e})}var i=this;o(),i.logout=function(){n.logout(),t.currentUser=null,e.path("/")}}]),angular.module("spicyTaste").directive("contenteditable",function(){return{require:"ngModel",restrict:"A",link:function(e,t,n,o){o.$render=function(){t.html(o.$viewValue||"")},t.bind("blur",function(){e.$apply(function(){o.$setViewValue(t.html())})})}}}),angular.module("spicyTaste").directive("focusOn",function(){return{restrict:"A",scope:{focusValue:"=focusOn"},link:function(e,t){e.$watch("focusValue",function(e,n){e&&!n&&t[0].focus()})}}}),angular.module("spicyTaste").factory("DishService",["$http",function(e){var t={};return t.all=function(){return e.get("/api/dishes")},t.limit=function(t){return e.get("/api/dishes?limit="+t)},t.create=function(t){return e.post("/api/dishes",t)},t.get=function(t){return e.get("/api/dishes/"+t)},t.update=function(t,n){return e.put("/api/dishes/"+t,n)},t["delete"]=function(t){return e["delete"]("/api/dishes/"+t)},t.addComment=function(t,n){return e.post("/api/dishes/"+t+"/comments",n)},t.getDifficulties=function(){return["初学","容易","一般","较难","专业"]},t}]),angular.module("spicyTaste").factory("SessionService",["$window",function(e){var t={};return t.getLocal=function(t){if(e.localStorage){var n=e.localStorage.getItem(t);return angular.fromJson(n)}return!1},t.setLocal=function(t,n){return e.localStorage&&e.localStorage.setItem(t,angular.toJson(n))},t}]),angular.module("spicyTaste").factory("SocialService",function(){var e={};return e.fbShare=function(e){FB.ui({method:"share",href:e},function(e){})},e}),angular.module("spicyTaste").factory("UserService",["$http","$rootScope","$window","CONSTANTS",function(e,t,n,o){var i={};return i.socialLogin=function(e){return console.log("socialUser: ",e),i.searchBy("email="+e.email).then(function(t){if(t.success){var n=t.users[0];return n.linkedSocial.indexOf(e.linkedSocial)<0?(n.linkedSocial.push(e.linkedSocial),n.userName=e.userName,n.photoUrl=e.photoUrl,i.update(n).then(function(){return i.login(n.email,o.SOCIAL_PASS)})):i.login(n.email,o.SOCIAL_PASS)}return i.create(e)})},i.login=function(t,n){return e.post("/api/auth",{email:t,password:n}).then(function(t){return e.defaults.headers.common["X-Auth"]=t.data,i.get()})},i.logout=function(){delete e.defaults.headers.common["X-Auth"],n.localStorage.removeItem(o.LOCAL_STORAGE_KEY)},i.get=function(){return e.get("/api/users/me").then(function(e){return e.data})},i.searchBy=function(t){return e.get("/api/users?"+t).then(function(e){return e.data})},i.getById=function(t){return e.get("/api/users/"+t).then(function(e){return e.data})},i.create=function(t){return e.post("/api/users/",t).then(function(){return i.login(t.email,t.password)})},i.update=function(t,n){return e.put("/api/users/"+t,n).then(function(e){return e.data})},i.collect=function(n){return e.put("/api/users/"+t.user._id+"/dishes/"+n).then(function(e){return e.data})},i}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsImRlc2lnbi5qcyIsImZhY2Vib29rLmpzIiwicm91dGVzLmpzIiwiY29udHJvbGxlcnMvZGlzaENvbnRyb2xsZXIuanMiLCJhcHAuanMiLCJjb250cm9sbGVycy9ob21lQ29udHJvbGxlci5qcyIsImNvbnRyb2xsZXJzL21haW5Db250cm9sbGVyLmpzIiwiY29udHJvbGxlcnMvcHJvZmlsZUNvbnRyb2xsZXIuanMiLCJkaXJlY3RpdmVzL2NvbnRlbnRlZGl0YWJsZURpcmVjdGl2ZS5qcyIsImRpcmVjdGl2ZXMvZm9jdXNPbkRpcmVjdGl2ZS5qcyIsInNlcnZpY2VzL2Rpc2hTZXJ2aWNlLmpzIiwic2VydmljZXMvc2Vzc2lvblNlcnZpY2UuanMiLCJzZXJ2aWNlcy9zb2NpYWxTZXJ2aWNlLmpzIiwic2VydmljZXMvdXNlclNlcnZpY2UuanMiXSwibmFtZXMiOlsiYW5ndWxhciIsIm1vZHVsZSIsImNvbnN0YW50IiwiRkJfQVBQX0lEIiwiRkFDRUJPT0siLCJFTUFJTCIsIlNPQ0lBTF9QQVNTIiwiTE9DQUxfU1RPUkFHRV9LRVkiLCJMQVRFU1RfQ09VTlQiLCJjb25maWciLCIkbWRUaGVtaW5nUHJvdmlkZXIiLCIkbWRJY29uUHJvdmlkZXIiLCJwcmltYXJ5T3JhbmdlIiwiZXh0ZW5kUGFsZXR0ZSIsIjUwMCIsInByaW1hcnlCbHVlIiwiNjAwIiwiZGVmaW5lUGFsZXR0ZSIsInRoZW1lIiwicHJpbWFyeVBhbGV0dGUiLCJhY2NlbnRQYWxldHRlIiwiaWNvbiIsInJ1biIsIiRyb290U2NvcGUiLCIkd2luZG93IiwiVXNlclNlcnZpY2UiLCJDT05TVEFOVFMiLCJ1c2VyIiwiZmJBc3luY0luaXQiLCJGQiIsImluaXQiLCJhcHBJZCIsImNvb2tpZSIsInhmYm1sIiwidmVyc2lvbiIsImQiLCJzIiwiaWQiLCJqcyIsImZqcyIsImdldEVsZW1lbnRzQnlUYWdOYW1lIiwiZ2V0RWxlbWVudEJ5SWQiLCJjcmVhdGVFbGVtZW50Iiwic3JjIiwicGFyZW50Tm9kZSIsImluc2VydEJlZm9yZSIsImRvY3VtZW50IiwiJGxvY2F0aW9uUHJvdmlkZXIiLCIkcm91dGVQcm92aWRlciIsImh0bWw1TW9kZSIsIndoZW4iLCJ0ZW1wbGF0ZVVybCIsImNvbnRyb2xsZXIiLCJjb250cm9sbGVyQXMiLCJEaXNoU2VydmljZSIsIlNvY2lhbFNlcnZpY2UiLCIkbG9jYXRpb24iLCJ2bSIsInRoaXMiLCJwcm9jZXNzaW5nIiwiYWxsIiwic3VjY2VzcyIsImRhdGEiLCJkaXNoZXMiLCJkZWxldGVEaXNoIiwiYWRkRGlzaCIsImNyZWF0ZSIsIm5hbWUiLCJwYXRoIiwiZGlzaCIsIl9pZCIsImZiU2hhcmUiLCJkaXNoTGluayIsImFic1VybCIsIiRzY29wZSIsIiRyb3V0ZVBhcmFtcyIsIiRtZERpYWxvZyIsIm9wZW5Db21tZW50RGlhbG9nIiwidGl0bGUiLCIkZXZlbnQiLCJyZXBseVRvIiwic2hvdyIsInRhcmdldEV2ZW50IiwiY2xpY2tPdXRzaWRlVG9DbG9zZSIsImxvY2FscyIsImNvbW1lbnRDb250cm9sbGVyIiwidGhlbiIsImNvbnRlbnQiLCJhZGRDb21tZW50IiwiY29tbWVudCIsImNvbW1lbnRzIiwicHVzaCIsImR2bSIsImNsb3NlRGlhbG9nIiwiY2FuY2VsIiwic3VibWl0IiwidHJpbSIsImhpZGUiLCJnZXQiLCJkaXNoX2lkIiwiaXNDb2xsZWN0ZWQiLCJmYXZvdXJpdGVEaXNoZXMiLCJpbmRleE9mIiwicmVwbHkiLCJjb21tZW50VGl0bGUiLCJ1c2VyTmFtZSIsImNvbGxlY3QiLCJyZXR1cm5VcmwiLCJ1cmwiLCJzZWFyY2giLCJjb25zb2xlIiwibG9nIiwic2hvd0luc3RydWN0aW9uUGhvdG8iLCJwaG90b1VybCIsInRlbXBsYXRlIiwicGhvdG8iLCJuZXdDb21tZW50IiwiJGluamVjdCIsInNhdmUiLCJuZXdQaG90byIsIm5ld0luc3RydWN0aW9uIiwibWVzc2FnZSIsImFkZEluc3RydWN0aW9uIiwiaW5zdHJ1Y3Rpb25zIiwicmVtb3ZlSW5zdHJ1Y3Rpb24iLCJpbmRleCIsInNwbGljZSIsImFkZFBob3RvIiwicGhvdG9zIiwicmVtb3ZlUGhvdG8iLCJ1cGRhdGUiLCJyZWNpcGVUaWxlcyIsImJ1aWxkR3JpZCIsImxpbWl0IiwiZm9yRWFjaCIsInRpbGUiLCJpbWFnZSIsImltYWdlVXJsIiwicHJlcFRpbWUiLCJ0b3RhbFRpbWUiLCJkaWZmaWN1bHR5IiwidGFncyIsInNwYW4iLCJyb3ciLCJjb2wiLCIkaHR0cCIsIlNlc3Npb25TZXJ2aWNlIiwiYWZ0ZXJBdXRoIiwidG9rZW4iLCJkZWZhdWx0cyIsImhlYWRlcnMiLCJjb21tb24iLCJzZXRMb2NhbCIsInNob3dNb2JpbGVNZW51IiwiZW1haWwiLCJwYXNzd29yZCIsImxvZ2luZWRUb2tlbiIsImdldExvY2FsIiwiY3VycmVudFVzZXIiLCJ0b2dnbGVNb2JpbGVNZW51Iiwic2hvd0xvZ2luRGlhbG9nIiwiZXYiLCJmYkxvZ2luIiwibG9naW4iLCJyZXNwb25zZSIsInN0YXR1cyIsImFwaSIsImZiVXNlciIsImxpbmtlZFNvY2lhbCIsInNvY2lhbExvZ2luIiwibG9naW5UeXBlIiwic2NvcGUiLCJzaWduVXAiLCJuZXdVc2VyIiwibWQ1IiwiY3JlYXRlSGFzaCIsImxvZ291dCIsImRpcmVjdGl2ZSIsInJlcXVpcmUiLCJyZXN0cmljdCIsImxpbmsiLCJlbGVtZW50IiwiYXR0cmlidXRzIiwibmdNb2RlbCIsIiRyZW5kZXIiLCJodG1sIiwiJHZpZXdWYWx1ZSIsImJpbmQiLCIkYXBwbHkiLCIkc2V0Vmlld1ZhbHVlIiwiZm9jdXNWYWx1ZSIsIiRlbGVtZW50IiwiJHdhdGNoIiwiY3VycmVudFZhbHVlIiwicHJldmlvdXNWYWx1ZSIsImZvY3VzIiwiZmFjdG9yeSIsImRpc2hGYWN0b3J5IiwibnVtIiwicG9zdCIsInB1dCIsImdldERpZmZpY3VsdGllcyIsInNlc3Npb25GYWN0b3J5Iiwia2V5IiwibG9jYWxTdG9yYWdlIiwiZ2V0SXRlbSIsImZyb21Kc29uIiwic2V0SXRlbSIsInRvSnNvbiIsInNvY2lhbEZhY3RvcnkiLCJ1aSIsIm1ldGhvZCIsImhyZWYiLCJ1c2VyRmFjdG9yeSIsInNvY2lhbFVzZXIiLCJzZWFyY2hCeSIsInVzZXJzIiwicmVtb3ZlSXRlbSIsInF1ZXJ5IiwiZ2V0QnlJZCIsInVzZXJfaWQiXSwibWFwcGluZ3MiOiJBQUFBQSxRQUFBQyxPQUFBLGNBQUEsVUFBQSxjQUFBLGFBQUEsWUFBQSxlQUNBQyxTQUFBLGFBQ0FDLFVBQUEsZ0JBQ0FDLFNBQUEsS0FDQUMsTUFBQSxRQUNBQyxZQUFBLFdBQ0FDLGtCQUFBLGlCQUNBQyxhQUFBLEtDUEFSLFFBQUFDLE9BQUEsY0FDQVEsUUFBQSxxQkFBQSxrQkFBQSxTQUFBQyxFQUFBQyxHQUVBLEdBQUFDLEdBQUFGLEVBQUFHLGNBQUEsZUFDQUMsSUFBQSxXQUdBQyxFQUFBTCxFQUFBRyxjQUFBLFFBQ0FDLElBQUEsU0FDQUUsSUFBQSxVQUdBTixHQUFBTyxjQUFBLGdCQUFBTCxHQUNBRixFQUFBTyxjQUFBLGNBQUFGLEdBRUFMLEVBQUFRLE1BQUEsV0FDQUMsZUFBQSxpQkFDQUMsY0FBQSxlQUVBVixFQUFBUSxNQUFBLFFBQ0FDLGVBQUEsZUFFQVIsRUFBQVUsS0FBQSxPQUFBLHdCQUNBQSxLQUFBLFFBQUEseUJBQ0FBLEtBQUEsUUFBQSxrQ0FDQUEsS0FBQSxVQUFBLDhCQUNBQSxLQUFBLGNBQUEsbUNBQ0FBLEtBQUEsY0FBQSwyQkFDQUEsS0FBQSxRQUFBLGlDQUNBQSxLQUFBLE9BQUEsd0JBQ0FBLEtBQUEsUUFBQSw0QkFDQUEsS0FBQSxRQUFBLCtCQUNBQSxLQUFBLGFBQUEsaUNBQ0FBLEtBQUEsT0FBQSwrQkFDQUEsS0FBQSxRQUFBLHVCQUNBQSxLQUFBLFFBQUEsZ0NBQ0FBLEtBQUEsV0FBQSxvQkFDQUEsS0FBQSxVQUFBLG1CQUNBQSxLQUFBLFlBQUEscUJBQ0FBLEtBQUEsV0FBQSwyQkN2Q0FyQixRQUFBQyxPQUFBLGNBQ0FxQixLQUFBLGFBQUEsVUFBQSxjQUFBLFlBQUEsU0FBQUMsRUFBQUMsRUFBQUMsRUFBQUMsR0FDQUgsRUFBQUksS0FBQSxLQUVBSCxFQUFBSSxZQUFBLFdBQ0FDLEdBQUFDLE1BQ0FDLE1BQUFMLEVBQUF2QixVQUNBNkIsUUFBQSxFQUNBQyxPQUFBLEVBQ0FDLFFBQUEsVUFLQSxTQUFBQyxFQUFBQyxFQUFBQyxHQUNBLEdBQUFDLEdBQUFDLEVBQUFKLEVBQUFLLHFCQUFBSixHQUFBLEVBQ0FELEdBQUFNLGVBQUFKLEtBQ0FDLEVBQUFILEVBQUFPLGNBQUFOLEdBQ0FFLEVBQUFELEdBQUFBLEVBQ0FDLEVBQUFLLElBQUEsc0NBQ0FKLEVBQUFLLFdBQUFDLGFBQUFQLEVBQUFDLEtBQ0FPLFNBQUEsU0FBQSxxQkNyQkE5QyxRQUFBQyxPQUFBLGNBQ0FRLFFBQUEsb0JBQUEsaUJBQUEsU0FBQXNDLEVBQUFDLEdBQ0FELEVBQUFFLFdBQUEsR0FFQUQsRUFFQUUsS0FBQSxLQUNBQyxZQUFBLDJCQUNBQyxXQUFBLGlCQUNBQyxhQUFBLFNBR0FILEtBQUEsV0FDQUMsWUFBQSwrQkFDQUMsV0FBQSxxQkFDQUMsYUFBQSxhQUdBSCxLQUFBLG9CQUNBQyxZQUFBLGtDQUNBQyxXQUFBLHVCQUNBQyxhQUFBLFdBR0FILEtBQUEsc0JBQ0FDLFlBQUEsc0NBQ0FDLFdBQUEscUJBQ0FDLGFBQUEsYUFHQUgsS0FBQSx3QkFDQUMsWUFBQSx3Q0FDQUMsV0FBQSx1QkFDQUMsYUFBQSxlQUdBSCxLQUFBLDBCQUNBQyxZQUFBLHdDQUNBQyxXQUFBLHFCQUNBQyxhQUFBLGVBR0FILEtBQUEsVUFDQUMsWUFBQSxpQ0FDQUMsV0FBQSxrQkFDQUMsYUFBQSxVQUdBSCxLQUFBLE9BQ0FDLFlBQUEsOEJBQ0FDLFdBQUEsb0JBQ0FDLGFBQUEsVUNuREFyRCxRQUFBQyxPQUFBLGNBRUFtRCxXQUFBLHNCQUFBLGNBQUEsZ0JBQUEsWUFBQSxTQUFBRSxFQUFBQyxFQUFBQyxHQUNBLEdBQUFDLEdBQUFDLElBR0FELEdBQUFFLFlBQUEsRUFHQUwsRUFBQU0sTUFBQUMsUUFBQSxTQUFBQyxHQUVBTCxFQUFBRSxZQUFBLEVBR0FGLEVBQUFNLE9BQUFELElBSUFMLEVBQUFPLFdBQUEsU0FBQTNCLEdBQ0FvQixFQUFBRSxZQUFBLEVBRUFMLEVBQUFBLFVBQUFqQixHQUFBd0IsUUFBQSxTQUFBQyxHQUNBUixFQUFBTSxNQUFBQyxRQUFBLFNBQUFDLEdBQ0FMLEVBQUFFLFlBQUEsRUFDQUYsRUFBQU0sT0FBQUQsT0FLQUwsRUFBQVEsUUFBQSxXQUNBUixFQUFBRSxZQUFBLEVBRUFMLEVBQUFZLFFBQ0FDLEtBQUEsYUFDQU4sUUFBQSxTQUFBQyxHQUNBTixFQUFBWSxLQUFBLGVBQUFOLEVBQUFPLEtBQUFDLFFBSUFiLEVBQUFjLFFBQUEsU0FBQUYsR0FDQSxHQUFBRyxHQUFBaEIsRUFBQWlCLFNBQUEsSUFBQUosRUFBQUMsR0FDQWYsR0FBQWdCLFFBQUFDLE9BS0FwQixXQUFBLHdCQUFBLFNBQUEsWUFBQSxhQUFBLGVBQUEsWUFBQSxjQUFBLGNBQUEsU0FBQXNCLEVBQUFsQixFQUFBakMsRUFBQW9ELEVBQUFDLEVBQUF0QixFQUFBN0IsR0EwREEsUUFBQUssTUFJQSxRQUFBK0MsR0FBQUMsRUFBQUMsRUFBQUMsR0FDQUosRUFBQUssTUFDQUMsWUFBQUgsRUFDQUkscUJBQUEsRUFDQWhDLFlBQUEsZ0NBQ0FpQyxRQUNBTixNQUFBQSxHQUVBMUIsV0FBQWlDLEVBQ0FoQyxhQUFBLFlBQ0FpQyxLQUFBLFNBQUFDLEdBQ0FqQyxFQUFBa0MsV0FBQS9CLEVBQUFZLEtBQUFDLEtBQ0FpQixRQUFBQSxFQUNBUCxRQUFBQSxJQUNBbkIsUUFBQSxTQUFBNEIsR0FDQWhDLEVBQUFZLEtBQUFxQixTQUFBQyxLQUFBRixPQUtBLFFBQUFKLEdBQUFQLEVBQUFGLEdBQ0EsR0FBQWdCLEdBQUFsQyxJQUNBa0MsR0FBQUwsUUFBQSxHQUNBSyxFQUFBZCxNQUFBQSxFQUVBYyxFQUFBQyxZQUFBLFdBQ0FqQixFQUFBa0IsVUFHQUYsRUFBQUcsT0FBQSxXQUNBLElBQUFILEVBQUFMLFFBQUFTLE9BQ0FwQixFQUFBa0IsU0FFQWxCLEVBQUFxQixLQUFBTCxFQUFBTCxVQTlGQSxHQUFBOUIsR0FBQUMsSUFDQUQsR0FBQVksUUFDQXZDLElBR0F3QixFQUFBNEMsSUFBQXZCLEVBQUF3QixTQUFBdEMsUUFBQSxTQUFBQyxHQUNBTCxFQUFBWSxLQUFBUCxFQUVBTCxFQUFBWSxLQUFBK0IsWUFEQTdFLEVBQUFJLE1BQUFKLEVBQUFJLEtBQUEwRSxnQkFBQUMsUUFBQTdDLEVBQUFZLEtBQUFDLE1BQUEsR0FDQSxHQUVBLElBS0FiLEVBQUE4QyxNQUFBLFNBQUE1RSxFQUFBb0QsR0FDQSxHQUFBeUIsR0FBQSxJQUFBN0UsRUFBQThFLFFBQ0E1QixHQUFBMkIsRUFBQXpCLEVBQUFwRCxFQUFBMkMsTUFHQWIsRUFBQWlELFFBQUEsV0FDQSxJQUFBbkYsRUFBQUksS0FBQSxDQUNBLEdBQUFnRixHQUFBbkQsRUFBQW9ELEtBQ0EsT0FBQXBELEdBQUFZLEtBQUEsVUFBQXlDLFFBQ0FGLFVBQUFBLElBSUFsRixFQUFBaUYsUUFBQWpELEVBQUFZLEtBQUFDLEtBQUFnQixLQUFBLFNBQUF4QixHQUNBZ0QsUUFBQUMsSUFBQSx1QkFBQWpELEdBRUFBLEVBQUFELFVBQ0FKLEVBQUFZLEtBQUErQixhQUFBLE1BS0EzQyxFQUFBdUQscUJBQUEsU0FBQUMsRUFBQWxDLEdBQ0EsTUFBQWtDLEdBQUEsSUFBQUEsRUFBQWpCLFFBR0FwQixFQUFBSyxNQUNBQyxZQUFBSCxFQUNBSSxxQkFBQSxFQUNBK0IsU0FBQSx3RkFHQTlELFlBQUEsU0FBQSxTQUFBc0IsR0FDQUEsRUFBQXlDLE1BQUFGLE9BS0F4RCxFQUFBMkQsV0FBQSxTQUFBckMsR0FDQUYsRUFBQSxVQUFBRSxFQUFBLE9DOEtRTSxFQUFrQmdDLFNBQVcsUUFBUyxnQkRoSTlDakUsV0FBQSx3QkFBQSxZQUFBLGNBQUEsU0FBQUksRUFBQUYsR0FDQSxHQUFBRyxHQUFBQyxJQUVBRCxHQUFBWSxNQUNBRixLQUFBLFlBR0FWLEVBQUE2RCxLQUFBLFdBQ0E3RCxFQUFBRSxZQUFBLEVBRUFMLEVBQUFZLE9BQUFULEVBQUFZLE1BQUFSLFFBQUEsU0FBQUMsR0FDQU4sRUFBQVksS0FBQSxlQUFBTixFQUFBTyxLQUFBQyxXQXFCQWxCLFdBQUEsc0JBQUEsZUFBQSxjQUFBLFlBQUEsU0FBQXVCLEVBQUFyQixFQUFBRSxHQXNDQSxRQUFBMUIsS0FDQTJCLEVBQUE4RCxTQUFBLEdBQ0E5RCxFQUFBK0QsZUFBQSxHQUNBL0QsRUFBQWdFLFFBQUEsR0FDQWhFLEVBQUFFLFlBQUEsRUF6Q0EsR0FBQUYsR0FBQUMsSUFDQTVCLEtBR0F3QixFQUFBNEMsSUFBQXZCLEVBQUF3QixTQUFBdEMsUUFBQSxTQUFBQyxHQUNBTCxFQUFBWSxLQUFBUCxJQUdBTCxFQUFBaUUsZUFBQSxXQUNBakUsRUFBQVksS0FBQXNELGFBQUFoQyxLQUFBbEMsRUFBQStELGdCQUNBL0QsRUFBQStELGVBQUEsSUFHQS9ELEVBQUFtRSxrQkFBQSxTQUFBQyxHQUNBcEUsRUFBQVksS0FBQXNELGFBQUFHLE9BQUFELEVBQUEsSUFHQXBFLEVBQUFzRSxTQUFBLFdBQ0FqQixRQUFBQyxJQUFBLGFBQUF0RCxFQUFBOEQsVUFDQTlELEVBQUFZLEtBQUEyRCxPQUFBckMsS0FBQWxDLEVBQUE4RCxVQUNBVCxRQUFBQyxJQUFBLFFBQUF0RCxFQUFBWSxNQUNBWixFQUFBOEQsU0FBQSxJQUdBOUQsRUFBQXdFLFlBQUEsU0FBQUosR0FDQXBFLEVBQUFZLEtBQUEyRCxPQUFBRixPQUFBRCxFQUFBLElBR0FwRSxFQUFBNkQsS0FBQSxXQUNBN0QsRUFBQUUsWUFBQSxFQUVBTCxFQUFBNEUsT0FBQXZELEVBQUF3QixRQUFBMUMsRUFBQVksTUFBQVIsUUFBQSxTQUFBQyxHQUNBaEMsSUFDQTJCLEVBQUFnRSxRQUFBM0QsRUFBQTJELGNFck5BekgsUUFBQUMsT0FBQSxjQUNBbUQsV0FBQSxrQkFBQSxjQUFBLFlBQUEsU0FBQUUsRUFBQTVCLEdBSUEsUUFBQUksS0FDQTJCLEVBQUEwRSxlQUNBQyxJQUdBLFFBQUFBLEtBQ0E5RSxFQUFBK0UsTUFBQTNHLEVBQUFsQixjQUFBcUQsUUFBQSxTQUFBRSxHQUNBL0QsUUFBQXNJLFFBQUF2RSxFQUFBLFNBQUFNLEVBQUF3RCxHQUNBLEdBQUFVLElBQ0FDLE1BQUFuRSxFQUFBb0UsU0FDQTNELE1BQUFULEVBQUFGLEtBQ0E5QixHQUFBZ0MsRUFBQUMsSUFDQW9FLFNBQUFyRSxFQUFBcUUsU0FDQUMsVUFBQXRFLEVBQUFzRSxVQUNBQyxXQUFBdkUsRUFBQXVFLFdBQ0FDLEtBQUF4RSxFQUFBd0UsS0FDQUMsTUFDQUMsSUFBQSxFQUNBQyxJQUFBLEdBSUEsUUFBQW5CLEVBQUEsR0FDQSxJQUFBLEdBQ0FVLEVBQUFPLEtBQUFDLElBQUFSLEVBQUFPLEtBQUFFLElBQUEsQ0FDQSxNQUNBLEtBQUEsR0FDQSxJQUFBLEdBQ0EsS0FDQSxLQUFBLEdBQ0FULEVBQUFPLEtBQUFFLElBQUEsQ0FDQSxLQUFBLEdBQ0EsSUFBQSxHQUNBLEtBQ0EsS0FBQSxHQUNBVCxFQUFBTyxLQUFBQyxJQUFBUixFQUFBTyxLQUFBRSxJQUFBLENBQ0EsS0FBQSxHQUNBLElBQUEsR0FDQSxLQUNBLEtBQUEsSUFDQVQsRUFBQU8sS0FBQUUsSUFBQSxFQU9BdkYsRUFBQTBFLFlBQUF4QyxLQUFBNEMsT0FsREEsR0FBQTlFLEdBQUFDLElBQ0E1QixRQ0hBOUIsUUFBQUMsT0FBQSxjQUNBbUQsV0FBQSxrQkFBQSxhQUFBLFlBQUEsWUFBQSxRQUFBLGlCQUFBLGNBQUEsWUFBQSxTQUFBN0IsRUFBQWlDLEVBQUFvQixFQUFBcUUsRUFBQUMsRUFBQXpILEVBQUFDLEdBd0VBLFFBQUF5SCxHQUFBeEgsR0FDQSxHQUFBeUgsR0FBQUgsRUFBQUksU0FBQUMsUUFBQUMsT0FBQSxTQUNBTCxHQUFBTSxTQUFBOUgsRUFBQW5CLGtCQUFBNkksR0FDQXhFLEVBQUFxQixLQUFBdEUsR0FHQSxRQUFBRyxLQUNBMkIsRUFBQWdHLGdCQUFBLEVBQ0FoRyxFQUFBaUcsTUFBQSxHQUNBakcsRUFBQWtHLFNBQUEsR0FDQWxHLEVBQUFnRCxTQUFBLEVBRUEsSUFBQW1ELEdBQUFWLEVBQUFXLFNBQUFuSSxFQUFBbkIsa0JBQ0FxSixLQUNBWCxFQUFBSSxTQUFBQyxRQUFBQyxPQUFBLFVBQUFLLEVBQ0FuSSxFQUFBeUUsTUFBQVosS0FBQSxTQUFBM0QsR0FDQUosRUFBQXVJLFlBQUFuSSxLQXZGQSxHQUFBOEIsR0FBQUMsSUFDQTVCLEtBRUEyQixFQUFBc0csaUJBQUEsV0FDQXRHLEVBQUFnRyxnQkFBQWhHLEVBQUFnRyxnQkFHQWhHLEVBQUF1RyxnQkFBQSxTQUFBQyxHQUNBckYsRUFBQUssTUFDQUUscUJBQUEsRUFDQWhDLFlBQUEsOEJBQ0ErQixZQUFBK0UsRUFDQTdHLFdBQUEsaUJBQ0FDLGFBQUEsU0FDQWlDLEtBQUEsU0FBQTNELEdBQ0FKLEVBQUF1SSxZQUFBbkksS0FJQThCLEVBQUF5RyxRQUFBLFdBQ0FySSxHQUFBc0ksTUFBQSxTQUFBQyxHQUNBLGNBQUFBLEVBQUFDLE9BRUF4SSxHQUFBeUksSUFBQSxNQUFBLFNBQUFGLEdBQ0EsR0FBQUcsSUFDQTlELFNBQUEyRCxFQUFBakcsS0FDQXVGLE1BQUFVLEVBQUFWLE1BQ0FDLFNBQUFqSSxFQUFBcEIsWUFDQTJHLFNBQUEsNkJBQUFtRCxFQUFBL0gsR0FBQSxzQkFDQW1JLGFBQUE5SSxFQUFBdEIsU0FFQXFCLEdBQUFnSixZQUFBRixHQUFBakYsS0FBQSxTQUFBM0QsR0FDQUEsRUFBQStJLFVBQUFoSixFQUFBdEIsU0FDQStJLEVBQUF4SCxPQUlBLG1CQUFBeUksRUFBQUMsU0FPQU0sTUFBQSwwQkFJQWxILEVBQUEwRyxNQUFBLFdBQ0ExSSxFQUFBMEksTUFBQTFHLEVBQUFpRyxNQUFBakcsRUFBQWtHLFVBQUFyRSxLQUFBLFNBQUEzRCxHQUNBQSxFQUFBK0ksVUFBQWhKLEVBQUFyQixNQUNBOEksRUFBQXhILE1BSUE4QixFQUFBbUgsT0FBQSxXQUNBLEdBQUFDLElBQ0FwRSxTQUFBaEQsRUFBQWdELFNBQ0FpRCxNQUFBakcsRUFBQWlHLE1BQ0FDLFNBQUFsRyxFQUFBa0csU0FDQTFDLFNBQUEsa0NBQUE2RCxJQUFBQyxXQUFBdEgsRUFBQWlHLE9BQ0FjLGFBQUE5SSxFQUFBckIsTUFHQW9CLEdBQUF5QyxPQUFBMkcsR0FBQXZGLEtBQUEsU0FBQTNELEdBQ0FBLEVBQUErSSxVQUFBaEosRUFBQXJCLE1BQ0E4SSxFQUFBeEgsU0NwRUEzQixRQUFBQyxPQUFBLGNBQ0FtRCxXQUFBLHFCQUFBLFlBQUEsYUFBQSxjQUFBLFNBQUFJLEVBQUFqQyxFQUFBRSxHQVVBLFFBQUFLLEtBQ0EyQixFQUFBOUIsUUFDQUYsRUFBQXlFLE1BQUFaLEtBQUEsU0FBQTNELEdBQ0E4QixFQUFBOUIsS0FBQUEsSUFaQSxHQUFBOEIsR0FBQUMsSUFDQTVCLEtBRUEyQixFQUFBdUgsT0FBQSxXQUNBdkosRUFBQXVKLFNBQ0F6SixFQUFBdUksWUFBQSxLQUNBdEcsRUFBQVksS0FBQSxTQ1JBcEUsUUFBQUMsT0FBQSxjQUNBZ0wsVUFBQSxrQkFBQSxXQUNBLE9BQ0FDLFFBQUEsVUFDQUMsU0FBQSxJQUNBQyxLQUFBLFNBQUFULEVBQUFVLEVBQUFDLEVBQUFDLEdBQ0FBLEVBQUFDLFFBQUEsV0FDQUgsRUFBQUksS0FBQUYsRUFBQUcsWUFBQSxLQUdBTCxFQUFBTSxLQUFBLE9BQUEsV0FDQWhCLEVBQUFpQixPQUFBLFdBQ0FMLEVBQUFNLGNBQUFSLEVBQUFJLGdCQ1pBekwsUUFBQUMsT0FBQSxjQUNBZ0wsVUFBQSxVQUFBLFdBQ0EsT0FDQUUsU0FBQSxJQUNBUixPQUNBbUIsV0FBQSxZQUVBVixLQUFBLFNBQUExRyxFQUFBcUgsR0FDQXJILEVBQUFzSCxPQUFBLGFBQUEsU0FBQUMsRUFBQUMsR0FDQUQsSUFBQUMsR0FDQUgsRUFBQSxHQUFBSSxjQ1ZBbk0sUUFBQUMsT0FBQSxjQUNBbU0sUUFBQSxlQUFBLFFBQUEsU0FBQW5ELEdBR0EsR0FBQW9ELEtBeUNBLE9BdENBQSxHQUFBekksSUFBQSxXQUNBLE1BQUFxRixHQUFBL0MsSUFBQSxnQkFJQW1HLEVBQUFoRSxNQUFBLFNBQUFpRSxHQUNBLE1BQUFyRCxHQUFBL0MsSUFBQSxxQkFBQW9HLElBSUFELEVBQUFuSSxPQUFBLFNBQUFHLEdBQ0EsTUFBQTRFLEdBQUFzRCxLQUFBLGNBQUFsSSxJQUlBZ0ksRUFBQW5HLElBQUEsU0FBQUMsR0FDQSxNQUFBOEMsR0FBQS9DLElBQUEsZUFBQUMsSUFJQWtHLEVBQUFuRSxPQUFBLFNBQUEvQixFQUFBOUIsR0FDQSxNQUFBNEUsR0FBQXVELElBQUEsZUFBQXJHLEVBQUE5QixJQUlBZ0ksRUFBQUEsVUFBQSxTQUFBbEcsR0FDQSxNQUFBOEMsR0FBQUEsVUFBQSxlQUFBOUMsSUFJQWtHLEVBQUE3RyxXQUFBLFNBQUFXLEVBQUFWLEdBQ0EsTUFBQXdELEdBQUFzRCxLQUFBLGVBQUFwRyxFQUFBLFlBQUFWLElBSUE0RyxFQUFBSSxnQkFBQSxXQUNBLE9BQUEsS0FBQSxLQUFBLEtBQUEsS0FBQSxPQUVBSixLQzdDQXJNLFFBQUFDLE9BQUEsY0FDQW1NLFFBQUEsa0JBQUEsVUFBQSxTQUFBNUssR0FDQSxHQUFBa0wsS0FlQSxPQWJBQSxHQUFBN0MsU0FBQSxTQUFBOEMsR0FDQSxHQUFBbkwsRUFBQW9MLGFBQUEsQ0FDQSxHQUFBOUksR0FBQXRDLEVBQUFvTCxhQUFBQyxRQUFBRixFQUVBLE9BQUEzTSxTQUFBOE0sU0FBQWhKLEdBRUEsT0FBQSxHQUdBNEksRUFBQWxELFNBQUEsU0FBQW1ELEVBQUE3SSxHQUNBLE1BQUF0QyxHQUFBb0wsY0FBQXBMLEVBQUFvTCxhQUFBRyxRQUFBSixFQUFBM00sUUFBQWdOLE9BQUFsSixLQUdBNEksS0NqQkExTSxRQUFBQyxPQUFBLGNBQ0FtTSxRQUFBLGdCQUFBLFdBQ0EsR0FBQWEsS0FTQSxPQVBBQSxHQUFBMUksUUFBQSxTQUFBNkcsR0FDQXZKLEdBQUFxTCxJQUNBQyxPQUFBLFFBQ0FDLEtBQUFoQyxHQUNBLFNBQUFoQixPQUdBNkMsSUNYQWpOLFFBQUFDLE9BQUEsY0FDQW1NLFFBQUEsZUFBQSxRQUFBLGFBQUEsVUFBQSxZQUFBLFNBQUFuRCxFQUFBMUgsRUFBQUMsRUFBQUUsR0FDQSxHQUFBMkwsS0F5RkEsT0F2RkFBLEdBQUE1QyxZQUFBLFNBQUE2QyxHQUdBLE1BRkF4RyxTQUFBQyxJQUFBLGVBQUF1RyxHQUVBRCxFQUFBRSxTQUFBLFNBQUFELEVBQUE1RCxPQUFBcEUsS0FBQSxTQUFBeEIsR0FFQSxHQUFBQSxFQUFBRCxRQUdBLENBR0EsR0FBQWxDLEdBQUFtQyxFQUFBMEosTUFBQSxFQUNBLE9BQUE3TCxHQUFBNkksYUFBQWxFLFFBQUFnSCxFQUFBOUMsY0FBQSxHQUNBN0ksRUFBQTZJLGFBQUE3RSxLQUFBMkgsRUFBQTlDLGNBQ0E3SSxFQUFBOEUsU0FBQTZHLEVBQUE3RyxTQUNBOUUsRUFBQXNGLFNBQUFxRyxFQUFBckcsU0FFQW9HLEVBQUFuRixPQUFBdkcsR0FBQTJELEtBQUEsV0FDQSxNQUFBK0gsR0FBQWxELE1BQUF4SSxFQUFBK0gsTUFBQWhJLEVBQUFwQixnQkFHQStNLEVBQUFsRCxNQUFBeEksRUFBQStILE1BQUFoSSxFQUFBcEIsYUFkQSxNQUFBK00sR0FBQW5KLE9BQUFvSixNQXFCQUQsRUFBQWxELE1BQUEsU0FBQVQsRUFBQUMsR0FFQSxNQUFBVixHQUFBc0QsS0FBQSxhQUNBN0MsTUFBQUEsRUFDQUMsU0FBQUEsSUFDQXJFLEtBQUEsU0FBQThFLEdBRUEsTUFEQW5CLEdBQUFJLFNBQUFDLFFBQUFDLE9BQUEsVUFBQWEsRUFBQXRHLEtBQ0F1SixFQUFBbkgsU0FLQW1ILEVBQUFyQyxPQUFBLGlCQUNBL0IsR0FBQUksU0FBQUMsUUFBQUMsT0FBQSxVQUNBL0gsRUFBQW9MLGFBQUFhLFdBQUEvTCxFQUFBbkIsb0JBSUE4TSxFQUFBbkgsSUFBQSxXQUNBLE1BQUErQyxHQUFBL0MsSUFBQSxpQkFBQVosS0FBQSxTQUFBOEUsR0FDQSxNQUFBQSxHQUFBdEcsUUFLQXVKLEVBQUFFLFNBQUEsU0FBQUcsR0FDQSxNQUFBekUsR0FBQS9DLElBQUEsY0FBQXdILEdBQUFwSSxLQUFBLFNBQUE4RSxHQUNBLE1BQUFBLEdBQUF0RyxRQUtBdUosRUFBQU0sUUFBQSxTQUFBQyxHQUNBLE1BQUEzRSxHQUFBL0MsSUFBQSxjQUFBMEgsR0FBQXRJLEtBQUEsU0FBQThFLEdBQ0EsTUFBQUEsR0FBQXRHLFFBS0F1SixFQUFBbkosT0FBQSxTQUFBdkMsR0FDQSxNQUFBc0gsR0FBQXNELEtBQUEsY0FBQTVLLEdBQUEyRCxLQUFBLFdBQ0EsTUFBQStILEdBQUFsRCxNQUFBeEksRUFBQStILE1BQUEvSCxFQUFBZ0ksYUFLQTBELEVBQUFuRixPQUFBLFNBQUEwRixFQUFBak0sR0FDQSxNQUFBc0gsR0FBQXVELElBQUEsY0FBQW9CLEVBQUFqTSxHQUFBMkQsS0FBQSxTQUFBOEUsR0FDQSxNQUFBQSxHQUFBdEcsUUFLQXVKLEVBQUEzRyxRQUFBLFNBQUFQLEdBQ0EsTUFBQThDLEdBQUF1RCxJQUFBLGNBQUFqTCxFQUFBSSxLQUFBMkMsSUFBQSxXQUFBNkIsR0FBQWIsS0FBQSxTQUFBOEUsR0FDQSxNQUFBQSxHQUFBdEcsUUFJQXVKIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCdzcGljeVRhc3RlJywgWyduZ1JvdXRlJywgJ2FuZ3VsYXItbWQ1JywgJ25nTWF0ZXJpYWwnLCAnbmdBbmltYXRlJywgJ25nTWVzc2FnZXMnXSlcbiAgICAuY29uc3RhbnQoJ0NPTlNUQU5UUycsIHtcbiAgICAgICAgXCJGQl9BUFBfSURcIjogMTU2MzU2NzM4NzI1MzQ2OCxcbiAgICAgICAgXCJGQUNFQk9PS1wiOiBcIkZCXCIsXG4gICAgICAgIFwiRU1BSUxcIjogXCJFTUFJTFwiLFxuICAgICAgICBcIlNPQ0lBTF9QQVNTXCI6IFwiUEFTU1dPUkRcIixcbiAgICAgICAgXCJMT0NBTF9TVE9SQUdFX0tFWVwiOiBcInNwaWN5VGFzdGVVc2VyXCIsXG4gICAgICAgIFwiTEFURVNUX0NPVU5UXCI6IDEwXG4gICAgfSk7XG4iLCJhbmd1bGFyLm1vZHVsZSgnc3BpY3lUYXN0ZScpXG4gICAgLmNvbmZpZyhmdW5jdGlvbigkbWRUaGVtaW5nUHJvdmlkZXIsICRtZEljb25Qcm92aWRlcikge1xuXG4gICAgICAgIHZhciBwcmltYXJ5T3JhbmdlID0gJG1kVGhlbWluZ1Byb3ZpZGVyLmV4dGVuZFBhbGV0dGUoJ2RlZXAtb3JhbmdlJywge1xuICAgICAgICAgICAgJzUwMCc6ICdmMjcyNDInXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHZhciBwcmltYXJ5Qmx1ZSA9ICRtZFRoZW1pbmdQcm92aWRlci5leHRlbmRQYWxldHRlKCdibHVlJywge1xuICAgICAgICAgICAgJzUwMCc6ICc2OTg0YjQnLFxuICAgICAgICAgICAgJzYwMCc6ICc2OTg0YjQnXG4gICAgICAgIH0pO1xuXG4gICAgICAgICRtZFRoZW1pbmdQcm92aWRlci5kZWZpbmVQYWxldHRlKCdwcmltYXJ5T3JhbmdlJywgcHJpbWFyeU9yYW5nZSk7XG4gICAgICAgICRtZFRoZW1pbmdQcm92aWRlci5kZWZpbmVQYWxldHRlKCdwcmltYXJ5Qmx1ZScsIHByaW1hcnlCbHVlKTtcblxuICAgICAgICAkbWRUaGVtaW5nUHJvdmlkZXIudGhlbWUoJ2RlZmF1bHQnKVxuICAgICAgICAgICAgLnByaW1hcnlQYWxldHRlKCdwcmltYXJ5T3JhbmdlJylcbiAgICAgICAgICAgIC5hY2NlbnRQYWxldHRlKCdsaWdodC1ncmVlbicpO1xuXG4gICAgICAgICRtZFRoZW1pbmdQcm92aWRlci50aGVtZSgnYmx1ZScpXG4gICAgICAgICAgICAucHJpbWFyeVBhbGV0dGUoJ3ByaW1hcnlCbHVlJyk7XG5cbiAgICAgICAgJG1kSWNvblByb3ZpZGVyLmljb24oJ21lbnUnLCAnc3ZnL2ljX21lbnVfMjRweC5zdmcnKVxuICAgICAgICAgICAgLmljb24oJ3NoYXJlJywgJ3N2Zy9pY19zaGFyZV80OHB4LnN2ZycpXG4gICAgICAgICAgICAuaWNvbignbG9naW4nLCAnc3ZnL2ljX2FjY291bnRfY2lyY2xlXzI0cHguc3ZnJylcbiAgICAgICAgICAgIC5pY29uKCdyZWNpcGVzJywgJ3N2Zy9pY19ldmVudF9ub3RlXzQ4cHguc3ZnJylcbiAgICAgICAgICAgIC5pY29uKCdyZXN0YXVyYW50cycsICdzdmcvaWNfcmVzdGF1cmFudF9tZW51XzQ4cHguc3ZnJylcbiAgICAgICAgICAgIC5pY29uKCdpbmdyZWRpZW50cycsICdzdmcvaWNfcmVjZWlwdF80OHB4LnN2ZycpXG4gICAgICAgICAgICAuaWNvbignYXJyb3cnLCAnc3ZnL2ljX2Fycm93X2Ryb3BfdXBfNDhweC5zdmcnKVxuICAgICAgICAgICAgLmljb24oJ21vcmUnLCAnc3ZnL2ljX21vcmVfMjRweC5zdmcnKVxuICAgICAgICAgICAgLmljb24oJ3RpbWUxJywgJ3N2Zy9pY19hdl90aW1lcl8yNHB4LnN2ZycpXG4gICAgICAgICAgICAuaWNvbigndGltZTInLCAnc3ZnL2ljX2FjY2Vzc190aW1lXzI0cHguc3ZnJylcbiAgICAgICAgICAgIC5pY29uKCdkaWZmaWN1bHR5JywgJ3N2Zy9pY190cmFja19jaGFuZ2VzXzI0cHguc3ZnJylcbiAgICAgICAgICAgIC5pY29uKCdleGl0JywgJ3N2Zy9pY19leGl0X3RvX2FwcF80OHB4LnN2ZycpXG4gICAgICAgICAgICAuaWNvbigncGhvdG8nLCAnc3ZnL2ljX21tc18yNHB4LnN2ZycpXG4gICAgICAgICAgICAuaWNvbignY2hlY2snLCAnc3ZnL2ljX2NoZWNrX2NpcmNsZV8yNHB4LnN2ZycpXG4gICAgICAgICAgICAuaWNvbignZmFjZWJvb2snLCAnc3ZnL2ZhY2Vib29rLnN2ZycpXG4gICAgICAgICAgICAuaWNvbigndHdpdHRlcicsICdzdmcvdHdpdHRlci5zdmcnKVxuICAgICAgICAgICAgLmljb24oJ3BpbnRlcmVzdCcsICdzdmcvcGludGVyZXN0LnN2ZycpXG4gICAgICAgICAgICAuaWNvbignY29tbWVudHMnLCAnc3ZnL2ljX2NoYXRfNDhweC5zdmcnKTtcbiAgICB9KTtcbiIsImFuZ3VsYXIubW9kdWxlKCdzcGljeVRhc3RlJylcbiAgICAucnVuKGZ1bmN0aW9uKCRyb290U2NvcGUsICR3aW5kb3csIFVzZXJTZXJ2aWNlLCBDT05TVEFOVFMpIHtcbiAgICAgICAgJHJvb3RTY29wZS51c2VyID0gbnVsbDtcblxuICAgICAgICAkd2luZG93LmZiQXN5bmNJbml0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBGQi5pbml0KHtcbiAgICAgICAgICAgICAgICBhcHBJZDogQ09OU1RBTlRTLkZCX0FQUF9JRCxcbiAgICAgICAgICAgICAgICBjb29raWU6IHRydWUsIC8vIGVuYWJsZSBjb29raWVzIHRvIGFsbG93IHRoZSBzZXJ2ZXIgdG8gYWNjZXNzIHRoZSBzZXNzaW9uXG4gICAgICAgICAgICAgICAgeGZibWw6IHRydWUsIC8vIHBhcnNlIHNvY2lhbCBwbHVnaW5zIG9uIHRoaXMgcGFnZVxuICAgICAgICAgICAgICAgIHZlcnNpb246ICd2Mi4yJyAvLyB1c2UgdmVyc2lvbiAyLjJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vIExvYWQgdGhlIFNESyBhc3luY2hyb25vdXNseVxuICAgICAgICAoZnVuY3Rpb24oZCwgcywgaWQpIHtcbiAgICAgICAgICAgIHZhciBqcywgZmpzID0gZC5nZXRFbGVtZW50c0J5VGFnTmFtZShzKVswXTtcbiAgICAgICAgICAgIGlmIChkLmdldEVsZW1lbnRCeUlkKGlkKSkgcmV0dXJuO1xuICAgICAgICAgICAganMgPSBkLmNyZWF0ZUVsZW1lbnQocyk7XG4gICAgICAgICAgICBqcy5pZCA9IGlkO1xuICAgICAgICAgICAganMuc3JjID0gXCIvL2Nvbm5lY3QuZmFjZWJvb2submV0L2VuX1VTL3Nkay5qc1wiO1xuICAgICAgICAgICAgZmpzLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGpzLCBmanMpO1xuICAgICAgICB9KGRvY3VtZW50LCAnc2NyaXB0JywgJ2ZhY2Vib29rLWpzc2RrJykpO1xuICAgIH0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ3NwaWN5VGFzdGUnKVxuICAgIC5jb25maWcoZnVuY3Rpb24oJGxvY2F0aW9uUHJvdmlkZXIsICRyb3V0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRsb2NhdGlvblByb3ZpZGVyLmh0bWw1TW9kZSh0cnVlKTtcblxuICAgICAgICAkcm91dGVQcm92aWRlclxuICAgICAgICAvL2hvbWUgcGFnZVxuICAgICAgICAgICAgLndoZW4oJy8nLCB7XG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICduZy92aWV3cy9wYWdlcy9ob21lLmh0bWwnLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdIb21lQ29udHJvbGxlcicsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiAnaG9tZSdcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAvL3Nob3cgYWxsIGRpc2hlcyBwYWdlXG4gICAgICAgICAgICAud2hlbignL2Rpc2hlcycsIHtcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25nL3ZpZXdzL3BhZ2VzL2Rpc2gvYWxsLmh0bWwnLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdEaXNoTGlzdENvbnRyb2xsZXInLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ2Rpc2hMaXN0J1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC8vc2hvdyBkaXNoIGRldGFpbCBwYWdlXG4gICAgICAgICAgICAud2hlbignL2Rpc2hlcy86ZGlzaF9pZCcsIHtcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25nL3ZpZXdzL3BhZ2VzL2Rpc2gvZGV0YWlsLmh0bWwnLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdEaXNoRGV0YWlsQ29udHJvbGxlcicsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiAnZGV0YWlsJ1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC8vbGlzdCBhZG1pbiBkaXNoIHBhZ2VcbiAgICAgICAgICAgIC53aGVuKCcvYWRtaW4vZGlzaGVzL2xpc3QnLCB7XG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICduZy92aWV3cy9wYWdlcy9hZG1pbi9kaXNoL2xpc3QuaHRtbCcsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ0Rpc2hMaXN0Q29udHJvbGxlcicsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiAnZGlzaExpc3QnXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLy9jcmVhdGUgYSBuZXcgZGlzaCBwYWdlXG4gICAgICAgICAgICAud2hlbignL2FkbWluL2Rpc2hlcy9jcmVhdGUnLCB7XG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICduZy92aWV3cy9wYWdlcy9hZG1pbi9kaXNoL3NpbmdsZS5odG1sJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnRGlzaENyZWF0ZUNvbnRyb2xsZXInLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ2Rpc2hNYW5hZ2UnXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLy9lZGl0IGEgZGlzaCBwYWdlXG4gICAgICAgICAgICAud2hlbignL2FkbWluL2Rpc2hlcy86ZGlzaF9pZCcsIHtcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25nL3ZpZXdzL3BhZ2VzL2FkbWluL2Rpc2gvc2luZ2xlLmh0bWwnLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdEaXNoRWRpdENvbnRyb2xsZXInLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ2Rpc2hNYW5hZ2UnXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLy9sb2dpbiB1c2VyXG4gICAgICAgICAgICAud2hlbignL2xvZ2luJywge1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbmcvdmlld3MvcGFnZXMvdXNlci9sb2dpbi5odG1sJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnTG9naW5Db250cm9sbGVyJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6ICdsb2dpbidcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAvL3VzZXIgcHJvZmlsZVxuICAgICAgICAgICAgLndoZW4oJy9tZScsIHtcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25nL3ZpZXdzL3BhZ2VzL3VzZXIvbWUuaHRtbCcsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ1Byb2ZpbGVDb250cm9sbGVyJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6ICdtZSdcbiAgICAgICAgICAgIH0pXG4gICAgfSk7XG4iLCJhbmd1bGFyLm1vZHVsZSgnc3BpY3lUYXN0ZScpXG4gICAgLy9jb250cm9sbGVyIGFwcGxpZWQgdG8gZGlzaCBsaXN0IHBhZ2VcbiAgICAuY29udHJvbGxlcignRGlzaExpc3RDb250cm9sbGVyJywgZnVuY3Rpb24oRGlzaFNlcnZpY2UsIFNvY2lhbFNlcnZpY2UsICRsb2NhdGlvbikge1xuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuXG4gICAgICAgIC8vc2V0IGEgcHJvY2Vzc2luZyB2YXJpYWJsZSB0byBzaG93IGxvYWRpbmdcbiAgICAgICAgdm0ucHJvY2Vzc2luZyA9IHRydWU7XG5cbiAgICAgICAgLy9ncmFiIGFsbCB0aGUgZGlzaGVzIGF0IHBhZ2UgbG9hZFxuICAgICAgICBEaXNoU2VydmljZS5hbGwoKS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgIC8vd2hlbiBhbGwgZGlzaGVzIGZldGNoZWQsIHJlbW92ZSBwcm9jZXNzaW5nIHZhcmlhYmxlXG4gICAgICAgICAgICB2bS5wcm9jZXNzaW5nID0gZmFsc2U7XG5cbiAgICAgICAgICAgIC8vYmluZCB0aGUgZGlzaGVzXG4gICAgICAgICAgICB2bS5kaXNoZXMgPSBkYXRhO1xuICAgICAgICB9KTtcblxuICAgICAgICAvL2Z1bmN0aW9uIHRvIGRlbGV0ZSBhIGRpc2hcbiAgICAgICAgdm0uZGVsZXRlRGlzaCA9IGZ1bmN0aW9uKGlkKSB7XG4gICAgICAgICAgICB2bS5wcm9jZXNzaW5nID0gdHJ1ZTtcblxuICAgICAgICAgICAgRGlzaFNlcnZpY2UuZGVsZXRlKGlkKS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICBEaXNoU2VydmljZS5hbGwoKS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgdm0ucHJvY2Vzc2luZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB2bS5kaXNoZXMgPSBkYXRhO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgdm0uYWRkRGlzaCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdm0ucHJvY2Vzc2luZyA9IHRydWU7XG5cbiAgICAgICAgICAgIERpc2hTZXJ2aWNlLmNyZWF0ZSh7XG4gICAgICAgICAgICAgICAgbmFtZTogJ25ldyBkaXNoJ1xuICAgICAgICAgICAgfSkuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy9hZG1pbi9kaXNoLycgKyBkYXRhLmRpc2guX2lkKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgdm0uZmJTaGFyZSA9IGZ1bmN0aW9uKGRpc2gpIHtcbiAgICAgICAgICAgIHZhciBkaXNoTGluayA9ICRsb2NhdGlvbi5hYnNVcmwoKSArICcvJyArIGRpc2guX2lkO1xuICAgICAgICAgICAgU29jaWFsU2VydmljZS5mYlNoYXJlKGRpc2hMaW5rKTtcbiAgICAgICAgfVxuXG4gICAgfSlcbiAgICAvL2NvbnRyb2xsZXIgYXBwbGllZCB0byBkaXNoIGRldGFpbCBwYWdlXG4gICAgLmNvbnRyb2xsZXIoJ0Rpc2hEZXRhaWxDb250cm9sbGVyJywgZnVuY3Rpb24oJHNjb3BlLCAkbG9jYXRpb24sICRyb290U2NvcGUsICRyb3V0ZVBhcmFtcywgJG1kRGlhbG9nLCBEaXNoU2VydmljZSwgVXNlclNlcnZpY2UpIHtcbiAgICAgICAgdmFyIHZtID0gdGhpcztcbiAgICAgICAgdm0uZGlzaCA9IHt9O1xuICAgICAgICBpbml0KCk7XG5cbiAgICAgICAgLy9nZXQgdGhlIGRpc2ggYnkgaWRcbiAgICAgICAgRGlzaFNlcnZpY2UuZ2V0KCRyb3V0ZVBhcmFtcy5kaXNoX2lkKS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgIHZtLmRpc2ggPSBkYXRhO1xuICAgICAgICAgICAgaWYgKCRyb290U2NvcGUudXNlciAmJiAkcm9vdFNjb3BlLnVzZXIuZmF2b3VyaXRlRGlzaGVzLmluZGV4T2Yodm0uZGlzaC5faWQpID49IDApIHtcbiAgICAgICAgICAgICAgICB2bS5kaXNoLmlzQ29sbGVjdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdm0uZGlzaC5pc0NvbGxlY3RlZCA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHZtLnJlcGx5ID0gZnVuY3Rpb24odXNlciwgJGV2ZW50KSB7XG4gICAgICAgICAgICB2YXIgY29tbWVudFRpdGxlID0gJ0AnICsgdXNlci51c2VyTmFtZTtcbiAgICAgICAgICAgIG9wZW5Db21tZW50RGlhbG9nKGNvbW1lbnRUaXRsZSwgJGV2ZW50LCB1c2VyLl9pZCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgdm0uY29sbGVjdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgaWYgKCEkcm9vdFNjb3BlLnVzZXIpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmV0dXJuVXJsID0gJGxvY2F0aW9uLnVybCgpO1xuICAgICAgICAgICAgICAgIHJldHVybiAkbG9jYXRpb24ucGF0aCgnL2xvZ2luJykuc2VhcmNoKHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuVXJsOiByZXR1cm5VcmxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgVXNlclNlcnZpY2UuY29sbGVjdCh2bS5kaXNoLl9pZCkudGhlbihmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJVc2VyU2VydmljZS5jb2xsZWN0OlwiLCBkYXRhKTtcblxuICAgICAgICAgICAgICAgIGlmIChkYXRhLnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgdm0uZGlzaC5pc0NvbGxlY3RlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICB2bS5zaG93SW5zdHJ1Y3Rpb25QaG90byA9IGZ1bmN0aW9uKHBob3RvVXJsLCAkZXZlbnQpIHtcbiAgICAgICAgICAgIGlmIChwaG90b1VybCA9PSBudWxsIHx8IHBob3RvVXJsLnRyaW0oKSA9PSAnJylcbiAgICAgICAgICAgICAgICByZXR1cm47XG5cbiAgICAgICAgICAgICRtZERpYWxvZy5zaG93KHtcbiAgICAgICAgICAgICAgICB0YXJnZXRFdmVudDogJGV2ZW50LFxuICAgICAgICAgICAgICAgIGNsaWNrT3V0c2lkZVRvQ2xvc2U6IHRydWUsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGU6ICc8bWQtZGlhbG9nPicgK1xuICAgICAgICAgICAgICAgICAgICAnICA8bWQtZGlhbG9nLWNvbnRlbnQ+PGltZyBzcmM9XCJ7e3Bob3RvfX1cIj48L21kLWRpYWxvZy1jb250ZW50PicgK1xuICAgICAgICAgICAgICAgICAgICAnPC9tZC1kaWFsb2c+JyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiBmdW5jdGlvbiBEaWFsb2dDdHIoJHNjb3BlKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5waG90byA9IHBob3RvVXJsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgdm0ubmV3Q29tbWVudCA9IGZ1bmN0aW9uKCRldmVudCkge1xuICAgICAgICAgICAgb3BlbkNvbW1lbnREaWFsb2coJ0NvbW1lbnQnLCAkZXZlbnQsIG51bGwpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gaW5pdCgpIHtcblxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gb3BlbkNvbW1lbnREaWFsb2codGl0bGUsICRldmVudCwgcmVwbHlUbykge1xuICAgICAgICAgICAgJG1kRGlhbG9nLnNob3coe1xuICAgICAgICAgICAgICAgIHRhcmdldEV2ZW50OiAkZXZlbnQsXG4gICAgICAgICAgICAgICAgY2xpY2tPdXRzaWRlVG9DbG9zZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25nL3ZpZXdzL2RpYWxvZ3MvY29tbWVudC5odG1sJyxcbiAgICAgICAgICAgICAgICBsb2NhbHM6IHtcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IHRpdGxlXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiBjb21tZW50Q29udHJvbGxlcixcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6ICdjb21tZW50J1xuICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbihjb250ZW50KSB7XG4gICAgICAgICAgICAgICAgRGlzaFNlcnZpY2UuYWRkQ29tbWVudCh2bS5kaXNoLl9pZCwge1xuICAgICAgICAgICAgICAgICAgICBjb250ZW50OiBjb250ZW50LFxuICAgICAgICAgICAgICAgICAgICByZXBseVRvOiByZXBseVRvXG4gICAgICAgICAgICAgICAgfSkuc3VjY2VzcyhmdW5jdGlvbihjb21tZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIHZtLmRpc2guY29tbWVudHMucHVzaChjb21tZW50KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gY29tbWVudENvbnRyb2xsZXIodGl0bGUsICRtZERpYWxvZykge1xuICAgICAgICAgICAgdmFyIGR2bSA9IHRoaXM7XG4gICAgICAgICAgICBkdm0uY29udGVudCA9ICcnO1xuICAgICAgICAgICAgZHZtLnRpdGxlID0gdGl0bGU7XG5cbiAgICAgICAgICAgIGR2bS5jbG9zZURpYWxvZyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICRtZERpYWxvZy5jYW5jZWwoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZHZtLnN1Ym1pdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIGlmIChkdm0uY29udGVudC50cmltKCkgPT0gJycpXG4gICAgICAgICAgICAgICAgICAgICRtZERpYWxvZy5jYW5jZWwoKVxuICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgJG1kRGlhbG9nLmhpZGUoZHZtLmNvbnRlbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSlcbiAgICAvL2NvbnRyb2xsZXIgYXBwbGllZCB0byBkaXNoIGNyZWF0aW9uIHBhZ2VcbiAgICAvL25vdCB1c2UgYW55bW9yZVxuICAgIC5jb250cm9sbGVyKCdEaXNoQ3JlYXRlQ29udHJvbGxlcicsIGZ1bmN0aW9uKCRsb2NhdGlvbiwgRGlzaFNlcnZpY2UpIHtcbiAgICAgICAgdmFyIHZtID0gdGhpcztcblxuICAgICAgICB2bS5kaXNoID0ge1xuICAgICAgICAgICAgbmFtZTogJ25ldyBkaXNoJ1xuICAgICAgICB9O1xuXG4gICAgICAgIHZtLnNhdmUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZtLnByb2Nlc3NpbmcgPSB0cnVlO1xuXG4gICAgICAgICAgICBEaXNoU2VydmljZS5jcmVhdGUodm0uZGlzaCkuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy9hZG1pbi9kaXNoLycgKyBkYXRhLmRpc2guX2lkKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG5cblxuICAgICAgICBmdW5jdGlvbiBpbml0KCkge1xuICAgICAgICAgICAgdm0udHlwZSA9ICdjcmVhdGUnO1xuICAgICAgICAgICAgdm0uZGlzaCA9IHtcbiAgICAgICAgICAgICAgICBpbnN0cnVjdGlvbnM6IFtdLFxuICAgICAgICAgICAgICAgIHBob3RvOiBbXVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHZtLm5ld0luc3RydWN0aW9uID0gJyc7XG4gICAgICAgICAgICB2bS5uZXdQaG90byA9ICcnO1xuICAgICAgICAgICAgdm0ubWVzc2FnZSA9ICcnO1xuICAgICAgICAgICAgdm0ucHJvY2Vzc2luZyA9IGZhbHNlO1xuICAgICAgICAgICAgdm0uZGlzaC5pbnN0cnVjdGlvbnMubGVuZ3RoID0gMDtcbiAgICAgICAgICAgIHZtLmRpc2gucGhvdG9zLmxlbmd0aCA9IDA7XG4gICAgICAgIH1cbiAgICB9KVxuICAgIC8vY29udHJvbGxlciBhcHBsaWVkIHRvIGRpc2ggZWRpdCBwYWdlXG4gICAgLmNvbnRyb2xsZXIoJ0Rpc2hFZGl0Q29udHJvbGxlcicsIGZ1bmN0aW9uKCRyb3V0ZVBhcmFtcywgRGlzaFNlcnZpY2UsICRsb2NhdGlvbikge1xuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuICAgICAgICBpbml0KCk7XG5cbiAgICAgICAgLy9nZXQgdGhlIGRpc2ggYnkgaWRcbiAgICAgICAgRGlzaFNlcnZpY2UuZ2V0KCRyb3V0ZVBhcmFtcy5kaXNoX2lkKS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgIHZtLmRpc2ggPSBkYXRhO1xuICAgICAgICB9KTtcblxuICAgICAgICB2bS5hZGRJbnN0cnVjdGlvbiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdm0uZGlzaC5pbnN0cnVjdGlvbnMucHVzaCh2bS5uZXdJbnN0cnVjdGlvbik7XG4gICAgICAgICAgICB2bS5uZXdJbnN0cnVjdGlvbiA9ICcnO1xuICAgICAgICB9XG5cbiAgICAgICAgdm0ucmVtb3ZlSW5zdHJ1Y3Rpb24gPSBmdW5jdGlvbihpbmRleCkge1xuICAgICAgICAgICAgdm0uZGlzaC5pbnN0cnVjdGlvbnMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZtLmFkZFBob3RvID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIm5ld1Bob3RvOiBcIiwgdm0ubmV3UGhvdG8pO1xuICAgICAgICAgICAgdm0uZGlzaC5waG90b3MucHVzaCh2bS5uZXdQaG90byk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcImRpc2g6XCIsIHZtLmRpc2gpO1xuICAgICAgICAgICAgdm0ubmV3UGhvdG8gPSAnJztcbiAgICAgICAgfVxuXG4gICAgICAgIHZtLnJlbW92ZVBob3RvID0gZnVuY3Rpb24oaW5kZXgpIHtcbiAgICAgICAgICAgIHZtLmRpc2gucGhvdG9zLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgIH1cblxuICAgICAgICB2bS5zYXZlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2bS5wcm9jZXNzaW5nID0gdHJ1ZTtcblxuICAgICAgICAgICAgRGlzaFNlcnZpY2UudXBkYXRlKCRyb3V0ZVBhcmFtcy5kaXNoX2lkLCB2bS5kaXNoKS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICBpbml0KCk7XG4gICAgICAgICAgICAgICAgdm0ubWVzc2FnZSA9IGRhdGEubWVzc2FnZTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBpbml0KCkge1xuICAgICAgICAgICAgdm0ubmV3UGhvdG8gPSAnJztcbiAgICAgICAgICAgIHZtLm5ld0luc3RydWN0aW9uID0gJyc7XG4gICAgICAgICAgICB2bS5tZXNzYWdlID0gJyc7XG4gICAgICAgICAgICB2bS5wcm9jZXNzaW5nID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9KTtcbiIsbnVsbCwiYW5ndWxhci5tb2R1bGUoJ3NwaWN5VGFzdGUnKVxuICAgIC5jb250cm9sbGVyKCdIb21lQ29udHJvbGxlcicsIGZ1bmN0aW9uKERpc2hTZXJ2aWNlLCBDT05TVEFOVFMpIHtcbiAgICAgICAgdmFyIHZtID0gdGhpcztcbiAgICAgICAgaW5pdCgpO1xuXG4gICAgICAgIGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgICAgICAgICB2bS5yZWNpcGVUaWxlcyA9IFtdO1xuICAgICAgICAgICAgYnVpbGRHcmlkKCk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBidWlsZEdyaWQoKSB7XG4gICAgICAgICAgICBEaXNoU2VydmljZS5saW1pdChDT05TVEFOVFMuTEFURVNUX0NPVU5UKS5zdWNjZXNzKGZ1bmN0aW9uKGRpc2hlcykge1xuICAgICAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChkaXNoZXMsIGZ1bmN0aW9uKGRpc2gsIGluZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0aWxlID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgaW1hZ2U6IGRpc2guaW1hZ2VVcmwsXG4gICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogZGlzaC5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IGRpc2guX2lkLFxuICAgICAgICAgICAgICAgICAgICAgICAgcHJlcFRpbWU6IGRpc2gucHJlcFRpbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICB0b3RhbFRpbWU6IGRpc2gudG90YWxUaW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGlmZmljdWx0eTogZGlzaC5kaWZmaWN1bHR5LFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnczogZGlzaC50YWdzLFxuICAgICAgICAgICAgICAgICAgICAgICAgc3Bhbjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvdzogMSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2w6IDFcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKGluZGV4ICsgMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpbGUuc3Bhbi5yb3cgPSB0aWxlLnNwYW4uY29sID0gMjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aWxlLnNwYW4uY29sID0gMjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNTpcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aWxlLnNwYW4ucm93ID0gdGlsZS5zcGFuLmNvbCA9IDI7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDg6XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDk6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDEwOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpbGUuc3Bhbi5jb2wgPSAyO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgdm0ucmVjaXBlVGlsZXMucHVzaCh0aWxlKTtcblxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgIH0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ3NwaWN5VGFzdGUnKVxuICAgIC5jb250cm9sbGVyKCdNYWluQ29udHJvbGxlcicsIGZ1bmN0aW9uKCRyb290U2NvcGUsICRsb2NhdGlvbiwgJG1kRGlhbG9nLCAkaHR0cCwgU2Vzc2lvblNlcnZpY2UsIFVzZXJTZXJ2aWNlLCBDT05TVEFOVFMpIHtcbiAgICAgICAgdmFyIHZtID0gdGhpcztcbiAgICAgICAgaW5pdCgpO1xuXG4gICAgICAgIHZtLnRvZ2dsZU1vYmlsZU1lbnUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZtLnNob3dNb2JpbGVNZW51ID0gIXZtLnNob3dNb2JpbGVNZW51O1xuICAgICAgICB9XG5cbiAgICAgICAgdm0uc2hvd0xvZ2luRGlhbG9nID0gZnVuY3Rpb24oZXYpIHtcbiAgICAgICAgICAgICRtZERpYWxvZy5zaG93KHtcbiAgICAgICAgICAgICAgICBjbGlja091dHNpZGVUb0Nsb3NlOiB0cnVlLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbmcvdmlld3MvZGlhbG9ncy9sb2dpbi5odG1sJyxcbiAgICAgICAgICAgICAgICB0YXJnZXRFdmVudDogZXYsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ01haW5Db250cm9sbGVyJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6ICdtYWluJ1xuICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbih1c2VyKSB7XG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS5jdXJyZW50VXNlciA9IHVzZXI7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICB2bS5mYkxvZ2luID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBGQi5sb2dpbihmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09ICdjb25uZWN0ZWQnKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIExvZ2dlZCBpbnRvIHlvdXIgYXBwIGFuZCBGYWNlYm9vay5cbiAgICAgICAgICAgICAgICAgICAgRkIuYXBpKCcvbWUnLCBmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZiVXNlciA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VyTmFtZTogcmVzcG9uc2UubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbWFpbDogcmVzcG9uc2UuZW1haWwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFzc3dvcmQ6IENPTlNUQU5UUy5TT0NJQUxfUEFTUyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwaG90b1VybDogJ2h0dHA6Ly9ncmFwaC5mYWNlYm9vay5jb20vJyArIHJlc3BvbnNlLmlkICsgJy9waWN0dXJlP3R5cGU9bGFyZ2UnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmtlZFNvY2lhbDogQ09OU1RBTlRTLkZBQ0VCT09LXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBVc2VyU2VydmljZS5zb2NpYWxMb2dpbihmYlVzZXIpLnRoZW4oZnVuY3Rpb24odXNlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXIubG9naW5UeXBlID0gQ09OU1RBTlRTLkZBQ0VCT09LO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFmdGVyQXV0aCh1c2VyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChyZXNwb25zZS5zdGF0dXMgPT09ICdub3RfYXV0aG9yaXplZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gVGhlIHBlcnNvbiBpcyBsb2dnZWQgaW50byBGYWNlYm9vaywgYnV0IG5vdCB5b3VyIGFwcC5cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvLyBUaGUgcGVyc29uIGlzIG5vdCBsb2dnZWQgaW50byBGYWNlYm9vaywgc28gd2UncmUgbm90IHN1cmUgaWZcbiAgICAgICAgICAgICAgICAgICAgLy8gdGhleSBhcmUgbG9nZ2VkIGludG8gdGhpcyBhcHAgb3Igbm90LlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAgICBzY29wZTogJ3B1YmxpY19wcm9maWxlLGVtYWlsJ1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICB2bS5sb2dpbiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgVXNlclNlcnZpY2UubG9naW4odm0uZW1haWwsIHZtLnBhc3N3b3JkKS50aGVuKGZ1bmN0aW9uKHVzZXIpIHtcbiAgICAgICAgICAgICAgICB1c2VyLmxvZ2luVHlwZSA9IENPTlNUQU5UUy5FTUFJTDtcbiAgICAgICAgICAgICAgICBhZnRlckF1dGgodXNlcik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZtLnNpZ25VcCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIG5ld1VzZXIgPSB7XG4gICAgICAgICAgICAgICAgdXNlck5hbWU6IHZtLnVzZXJOYW1lLFxuICAgICAgICAgICAgICAgIGVtYWlsOiB2bS5lbWFpbCxcbiAgICAgICAgICAgICAgICBwYXNzd29yZDogdm0ucGFzc3dvcmQsXG4gICAgICAgICAgICAgICAgcGhvdG9Vcmw6ICdodHRwOi8vd3d3LmdyYXZhdGFyLmNvbS9hdmF0YXIvJyArIG1kNS5jcmVhdGVIYXNoKHZtLmVtYWlsKSxcbiAgICAgICAgICAgICAgICBsaW5rZWRTb2NpYWw6IENPTlNUQU5UUy5FTUFJTFxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgVXNlclNlcnZpY2UuY3JlYXRlKG5ld1VzZXIpLnRoZW4oZnVuY3Rpb24odXNlcikge1xuICAgICAgICAgICAgICAgIHVzZXIubG9naW5UeXBlID0gQ09OU1RBTlRTLkVNQUlMO1xuICAgICAgICAgICAgICAgIGFmdGVyQXV0aCh1c2VyKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBhZnRlckF1dGgodXNlcikge1xuICAgICAgICAgICAgdmFyIHRva2VuID0gJGh0dHAuZGVmYXVsdHMuaGVhZGVycy5jb21tb25bJ1gtQXV0aCddO1xuICAgICAgICAgICAgU2Vzc2lvblNlcnZpY2Uuc2V0TG9jYWwoQ09OU1RBTlRTLkxPQ0FMX1NUT1JBR0VfS0VZLCB0b2tlbik7XG4gICAgICAgICAgICAkbWREaWFsb2cuaGlkZSh1c2VyKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgICAgICAgICB2bS5zaG93TW9iaWxlTWVudSA9IGZhbHNlO1xuICAgICAgICAgICAgdm0uZW1haWwgPSBcIlwiO1xuICAgICAgICAgICAgdm0ucGFzc3dvcmQgPSBcIlwiO1xuICAgICAgICAgICAgdm0udXNlck5hbWUgPSBcIlwiO1xuXG4gICAgICAgICAgICB2YXIgbG9naW5lZFRva2VuID0gU2Vzc2lvblNlcnZpY2UuZ2V0TG9jYWwoQ09OU1RBTlRTLkxPQ0FMX1NUT1JBR0VfS0VZKTtcbiAgICAgICAgICAgIGlmIChsb2dpbmVkVG9rZW4pIHtcbiAgICAgICAgICAgICAgICAkaHR0cC5kZWZhdWx0cy5oZWFkZXJzLmNvbW1vblsnWC1BdXRoJ10gPSBsb2dpbmVkVG9rZW47XG4gICAgICAgICAgICAgICAgVXNlclNlcnZpY2UuZ2V0KCkudGhlbihmdW5jdGlvbih1c2VyKSB7XG4gICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuY3VycmVudFVzZXIgPSB1c2VyO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICB9KTtcbiIsImFuZ3VsYXIubW9kdWxlKCdzcGljeVRhc3RlJylcbiAgICAuY29udHJvbGxlcignUHJvZmlsZUNvbnRyb2xsZXInLCBmdW5jdGlvbigkbG9jYXRpb24sICRyb290U2NvcGUsIFVzZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG4gICAgICAgIGluaXQoKTtcblxuICAgICAgICB2bS5sb2dvdXQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIFVzZXJTZXJ2aWNlLmxvZ291dCgpO1xuICAgICAgICAgICAgJHJvb3RTY29wZS5jdXJyZW50VXNlciA9IG51bGw7XG4gICAgICAgICAgICAkbG9jYXRpb24ucGF0aCgnLycpO1xuICAgICAgICB9O1xuXG4gICAgICAgIGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgICAgICAgICB2bS51c2VyID0ge307XG4gICAgICAgICAgICBVc2VyU2VydmljZS5nZXQoKS50aGVuKGZ1bmN0aW9uKHVzZXIpIHtcbiAgICAgICAgICAgICAgICB2bS51c2VyID0gdXNlcjtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICB9KTtcbiIsImFuZ3VsYXIubW9kdWxlKCdzcGljeVRhc3RlJylcbiAgICAuZGlyZWN0aXZlKCdjb250ZW50ZWRpdGFibGUnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJlcXVpcmU6ICduZ01vZGVsJyxcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICAgICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cmlidXRzLCBuZ01vZGVsKSB7XG4gICAgICAgICAgICAgICAgbmdNb2RlbC4kcmVuZGVyID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuaHRtbChuZ01vZGVsLiR2aWV3VmFsdWUgfHwgJycpO1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICBlbGVtZW50LmJpbmQoJ2JsdXInLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmdNb2RlbC4kc2V0Vmlld1ZhbHVlKGVsZW1lbnQuaHRtbCgpKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfSk7XG4iLCJhbmd1bGFyLm1vZHVsZSgnc3BpY3lUYXN0ZScpXG4gICAgLmRpcmVjdGl2ZSgnZm9jdXNPbicsIGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAgICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICAgICAgZm9jdXNWYWx1ZTogXCI9Zm9jdXNPblwiXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgbGluazogZnVuY3Rpb24oJHNjb3BlLCAkZWxlbWVudCkge1xuICAgICAgICAgICAgICAgICRzY29wZS4kd2F0Y2goJ2ZvY3VzVmFsdWUnLCBmdW5jdGlvbihjdXJyZW50VmFsdWUsIHByZXZpb3VzVmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRWYWx1ZSAmJiAhcHJldmlvdXNWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJGVsZW1lbnRbMF0uZm9jdXMoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ3NwaWN5VGFzdGUnKVxuICAgIC5mYWN0b3J5KCdEaXNoU2VydmljZScsIGZ1bmN0aW9uKCRodHRwKSB7XG5cbiAgICAgICAgLy9jcmVhdGUgYSBuZXcgb2JqZWN0XG4gICAgICAgIHZhciBkaXNoRmFjdG9yeSA9IHt9O1xuXG4gICAgICAgIC8vZ2V0IGFsbCBkaXNoZXNcbiAgICAgICAgZGlzaEZhY3RvcnkuYWxsID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL2Rpc2hlcycpO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vZ2V0IGxpbWl0ZWQgbGF0ZXN0IGRpc2hlc1xuICAgICAgICBkaXNoRmFjdG9yeS5saW1pdCA9IGZ1bmN0aW9uKG51bSkge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS9kaXNoZXM/bGltaXQ9JyArIG51bSk7XG4gICAgICAgIH1cblxuICAgICAgICAvL2NyZWF0ZSBhIGRpc2hcbiAgICAgICAgZGlzaEZhY3RvcnkuY3JlYXRlID0gZnVuY3Rpb24oZGlzaCkge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLnBvc3QoJy9hcGkvZGlzaGVzJywgZGlzaCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy9nZXQgYSBzaW5nbGUgZGlzaFxuICAgICAgICBkaXNoRmFjdG9yeS5nZXQgPSBmdW5jdGlvbihkaXNoX2lkKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL2Rpc2hlcy8nICsgZGlzaF9pZCk7XG4gICAgICAgIH1cblxuICAgICAgICAvL3VwZGF0ZSBhIGRpc2hcbiAgICAgICAgZGlzaEZhY3RvcnkudXBkYXRlID0gZnVuY3Rpb24oZGlzaF9pZCwgZGlzaCkge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLnB1dCgnL2FwaS9kaXNoZXMvJyArIGRpc2hfaWQsIGRpc2gpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9kZWxldGUgYSBkaXNoXG4gICAgICAgIGRpc2hGYWN0b3J5LmRlbGV0ZSA9IGZ1bmN0aW9uKGRpc2hfaWQpIHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5kZWxldGUoJy9hcGkvZGlzaGVzLycgKyBkaXNoX2lkKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vYWRkIGEgY29tbWVudFxuICAgICAgICBkaXNoRmFjdG9yeS5hZGRDb21tZW50ID0gZnVuY3Rpb24oZGlzaF9pZCwgY29tbWVudCkge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLnBvc3QoJy9hcGkvZGlzaGVzLycgKyBkaXNoX2lkICsgJy9jb21tZW50cycsIGNvbW1lbnQpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9nZXQgZGlmZmljdWx0eVxuICAgICAgICBkaXNoRmFjdG9yeS5nZXREaWZmaWN1bHRpZXMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiBbJ+WIneWtpicsICflrrnmmJMnLCAn5LiA6IisJywgJ+i+g+mavicsICfkuJPkuJonXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZGlzaEZhY3Rvcnk7XG4gICAgfSk7XG4iLCJhbmd1bGFyLm1vZHVsZSgnc3BpY3lUYXN0ZScpXG4gICAgLmZhY3RvcnkoJ1Nlc3Npb25TZXJ2aWNlJywgZnVuY3Rpb24oJHdpbmRvdykge1xuICAgICAgICB2YXIgc2Vzc2lvbkZhY3RvcnkgPSB7fTtcblxuICAgICAgICBzZXNzaW9uRmFjdG9yeS5nZXRMb2NhbCA9IGZ1bmN0aW9uKGtleSkge1xuICAgICAgICAgICAgaWYgKCR3aW5kb3cubG9jYWxTdG9yYWdlKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRhdGEgPSAkd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKGtleSk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gYW5ndWxhci5mcm9tSnNvbihkYXRhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHNlc3Npb25GYWN0b3J5LnNldExvY2FsID0gZnVuY3Rpb24oa2V5LCBkYXRhKSB7XG4gICAgICAgICAgICByZXR1cm4gJHdpbmRvdy5sb2NhbFN0b3JhZ2UgJiYgJHdpbmRvdy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbShrZXksIGFuZ3VsYXIudG9Kc29uKGRhdGEpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBzZXNzaW9uRmFjdG9yeTtcblxuICAgIH0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ3NwaWN5VGFzdGUnKVxuICAgIC5mYWN0b3J5KCdTb2NpYWxTZXJ2aWNlJywgZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBzb2NpYWxGYWN0b3J5ID0ge307XG5cbiAgICAgICAgc29jaWFsRmFjdG9yeS5mYlNoYXJlID0gZnVuY3Rpb24obGluaykge1xuICAgICAgICAgICAgRkIudWkoe1xuICAgICAgICAgICAgICAgIG1ldGhvZDogJ3NoYXJlJyxcbiAgICAgICAgICAgICAgICBocmVmOiBsaW5rLFxuICAgICAgICAgICAgfSwgZnVuY3Rpb24ocmVzcG9uc2UpIHt9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBzb2NpYWxGYWN0b3J5O1xuICAgIH0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ3NwaWN5VGFzdGUnKVxuICAgIC5mYWN0b3J5KCdVc2VyU2VydmljZScsIGZ1bmN0aW9uKCRodHRwLCAkcm9vdFNjb3BlLCAkd2luZG93LCBDT05TVEFOVFMpIHtcbiAgICAgICAgdmFyIHVzZXJGYWN0b3J5ID0ge307XG4gICAgICAgIC8vc29jaWFsIGxvZ2luXG4gICAgICAgIHVzZXJGYWN0b3J5LnNvY2lhbExvZ2luID0gZnVuY3Rpb24oc29jaWFsVXNlcikge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJzb2NpYWxVc2VyOiBcIiwgc29jaWFsVXNlcik7XG5cbiAgICAgICAgICAgIHJldHVybiB1c2VyRmFjdG9yeS5zZWFyY2hCeSgnZW1haWw9JyArIHNvY2lhbFVzZXIuZW1haWwpLnRoZW4oZnVuY3Rpb24oZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgaWYgKCFkYXRhLnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9ub3QgZm91bmQsIHRoZW4gY3JlYXRlXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB1c2VyRmFjdG9yeS5jcmVhdGUoc29jaWFsVXNlcik7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy9mb3VuZCB0aGUgdXNlciB3aXRoIGVtYWlsXG4gICAgICAgICAgICAgICAgICAgIC8vdXBkYXRlIHRoZSBsaW5rZWQgc29jaWFsIGlmIG5vdCBhZGRlZFxuICAgICAgICAgICAgICAgICAgICB2YXIgdXNlciA9IGRhdGEudXNlcnNbMF07XG4gICAgICAgICAgICAgICAgICAgIGlmICh1c2VyLmxpbmtlZFNvY2lhbC5pbmRleE9mKHNvY2lhbFVzZXIubGlua2VkU29jaWFsKSA8IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXIubGlua2VkU29jaWFsLnB1c2goc29jaWFsVXNlci5saW5rZWRTb2NpYWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdXNlci51c2VyTmFtZSA9IHNvY2lhbFVzZXIudXNlck5hbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VyLnBob3RvVXJsID0gc29jaWFsVXNlci5waG90b1VybDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVzZXJGYWN0b3J5LnVwZGF0ZSh1c2VyKS50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB1c2VyRmFjdG9yeS5sb2dpbih1c2VyLmVtYWlsLCBDT05TVEFOVFMuU09DSUFMX1BBU1MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdXNlckZhY3RvcnkubG9naW4odXNlci5lbWFpbCwgQ09OU1RBTlRTLlNPQ0lBTF9QQVNTKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9sb2dpbiB1c2VyXG4gICAgICAgIHVzZXJGYWN0b3J5LmxvZ2luID0gZnVuY3Rpb24oZW1haWwsIHBhc3N3b3JkKSB7XG5cbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL2F1dGgnLCB7XG4gICAgICAgICAgICAgICAgZW1haWw6IGVtYWlsLFxuICAgICAgICAgICAgICAgIHBhc3N3b3JkOiBwYXNzd29yZFxuICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICRodHRwLmRlZmF1bHRzLmhlYWRlcnMuY29tbW9uWydYLUF1dGgnXSA9IHJlc3BvbnNlLmRhdGE7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHVzZXJGYWN0b3J5LmdldCgpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuXG4gICAgICAgIC8vbG9nb3V0IHVzZXJcbiAgICAgICAgdXNlckZhY3RvcnkubG9nb3V0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBkZWxldGUgJGh0dHAuZGVmYXVsdHMuaGVhZGVycy5jb21tb25bJ1gtQXV0aCddO1xuICAgICAgICAgICAgJHdpbmRvdy5sb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShDT05TVEFOVFMuTE9DQUxfU1RPUkFHRV9LRVkpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9nZXQgY3VycmVudCB1c2VyXG4gICAgICAgIHVzZXJGYWN0b3J5LmdldCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS91c2Vycy9tZScpLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9zZWFyY2ggdXNlciBieSBmaWVsZFxuICAgICAgICB1c2VyRmFjdG9yeS5zZWFyY2hCeSA9IGZ1bmN0aW9uKHF1ZXJ5KSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3VzZXJzPycgKyBxdWVyeSkudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5kYXRhO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICAvL2dldCB1c2VyIGJ5IGlkXG4gICAgICAgIHVzZXJGYWN0b3J5LmdldEJ5SWQgPSBmdW5jdGlvbih1c2VyX2lkKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3VzZXJzLycgKyB1c2VyX2lkKS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGE7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vY3JlYXRlIGEgbmV3IHVzZXJcbiAgICAgICAgdXNlckZhY3RvcnkuY3JlYXRlID0gZnVuY3Rpb24odXNlcikge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLnBvc3QoJy9hcGkvdXNlcnMvJywgdXNlcikudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdXNlckZhY3RvcnkubG9naW4odXNlci5lbWFpbCwgdXNlci5wYXNzd29yZCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vdXBkYXRlIHVzZXJcbiAgICAgICAgdXNlckZhY3RvcnkudXBkYXRlID0gZnVuY3Rpb24odXNlcl9pZCwgdXNlcikge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLnB1dCgnL2FwaS91c2Vycy8nICsgdXNlcl9pZCwgdXNlcikudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5kYXRhO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICAvL2NvbGxlY3QgZGlzaCBhcyBmYXZvdXJpdGVcbiAgICAgICAgdXNlckZhY3RvcnkuY29sbGVjdCA9IGZ1bmN0aW9uKGRpc2hfaWQpIHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5wdXQoJy9hcGkvdXNlcnMvJyArICRyb290U2NvcGUudXNlci5faWQgKyAnL2Rpc2hlcy8nICsgZGlzaF9pZCkudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5kYXRhO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdXNlckZhY3Rvcnk7XG4gICAgfSk7XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=