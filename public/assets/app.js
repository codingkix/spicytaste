angular.module("spicyTaste",["ngRoute","angular-md5","ngMaterial","ngAnimate","ngMessages"]).constant("CONSTANTS",{FB_APP_ID:0x58e0e66b31adc,FACEBOOK:"FB",EMAIL:"EMAIL",SOCIAL_PASS:"P@ssw0rd",LOCAL_STORAGE_KEY:"spicyTasteUser",LATEST_COUNT:10}),angular.module("spicyTaste").config(["$mdThemingProvider","$mdIconProvider",function(e,t){"use strict";var n=e.extendPalette("deep-orange",{500:"f27242"}),i=e.extendPalette("blue",{500:"6984b4",600:"6984b4"});e.definePalette("primaryOrange",n),e.definePalette("primaryBlue",i),e.theme("default").primaryPalette("primaryOrange").accentPalette("light-green"),e.theme("blue").primaryPalette("primaryBlue"),t.icon("menu","svg/ic_menu_24px.svg").icon("share","svg/ic_share_48px.svg").icon("login","svg/ic_account_circle_24px.svg").icon("recipes","svg/ic_event_note_48px.svg").icon("restaurants","svg/ic_restaurant_menu_48px.svg").icon("ingredients","svg/ic_receipt_48px.svg").icon("arrow","svg/ic_arrow_drop_up_48px.svg").icon("more","svg/ic_more_24px.svg").icon("time1","svg/ic_av_timer_24px.svg").icon("time2","svg/ic_access_time_24px.svg").icon("difficulty","svg/ic_track_changes_24px.svg").icon("exit","svg/ic_exit_to_app_48px.svg").icon("photo","svg/ic_mms_24px.svg").icon("check","svg/ic_check_circle_24px.svg").icon("facebook","svg/facebook.svg").icon("twitter","svg/twitter.svg").icon("pinterest","svg/pinterest.svg").icon("comments","svg/ic_chat_48px.svg").icon("menu","svg/ic_menu_48px.svg").icon("favorite","svg/ic_favorite_24px.svg").icon("delete","svg/ic_delete_48px.svg").icon("add","svg/ic_add_circle_outline_48px.svg").icon("arrow-down","svg/ic_expand_more_48px.svg")}]),angular.module("spicyTaste").run(["$rootScope","$location","$window","CONSTANTS","UserService",function(e,t,n,i,o){n.fbAsyncInit=function(){FB.init({appId:i.FB_APP_ID,cookie:!0,xfbml:!0,version:"v2.2"})},function(e,t,n){var i,o=e.getElementsByTagName(t)[0];e.getElementById(n)||(i=e.createElement(t),i.id=n,i.src="//connect.facebook.net/en_US/sdk.js",o.parentNode.insertBefore(i,o))}(document,"script","facebook-jssdk"),e.$on("$routeChangeStart",function(e,n){n.access&&o.authorize(n.access.requirePermissions).then(function(e){e||t.path("not-authorize").replace()})})}]),angular.module("spicyTaste").config(["$locationProvider","$routeProvider",function(e,t){"use strict";e.html5Mode(!0),t.when("/",{templateUrl:"ng/views/pages/home.html",controller:"HomeController",controllerAs:"home"}).when("/inspire",{templateUrl:"/ng/views/pages/shows/dinner.html",controller:"DinnerController",controllerAs:"dinner"}).when("/dishes",{templateUrl:"ng/views/pages/dish/all.html",controller:"DishListController",controllerAs:"dishList"}).when("/dishes/:dish_id",{templateUrl:"ng/views/pages/dish/detail.html",controller:"DishDetailController",controllerAs:"dishDetail"}).when("/admin/dishes",{templateUrl:"ng/views/pages/admin/dish/list.html",controller:"DishListController",controllerAs:"dishList",access:{requirePermissions:["Admin"]}}).when("/admin/dishes/:dish_id",{templateUrl:"ng/views/pages/admin/dish/single.html",controller:"DishEditController",controllerAs:"dishManage",access:{requirePermissions:["Admin"]}}).when("/login",{templateUrl:"ng/views/pages/user/login.html",controller:"LoginController",controllerAs:"login"}).when("/me",{templateUrl:"ng/views/pages/user/me.html",controller:"ProfileController",controllerAs:"me"}).when("/not-authorize",{templateUrl:"ng/views/pages/not-authorize.html"})}]),angular.module("spicyTaste").controller("DinnerController",["DishService",function(e){"use strict"}]),angular.module("spicyTaste").controller("DishListController",["DishService","SocialService","$location",function(e,t,n){var i=this;e.all().success(function(e){i.dishes=e}),i.deleteDish=function(t){var n=i.dishes[t];e["delete"](n._id).success(function(e){i.dishes.splice(t,1)})},i.addDish=function(){e.create({name:"new dish"}).success(function(e){n.path("/admin/dishes/"+e.dish._id)})},i.goToEdit=function(e){n.path("/admin/dishes/"+e)}}]).controller("DishDetailController",["$scope","$location","$rootScope","$routeParams","$filter","$mdDialog","DishService","UserService","SocialService",function(e,t,n,i,o,s,r,c,a){function l(){h.dish={},h.relatedDishes={},r.get(i.dish_id).success(function(e){if(h.dish=e,h.dish.isCollected=!1,r.relate(h.dish._id,h.dish.tags,3).success(function(e){h.relatedDishes=e}),n.currentUser){var t=o("filter")(n.currentUser.favouriteDishes,{_id:h.dish._id},!0);t.length&&(h.dish.isCollected=!0)}})}function u(e,t,n){s.show({targetEvent:t,clickOutsideToClose:!0,templateUrl:"ng/views/dialogs/comment.html",locals:{title:e},controller:d,controllerAs:"comment"}).then(function(e){r.addComment(h.dish._id,{content:e,replyTo:n}).success(function(e){h.dish.comments.push(e)})})}function d(e,t){var n=this;n.content="",n.title=e,n.closeDialog=function(){t.cancel()},n.submit=function(){""==n.content.trim()?t.cancel():t.hide(n.content)}}var h=this;h.dish={},l(),h.enterFlipBook=function(e){s.show({targetEvent:e,clickOutsideToClose:!0,templateUrl:"ng/views/dialogs/flipbook.html",controller:"DishDetailController",controllerAs:"book"})["finally"](function(){n.shownBook=!1}),n.shownBook=!0},e.$on("onRepeatLast",function(e,t,n){angular.element(t).parents("#dishBook").booklet({width:"100%",height:600,closed:!0,autoCenter:!0,pageNumbers:!1,pagePadding:0,hoverWidth:100})}),h.closeDialog=function(){s.cancel()},h.fbShare=function(e){var n=t.absUrl()+"/"+e._id;a.fbShare(n)},h.reply=function(e,t){var n="@"+e.userName;u(n,t,e._id)},h.collect=function(t){n.currentUser?c.collect(h.dish._id).then(function(e){e.success&&(h.dish.isCollected=!0)}):e.showLoginDialog(t,!0,"Login/SignUp first to save as favorite").then(function(e){n.currentUser=e,c.collect(h.dish._id).then(function(e){e.success&&(h.dish.isCollected=!0)})})},h.showInstructionPhoto=function(e,t){null!=e&&""!=e.trim()&&s.show({targetEvent:t,clickOutsideToClose:!0,template:'<md-dialog><md-dialog-content><img src="{{photo}}"></md-dialog-content></md-dialog>',controller:["$scope",function(t){t.photo=e}]})},h.newComment=function(t){n.currentUser?u("Comment",t,null):e.showLoginDialog(t,!0,"Login/SignUp first to leave a comment").then(function(e){n.currentUser=e,u("Comment",t,null)})},d.$inject=["title","$mdDialog"]}]).controller("DishEditController",["$mdDialog","$routeParams","DishService","$location","$timeout",function(e,t,n,i,o){function s(e){var t=this;t.newPhoto="",t.closeDialog=function(){e.cancel()},t.submit=function(){e.hide(t.newPhoto)}}function r(e){var t=this;t.newInstruction={photo:"",text:""},t.closeDialog=function(){e.cancel()},t.submit=function(){e.hide(t.newInstruction)}}function c(){n.get(t.dish_id).success(function(e){a.dish=e}),a.difficulties=n.getDifficulties()}var a=this;c(),a.saveDish=function(){n.update(t.dish_id,a.dish).success(function(e){a.updateSuccess=!0,o(function(){a.updateSuccess=!1},1e3)})},a.removeInstruction=function(e){n.removeInstruction(t.dish_id,a.dish.instructions[e]._id).success(function(t){a.dish.instructions.splice(e,1)})},a.removePhoto=function(e){a.dish.photos.splice(e,1),a.saveDish()},a.showAddPhotoDialog=function(t){e.show({targetEvent:t,controller:s,controllerAs:"photoDlg",clickOutsideToClose:!0,templateUrl:"ng/views/dialogs/addPhoto.html"}).then(function(e){a.dish.photos.push(e),a.saveDish()})},a.showAddInstructionDialog=function(i){e.show({targetEvent:i,controller:r,controllerAs:"instructionDlg",clickOutsideToClose:!0,templateUrl:"ng/views/dialogs/addInstruction.html"}).then(function(e){a.dish.instructions.push(e),n.addInstruction(t.dish_id,e).success(function(e){})})},s.$inject=["$mdDialog"],r.$inject=["$mdDialog"]}]),angular.module("spicyTaste").controller("HomeController",["$scope","$mdMedia","DishService","CONSTANTS",function(e,t,n,i){function o(){r.recipeTiles=[],e.$watch(function(){return t("sm")},function(t){e.smallScreen=t}),s()}function s(){n.limit(i.LATEST_COUNT).success(function(e){angular.forEach(e,function(e,t){var n={image:e.imageUrl,title:e.name,id:e._id,prepTime:e.prepTime,totalTime:e.totalTime,difficulty:e.difficulty,tags:e.tags,span:{row:1,col:1}};switch(t+1){case 1:n.span.row=n.span.col=2;break;case 2:case 3:break;case 4:n.span.col=2;case 5:case 6:break;case 7:n.span.row=n.span.col=2;case 8:case 9:break;case 10:n.span.col=2}r.recipeTiles.push(n)})})}var r=this;o()}]),angular.module("spicyTaste").controller("MainController",["$rootScope","$scope","$location","$mdDialog","$http","SessionService","UserService","CONSTANTS",function(e,t,n,i,o,s,r,c){"use strict";function a(e,t,n,i){function r(e){var n=o.defaults.headers.common["X-Auth"];s.setLocal(c.LOCAL_STORAGE_KEY,n),t.hide(e)}var a=this;a.title=e,a.email="",a.password="",a.userName="",a.fbLogin=function(){FB.login(function(e){"connected"===e.status?FB.api("/me",function(e){var t={userName:e.name,email:e.email,password:c.SOCIAL_PASS,photoUrl:"http://graph.facebook.com/"+e.id+"/picture?type=large",linkedSocial:c.FACEBOOK};n.socialLogin(t).then(function(e){e.loginType=c.FACEBOOK,r(e)})}):"not_authorized"===e.status},{scope:"public_profile,email"})},a.login=function(){n.login(a.email,a.password).then(function(e){e.loginType=c.EMAIL,r(e)})},a.signUp=function(){var e={userName:a.userName,email:a.email,password:a.password,photoUrl:"http://www.gravatar.com/avatar/"+i.createHash(a.email),linkedSocial:c.EMAIL};n.create(e).then(function(e){e.loginType=c.EMAIL,r(e)})}}function l(){u.showMobileMenu=!1,u.scrollTargetReached=!1,u.menuBar={primaryTheme:!1,hidden:!1,text:"SPICY TASTE"};var t=s.getLocal(c.LOCAL_STORAGE_KEY);t&&(console.log("token",t),o.defaults.headers.common["X-Auth"]=t,r.getCurrentUser().then(function(t){e.currentUser=t}))}var u=this;l(),u.toggleMobileMenu=function(){u.showMobileMenu=!u.showMobileMenu},t.setMenuBar=function(e){u.menuBar=e},t.showLoginDialog=function(t,n,o){var s=i.show({clickOutsideToClose:!0,templateUrl:"ng/views/dialogs/login.html",targetEvent:t,controller:a,controllerAs:"login",locals:{dialogTitle:o}});return n?s:void s.then(function(t){e.currentUser=t})},a.$inject=["dialogTitle","$mdDialog","UserService","md5"]}]),angular.module("spicyTaste").controller("ProfileController",["$location","$rootScope","UserService",function(e,t,n){"use strict";function i(){o.user={},n.getById(t.currentUser._id).then(function(e){o.user=e})}var o=this;i(),o.logout=function(){n.logout(),t.currentUser=null,e.path("/")}}]),angular.module("spicyTaste").directive("contenteditable",function(){return{require:"ngModel",restrict:"A",link:function(e,t,n,i){i.$render=function(){t.html(i.$viewValue||"")},t.bind("blur",function(){e.$apply(function(){i.$setViewValue(t.html())})})}}}),angular.module("spicyTaste").directive("flipbook",function(){return{transclude:!1,restrict:"E",replace:!0,templateUrl:"ng/views/templates/flipbook.html",scope:{dish:"="}}}),angular.module("spicyTaste").directive("focusOn",function(){return{restrict:"A",scope:{focusValue:"=focusOn"},link:function(e,t){e.$watch("focusValue",function(e,n){e&&!n&&t[0].focus()})}}}),angular.module("spicyTaste").directive("onLastRepeat",["$timeout",function(e){"use strict";return function(t,n,i){t.$last&&e(function(){t.$emit("onRepeatLast",n,i)},0)}}]),angular.module("spicyTaste").directive("scrollTo",function(){return{restrict:"A",link:function(e,t,n){var i=$(n.scrollTo);t.on("click",function(){$("html, body").animate({scrollTop:i.offset().top},600)})}}}),angular.module("spicyTaste").directive("showTime",["$window",function(e){"use strict";return{restrict:"A",scope:!0,link:function(t,n,i){var o=t.$eval(i.showTime),s=0;angular.isUndefined(o)||(s=o.offset),angular.element(e).on("scroll",function(t){if(!n.hasClass("viewed")){var i=angular.element(e).scrollTop(),o=i+angular.element(e).height(),r=n.offset().top,c=r+n.height();0!==s&&(i-r>=0?r+=s:c-=s),o>=c&&r>=i&&n.removeClass("notViewed").addClass("viewed")}})}}}]),angular.module("spicyTaste").directive("topMenuReached",["$window",function(e){"use strict";return{restrict:"A",scope:!0,link:function(t,n,i){var o=n.offset().top-64,s={primaryTheme:!1,hidden:!1,text:"spicy taste"},r=t.$eval(i.topMenuReached);angular.element(e).on("scroll",function(){t.setMenuBar(this.pageYOffset>=o?r:s),t.$apply()})}}}]),angular.module("spicyTaste").factory("DishService",["$http",function(e){var t={};return t.all=function(){return e.get("/api/dishes")},t.limit=function(t){return e.get("/api/dishes?limit="+t)},t.relate=function(t,n,i){return e({method:"GET",url:"/api/dishes",params:{id:t,limit:i,"tags[]":n}})},t.create=function(t){return e.post("/api/dishes",t)},t.get=function(t){return e.get("/api/dishes/"+t)},t.update=function(t,n){return e.put("/api/dishes/"+t,n)},t["delete"]=function(t){return e["delete"]("/api/dishes/"+t)},t.addComment=function(t,n){return e.post("/api/dishes/"+t+"/comments",n)},t.addInstruction=function(t,n){return e.post("/api/dishes/"+t+"/instructions",n)},t.removeInstruction=function(t,n){return e["delete"]("/api/dishes/"+t+"/instructions/"+n)},t.getDifficulties=function(){return["初学","容易","一般","较难","专业"]},t}]),angular.module("spicyTaste").factory("SessionService",["$window",function(e){var t={};return t.getLocal=function(t){if(e.localStorage){var n=e.localStorage.getItem(t);return angular.fromJson(n)}return!1},t.setLocal=function(t,n){return e.localStorage&&e.localStorage.setItem(t,angular.toJson(n))},t}]),angular.module("spicyTaste").factory("SocialService",function(){var e={};return e.fbShare=function(e){FB.ui({method:"share",href:e},function(e){})},e}),angular.module("spicyTaste").factory("UserService",["$http","$rootScope","$window","CONSTANTS",function(e,t,n,i){"use strict";var o={};return o.socialLogin=function(e){return o.searchBy("email="+e.email).then(function(t){return t.success?o.login(e.email,i.SOCIAL_PASS):o.create(e)})},o.login=function(t,n){return e.post("/api/auth",{email:t,password:n}).then(function(t){return e.defaults.headers.common["X-Auth"]=t.data.token,o.getById(t.data.userId)})},o.logout=function(){delete e.defaults.headers.common["X-Auth"],n.localStorage.removeItem(i.LOCAL_STORAGE_KEY),o.loginedUser=null},o.searchBy=function(t){return e.get("/api/users?"+t).then(function(e){return e.data})},o.getCurrentUser=function(){return e.get("/api/me").then(function(e){return o.getById(e.data)})},o.getById=function(t){return e.get("/api/users/"+t).then(function(e){return e.data})},o.create=function(t){return e.post("/api/users/",t).then(function(){return o.login(t.email,t.password)})},o.update=function(t){return e.put("/api/users/"+t.user_id,t).then(function(e){return e.data})},o.collect=function(n){return e.put("/api/users/"+t.currentUser._id+"/dishes/"+n).then(function(e){return e.data})},o.authorize=function(e){return o.getCurrentUser().then(function(t){return t&&e.indexOf(t.role)>=0?!0:!1},function(e){return!1})},o}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsImRlc2lnbi5qcyIsIm1vZHVsZS5ydW4uanMiLCJyb3V0ZXMuanMiLCJjb250cm9sbGVycy9kaW5uZXJDb250cm9sbGVyLmpzIiwiY29udHJvbGxlcnMvZGlzaENvbnRyb2xsZXIuanMiLCJhcHAuanMiLCJjb250cm9sbGVycy9ob21lQ29udHJvbGxlci5qcyIsImNvbnRyb2xsZXJzL21haW5Db250cm9sbGVyLmpzIiwiY29udHJvbGxlcnMvcHJvZmlsZUNvbnRyb2xsZXIuanMiLCJkaXJlY3RpdmVzL2NvbnRlbnRlZGl0YWJsZURpcmVjdGl2ZS5qcyIsImRpcmVjdGl2ZXMvZmxpcEJvb2tEaXJlY3RpdmUuanMiLCJkaXJlY3RpdmVzL2ZvY3VzT25EaXJlY3RpdmUuanMiLCJkaXJlY3RpdmVzL29uTGFzdFJlcGVhdC5qcyIsImRpcmVjdGl2ZXMvc2Nyb2xsVG9EaXJlY3RpdmUuanMiLCJkaXJlY3RpdmVzL3Nob3dUaW1lRGlyZWN0aXZlLmpzIiwiZGlyZWN0aXZlcy90b3BNZW51UmVhY2hlZERpcmVjdGl2ZS5qcyIsInNlcnZpY2VzL2Rpc2hTZXJ2aWNlLmpzIiwic2VydmljZXMvc2Vzc2lvblNlcnZpY2UuanMiLCJzZXJ2aWNlcy9zb2NpYWxTZXJ2aWNlLmpzIiwic2VydmljZXMvdXNlclNlcnZpY2UuanMiXSwibmFtZXMiOlsiYW5ndWxhciIsIm1vZHVsZSIsImNvbnN0YW50IiwiRkJfQVBQX0lEIiwiRkFDRUJPT0siLCJFTUFJTCIsIlNPQ0lBTF9QQVNTIiwiTE9DQUxfU1RPUkFHRV9LRVkiLCJMQVRFU1RfQ09VTlQiLCJjb25maWciLCIkbWRUaGVtaW5nUHJvdmlkZXIiLCIkbWRJY29uUHJvdmlkZXIiLCJwcmltYXJ5T3JhbmdlIiwiZXh0ZW5kUGFsZXR0ZSIsIjUwMCIsInByaW1hcnlCbHVlIiwiNjAwIiwiZGVmaW5lUGFsZXR0ZSIsInRoZW1lIiwicHJpbWFyeVBhbGV0dGUiLCJhY2NlbnRQYWxldHRlIiwiaWNvbiIsInJ1biIsIiRyb290U2NvcGUiLCIkbG9jYXRpb24iLCIkd2luZG93IiwiQ09OU1RBTlRTIiwiVXNlclNlcnZpY2UiLCJmYkFzeW5jSW5pdCIsIkZCIiwiaW5pdCIsImFwcElkIiwiY29va2llIiwieGZibWwiLCJ2ZXJzaW9uIiwiZCIsInMiLCJpZCIsImpzIiwiZmpzIiwiZ2V0RWxlbWVudHNCeVRhZ05hbWUiLCJnZXRFbGVtZW50QnlJZCIsImNyZWF0ZUVsZW1lbnQiLCJzcmMiLCJwYXJlbnROb2RlIiwiaW5zZXJ0QmVmb3JlIiwiZG9jdW1lbnQiLCIkb24iLCJldmVudCIsIm5leHQiLCJhY2Nlc3MiLCJhdXRob3JpemUiLCJyZXF1aXJlUGVybWlzc2lvbnMiLCJ0aGVuIiwicmVzdWx0IiwicGF0aCIsInJlcGxhY2UiLCIkbG9jYXRpb25Qcm92aWRlciIsIiRyb3V0ZVByb3ZpZGVyIiwiaHRtbDVNb2RlIiwid2hlbiIsInRlbXBsYXRlVXJsIiwiY29udHJvbGxlciIsImNvbnRyb2xsZXJBcyIsIkRpc2hTZXJ2aWNlIiwiU29jaWFsU2VydmljZSIsInZtIiwidGhpcyIsImFsbCIsInN1Y2Nlc3MiLCJkYXRhIiwiZGlzaGVzIiwiZGVsZXRlRGlzaCIsImluZGV4IiwiZGlzaCIsIl9pZCIsInNwbGljZSIsImFkZERpc2giLCJjcmVhdGUiLCJuYW1lIiwiZ29Ub0VkaXQiLCIkc2NvcGUiLCIkcm91dGVQYXJhbXMiLCIkZmlsdGVyIiwiJG1kRGlhbG9nIiwicmVsYXRlZERpc2hlcyIsImdldCIsImRpc2hfaWQiLCJpc0NvbGxlY3RlZCIsInJlbGF0ZSIsInRhZ3MiLCJjdXJyZW50VXNlciIsImZvdW5kIiwiZmF2b3VyaXRlRGlzaGVzIiwibGVuZ3RoIiwib3BlbkNvbW1lbnREaWFsb2ciLCJ0aXRsZSIsIiRldmVudCIsInJlcGx5VG8iLCJzaG93IiwidGFyZ2V0RXZlbnQiLCJjbGlja091dHNpZGVUb0Nsb3NlIiwibG9jYWxzIiwiY29tbWVudENvbnRyb2xsZXIiLCJjb250ZW50IiwiYWRkQ29tbWVudCIsImNvbW1lbnQiLCJjb21tZW50cyIsInB1c2giLCJkdm0iLCJjbG9zZURpYWxvZyIsImNhbmNlbCIsInN1Ym1pdCIsInRyaW0iLCJoaWRlIiwiZW50ZXJGbGlwQm9vayIsImV2biIsInNob3duQm9vayIsInNjb3BlIiwiZWxlbWVudCIsImF0dHJzIiwicGFyZW50cyIsImJvb2tsZXQiLCJ3aWR0aCIsImhlaWdodCIsImNsb3NlZCIsImF1dG9DZW50ZXIiLCJwYWdlTnVtYmVycyIsInBhZ2VQYWRkaW5nIiwiaG92ZXJXaWR0aCIsImZiU2hhcmUiLCJkaXNoTGluayIsImFic1VybCIsInJlcGx5IiwidXNlciIsImNvbW1lbnRUaXRsZSIsInVzZXJOYW1lIiwiY29sbGVjdCIsInNob3dMb2dpbkRpYWxvZyIsInNob3dJbnN0cnVjdGlvblBob3RvIiwicGhvdG9VcmwiLCJ0ZW1wbGF0ZSIsInBob3RvIiwibmV3Q29tbWVudCIsIiRpbmplY3QiLCIkdGltZW91dCIsInBob3RvRGlhbG9nQ29udHJvbGxlciIsIm5ld1Bob3RvIiwiaW5zdHJ1Y3Rpb25EaWFsb2dDb250cm9sbGVyIiwibmV3SW5zdHJ1Y3Rpb24iLCJ0ZXh0IiwiZGlmZmljdWx0aWVzIiwiZ2V0RGlmZmljdWx0aWVzIiwic2F2ZURpc2giLCJ1cGRhdGUiLCJ1cGRhdGVTdWNjZXNzIiwicmVtb3ZlSW5zdHJ1Y3Rpb24iLCJpbnN0cnVjdGlvbnMiLCJyZW1vdmVQaG90byIsInBob3RvcyIsInNob3dBZGRQaG90b0RpYWxvZyIsInNob3dBZGRJbnN0cnVjdGlvbkRpYWxvZyIsImFkZEluc3RydWN0aW9uIiwiJG1kTWVkaWEiLCJyZWNpcGVUaWxlcyIsIiR3YXRjaCIsImlzU21hbGwiLCJzbWFsbFNjcmVlbiIsImJ1aWxkR3JpZCIsImxpbWl0IiwiZm9yRWFjaCIsInRpbGUiLCJpbWFnZSIsImltYWdlVXJsIiwicHJlcFRpbWUiLCJ0b3RhbFRpbWUiLCJkaWZmaWN1bHR5Iiwic3BhbiIsInJvdyIsImNvbCIsIiRodHRwIiwiU2Vzc2lvblNlcnZpY2UiLCJsb2dpbkNvbnRyb2xsZXIiLCJkaWFsb2dUaXRsZSIsIm1kNSIsImFmdGVyQXV0aCIsInRva2VuIiwiZGVmYXVsdHMiLCJoZWFkZXJzIiwiY29tbW9uIiwic2V0TG9jYWwiLCJlbWFpbCIsInBhc3N3b3JkIiwiZmJMb2dpbiIsImxvZ2luIiwicmVzcG9uc2UiLCJzdGF0dXMiLCJhcGkiLCJmYlVzZXIiLCJsaW5rZWRTb2NpYWwiLCJzb2NpYWxMb2dpbiIsImxvZ2luVHlwZSIsInNpZ25VcCIsIm5ld1VzZXIiLCJjcmVhdGVIYXNoIiwic2hvd01vYmlsZU1lbnUiLCJzY3JvbGxUYXJnZXRSZWFjaGVkIiwibWVudUJhciIsInByaW1hcnlUaGVtZSIsImhpZGRlbiIsImxvZ2luZWRUb2tlbiIsImdldExvY2FsIiwiY29uc29sZSIsImxvZyIsImdldEN1cnJlbnRVc2VyIiwidG9nZ2xlTW9iaWxlTWVudSIsInNldE1lbnVCYXIiLCJldiIsInBvc3RMb2dpbiIsInByb21pc2UiLCJnZXRCeUlkIiwibG9nb3V0IiwiZGlyZWN0aXZlIiwicmVxdWlyZSIsInJlc3RyaWN0IiwibGluayIsImF0dHJpYnV0cyIsIm5nTW9kZWwiLCIkcmVuZGVyIiwiaHRtbCIsIiR2aWV3VmFsdWUiLCJiaW5kIiwiJGFwcGx5IiwiJHNldFZpZXdWYWx1ZSIsInRyYW5zY2x1ZGUiLCJmb2N1c1ZhbHVlIiwiJGVsZW1lbnQiLCJjdXJyZW50VmFsdWUiLCJwcmV2aW91c1ZhbHVlIiwiZm9jdXMiLCIkYXR0cnMiLCIkbGFzdCIsIiRlbWl0IiwiJHRhcmdldCIsIiQiLCJzY3JvbGxUbyIsIm9uIiwiYW5pbWF0ZSIsInNjcm9sbFRvcCIsIm9mZnNldCIsInRvcCIsInNob3dUaW1lIiwiJGV2YWwiLCJpc1VuZGVmaW5lZCIsImUiLCJoYXNDbGFzcyIsImRvY1RvcCIsImRvY0JvdHRvbSIsImVsZW1Ub3AiLCJlbGVtQm90dG9tIiwicmVtb3ZlQ2xhc3MiLCJhZGRDbGFzcyIsImRlZmF1bHRNZW51QmFyIiwidG9wTWVudVJlYWNoZWQiLCJwYWdlWU9mZnNldCIsImZhY3RvcnkiLCJkaXNoRmFjdG9yeSIsIm51bSIsIm1ldGhvZCIsInVybCIsInBhcmFtcyIsInRhZ3NbXSIsInBvc3QiLCJwdXQiLCJpbnN0cnVjdGlvbiIsImluc3RydWN0aW9uX2lkIiwic2Vzc2lvbkZhY3RvcnkiLCJrZXkiLCJsb2NhbFN0b3JhZ2UiLCJnZXRJdGVtIiwiZnJvbUpzb24iLCJzZXRJdGVtIiwidG9Kc29uIiwic29jaWFsRmFjdG9yeSIsInVpIiwiaHJlZiIsInVzZXJGYWN0b3J5Iiwic29jaWFsVXNlciIsInNlYXJjaEJ5IiwidXNlcklkIiwicmVtb3ZlSXRlbSIsImxvZ2luZWRVc2VyIiwicXVlcnkiLCJ1c2VyX2lkIiwiaW5kZXhPZiIsInJvbGUiXSwibWFwcGluZ3MiOiJBQUFBQSxRQUFBQyxPQUFBLGNBQUEsVUFBQSxjQUFBLGFBQUEsWUFBQSxlQUNBQyxTQUFBLGFBQ0FDLFVBQUEsZ0JBQ0FDLFNBQUEsS0FDQUMsTUFBQSxRQUNBQyxZQUFBLFdBQ0FDLGtCQUFBLGlCQUNBQyxhQUFBLEtDUEFSLFFBQUFDLE9BQUEsY0FDQVEsUUFBQSxxQkFBQSxrQkFBQSxTQUFBQyxFQUFBQyxHQUNBLFlBRUEsSUFBQUMsR0FBQUYsRUFBQUcsY0FBQSxlQUNBQyxJQUFBLFdBR0FDLEVBQUFMLEVBQUFHLGNBQUEsUUFDQUMsSUFBQSxTQUNBRSxJQUFBLFVBR0FOLEdBQUFPLGNBQUEsZ0JBQUFMLEdBQ0FGLEVBQUFPLGNBQUEsY0FBQUYsR0FFQUwsRUFBQVEsTUFBQSxXQUNBQyxlQUFBLGlCQUNBQyxjQUFBLGVBRUFWLEVBQUFRLE1BQUEsUUFDQUMsZUFBQSxlQUVBUixFQUFBVSxLQUFBLE9BQUEsd0JBQ0FBLEtBQUEsUUFBQSx5QkFDQUEsS0FBQSxRQUFBLGtDQUNBQSxLQUFBLFVBQUEsOEJBQ0FBLEtBQUEsY0FBQSxtQ0FDQUEsS0FBQSxjQUFBLDJCQUNBQSxLQUFBLFFBQUEsaUNBQ0FBLEtBQUEsT0FBQSx3QkFDQUEsS0FBQSxRQUFBLDRCQUNBQSxLQUFBLFFBQUEsK0JBQ0FB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LFFBQUEvSixHQUFBakYsS0FBQSxTQUFBOEksR0FDQSxNQUFBQSxHQUFBN0gsUUFLQXdOLEVBQUFySixRQUFBLFNBQUFsRCxHQUNBLE1BQUE2RixHQUFBNkYsSUFBQSxjQUFBMVAsRUFBQW9FLFlBQUFoQixJQUFBLFdBQUFZLEdBQUFsQyxLQUFBLFNBQUE4SSxHQUNBLE1BQUFBLEdBQUE3SCxRQUtBd04sRUFBQTNPLFVBQUEsU0FBQUMsR0FDQSxNQUFBME8sR0FBQXhFLGlCQUFBakssS0FBQSxTQUFBaUYsR0FDQSxNQUFBQSxJQUFBbEYsRUFBQWtQLFFBQUFoSyxFQUFBaUssT0FBQSxHQUNBLEdBRUEsR0FFQSxTQUFBcEcsR0FDQSxPQUFBLEtBSUEyRiIsImZpbGUiOiJhcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyJhbmd1bGFyLm1vZHVsZSgnc3BpY3lUYXN0ZScsIFsnbmdSb3V0ZScsICdhbmd1bGFyLW1kNScsICduZ01hdGVyaWFsJywgJ25nQW5pbWF0ZScsICduZ01lc3NhZ2VzJ10pXG4gICAgLmNvbnN0YW50KCdDT05TVEFOVFMnLCB7XG4gICAgICAgIFwiRkJfQVBQX0lEXCI6IDE1NjM1NjczODcyNTM0NjgsXG4gICAgICAgIFwiRkFDRUJPT0tcIjogXCJGQlwiLFxuICAgICAgICBcIkVNQUlMXCI6IFwiRU1BSUxcIixcbiAgICAgICAgXCJTT0NJQUxfUEFTU1wiOiBcIlBAc3N3MHJkXCIsXG4gICAgICAgIFwiTE9DQUxfU1RPUkFHRV9LRVlcIjogXCJzcGljeVRhc3RlVXNlclwiLFxuICAgICAgICBcIkxBVEVTVF9DT1VOVFwiOiAxMFxuICAgIH0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ3NwaWN5VGFzdGUnKVxuICAgIC5jb25maWcoZnVuY3Rpb24oJG1kVGhlbWluZ1Byb3ZpZGVyLCAkbWRJY29uUHJvdmlkZXIpIHtcbiAgICAgICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgICAgIHZhciBwcmltYXJ5T3JhbmdlID0gJG1kVGhlbWluZ1Byb3ZpZGVyLmV4dGVuZFBhbGV0dGUoJ2RlZXAtb3JhbmdlJywge1xuICAgICAgICAgICAgJzUwMCc6ICdmMjcyNDInXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHZhciBwcmltYXJ5Qmx1ZSA9ICRtZFRoZW1pbmdQcm92aWRlci5leHRlbmRQYWxldHRlKCdibHVlJywge1xuICAgICAgICAgICAgJzUwMCc6ICc2OTg0YjQnLFxuICAgICAgICAgICAgJzYwMCc6ICc2OTg0YjQnXG4gICAgICAgIH0pO1xuXG4gICAgICAgICRtZFRoZW1pbmdQcm92aWRlci5kZWZpbmVQYWxldHRlKCdwcmltYXJ5T3JhbmdlJywgcHJpbWFyeU9yYW5nZSk7XG4gICAgICAgICRtZFRoZW1pbmdQcm92aWRlci5kZWZpbmVQYWxldHRlKCdwcmltYXJ5Qmx1ZScsIHByaW1hcnlCbHVlKTtcblxuICAgICAgICAkbWRUaGVtaW5nUHJvdmlkZXIudGhlbWUoJ2RlZmF1bHQnKVxuICAgICAgICAgICAgLnByaW1hcnlQYWxldHRlKCdwcmltYXJ5T3JhbmdlJylcbiAgICAgICAgICAgIC5hY2NlbnRQYWxldHRlKCdsaWdodC1ncmVlbicpO1xuXG4gICAgICAgICRtZFRoZW1pbmdQcm92aWRlci50aGVtZSgnYmx1ZScpXG4gICAgICAgICAgICAucHJpbWFyeVBhbGV0dGUoJ3ByaW1hcnlCbHVlJyk7XG5cbiAgICAgICAgJG1kSWNvblByb3ZpZGVyLmljb24oJ21lbnUnLCAnc3ZnL2ljX21lbnVfMjRweC5zdmcnKVxuICAgICAgICAgICAgLmljb24oJ3NoYXJlJywgJ3N2Zy9pY19zaGFyZV80OHB4LnN2ZycpXG4gICAgICAgICAgICAuaWNvbignbG9naW4nLCAnc3ZnL2ljX2FjY291bnRfY2lyY2xlXzI0cHguc3ZnJylcbiAgICAgICAgICAgIC5pY29uKCdyZWNpcGVzJywgJ3N2Zy9pY19ldmVudF9ub3RlXzQ4cHguc3ZnJylcbiAgICAgICAgICAgIC5pY29uKCdyZXN0YXVyYW50cycsICdzdmcvaWNfcmVzdGF1cmFudF9tZW51XzQ4cHguc3ZnJylcbiAgICAgICAgICAgIC5pY29uKCdpbmdyZWRpZW50cycsICdzdmcvaWNfcmVjZWlwdF80OHB4LnN2ZycpXG4gICAgICAgICAgICAuaWNvbignYXJyb3cnLCAnc3ZnL2ljX2Fycm93X2Ryb3BfdXBfNDhweC5zdmcnKVxuICAgICAgICAgICAgLmljb24oJ21vcmUnLCAnc3ZnL2ljX21vcmVfMjRweC5zdmcnKVxuICAgICAgICAgICAgLmljb24oJ3RpbWUxJywgJ3N2Zy9pY19hdl90aW1lcl8yNHB4LnN2ZycpXG4gICAgICAgICAgICAuaWNvbigndGltZTInLCAnc3ZnL2ljX2FjY2Vzc190aW1lXzI0cHguc3ZnJylcbiAgICAgICAgICAgIC5pY29uKCdkaWZmaWN1bHR5JywgJ3N2Zy9pY190cmFja19jaGFuZ2VzXzI0cHguc3ZnJylcbiAgICAgICAgICAgIC5pY29uKCdleGl0JywgJ3N2Zy9pY19leGl0X3RvX2FwcF80OHB4LnN2ZycpXG4gICAgICAgICAgICAuaWNvbigncGhvdG8nLCAnc3ZnL2ljX21tc18yNHB4LnN2ZycpXG4gICAgICAgICAgICAuaWNvbignY2hlY2snLCAnc3ZnL2ljX2NoZWNrX2NpcmNsZV8yNHB4LnN2ZycpXG4gICAgICAgICAgICAuaWNvbignZmFjZWJvb2snLCAnc3ZnL2ZhY2Vib29rLnN2ZycpXG4gICAgICAgICAgICAuaWNvbigndHdpdHRlcicsICdzdmcvdHdpdHRlci5zdmcnKVxuICAgICAgICAgICAgLmljb24oJ3BpbnRlcmVzdCcsICdzdmcvcGludGVyZXN0LnN2ZycpXG4gICAgICAgICAgICAuaWNvbignY29tbWVudHMnLCAnc3ZnL2ljX2NoYXRfNDhweC5zdmcnKVxuICAgICAgICAgICAgLmljb24oJ21lbnUnLCAnc3ZnL2ljX21lbnVfNDhweC5zdmcnKVxuICAgICAgICAgICAgLmljb24oJ2Zhdm9yaXRlJywgJ3N2Zy9pY19mYXZvcml0ZV8yNHB4LnN2ZycpXG4gICAgICAgICAgICAuaWNvbignZGVsZXRlJywgJ3N2Zy9pY19kZWxldGVfNDhweC5zdmcnKVxuICAgICAgICAgICAgLmljb24oJ2FkZCcsICdzdmcvaWNfYWRkX2NpcmNsZV9vdXRsaW5lXzQ4cHguc3ZnJylcbiAgICAgICAgICAgIC5pY29uKCdhcnJvdy1kb3duJywgJ3N2Zy9pY19leHBhbmRfbW9yZV80OHB4LnN2ZycpO1xuICAgIH0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ3NwaWN5VGFzdGUnKVxuICAgIC5ydW4oZnVuY3Rpb24oJHJvb3RTY29wZSwgJGxvY2F0aW9uLCAkd2luZG93LCBDT05TVEFOVFMsIFVzZXJTZXJ2aWNlKSB7XG4gICAgICAgICR3aW5kb3cuZmJBc3luY0luaXQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIEZCLmluaXQoe1xuICAgICAgICAgICAgICAgIGFwcElkOiBDT05TVEFOVFMuRkJfQVBQX0lELFxuICAgICAgICAgICAgICAgIGNvb2tpZTogdHJ1ZSwgLy8gZW5hYmxlIGNvb2tpZXMgdG8gYWxsb3cgdGhlIHNlcnZlciB0byBhY2Nlc3MgdGhlIHNlc3Npb25cbiAgICAgICAgICAgICAgICB4ZmJtbDogdHJ1ZSwgLy8gcGFyc2Ugc29jaWFsIHBsdWdpbnMgb24gdGhpcyBwYWdlXG4gICAgICAgICAgICAgICAgdmVyc2lvbjogJ3YyLjInIC8vIHVzZSB2ZXJzaW9uIDIuMlxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gTG9hZCB0aGUgU0RLIGFzeW5jaHJvbm91c2x5XG4gICAgICAgIChmdW5jdGlvbihkLCBzLCBpZCkge1xuICAgICAgICAgICAgdmFyIGpzLCBmanMgPSBkLmdldEVsZW1lbnRzQnlUYWdOYW1lKHMpWzBdO1xuICAgICAgICAgICAgaWYgKGQuZ2V0RWxlbWVudEJ5SWQoaWQpKSByZXR1cm47XG4gICAgICAgICAgICBqcyA9IGQuY3JlYXRlRWxlbWVudChzKTtcbiAgICAgICAgICAgIGpzLmlkID0gaWQ7XG4gICAgICAgICAgICBqcy5zcmMgPSBcIi8vY29ubmVjdC5mYWNlYm9vay5uZXQvZW5fVVMvc2RrLmpzXCI7XG4gICAgICAgICAgICBmanMucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoanMsIGZqcyk7XG4gICAgICAgIH0oZG9jdW1lbnQsICdzY3JpcHQnLCAnZmFjZWJvb2stanNzZGsnKSk7XG5cbiAgICAgICAgLy9DaGVjayBBdXRob3JpemF0aW9uXG4gICAgICAgICRyb290U2NvcGUuJG9uKCckcm91dGVDaGFuZ2VTdGFydCcsIGZ1bmN0aW9uKGV2ZW50LCBuZXh0KXtcbiAgICAgICAgICAgIGlmKG5leHQuYWNjZXNzKXtcbiAgICAgICAgICAgICAgICBVc2VyU2VydmljZS5hdXRob3JpemUobmV4dC5hY2Nlc3MucmVxdWlyZVBlcm1pc3Npb25zKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCl7XG4gICAgICAgICAgICAgICAgICAgIGlmKCFyZXN1bHQpXG4gICAgICAgICAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aCgnbm90LWF1dGhvcml6ZScpLnJlcGxhY2UoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICB9KTtcbiIsImFuZ3VsYXIubW9kdWxlKCdzcGljeVRhc3RlJylcbiAgICAuY29uZmlnKGZ1bmN0aW9uKCRsb2NhdGlvblByb3ZpZGVyLCAkcm91dGVQcm92aWRlcikge1xuICAgICAgICAndXNlIHN0cmljdCc7XG5cbiAgICAgICAgJGxvY2F0aW9uUHJvdmlkZXIuaHRtbDVNb2RlKHRydWUpO1xuXG4gICAgICAgICRyb3V0ZVByb3ZpZGVyXG4gICAgICAgIC8vaG9tZSBwYWdlXG4gICAgICAgICAgICAud2hlbignLycsIHtcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25nL3ZpZXdzL3BhZ2VzL2hvbWUuaHRtbCcsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ0hvbWVDb250cm9sbGVyJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6ICdob21lJ1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC53aGVuKCcvaW5zcGlyZScsIHtcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9uZy92aWV3cy9wYWdlcy9zaG93cy9kaW5uZXIuaHRtbCcsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ0Rpbm5lckNvbnRyb2xsZXInLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ2Rpbm5lcidcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAvL3Nob3cgYWxsIGRpc2hlcyBwYWdlXG4gICAgICAgICAgICAud2hlbignL2Rpc2hlcycsIHtcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25nL3ZpZXdzL3BhZ2VzL2Rpc2gvYWxsLmh0bWwnLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdEaXNoTGlzdENvbnRyb2xsZXInLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ2Rpc2hMaXN0J1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC8vc2hvdyBkaXNoIGRldGFpbCBwYWdlXG4gICAgICAgICAgICAud2hlbignL2Rpc2hlcy86ZGlzaF9pZCcsIHtcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25nL3ZpZXdzL3BhZ2VzL2Rpc2gvZGV0YWlsLmh0bWwnLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdEaXNoRGV0YWlsQ29udHJvbGxlcicsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiAnZGlzaERldGFpbCdcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAvL2xpc3QgYWRtaW4gZGlzaCBwYWdlXG4gICAgICAgICAgICAud2hlbignL2FkbWluL2Rpc2hlcycsIHtcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25nL3ZpZXdzL3BhZ2VzL2FkbWluL2Rpc2gvbGlzdC5odG1sJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnRGlzaExpc3RDb250cm9sbGVyJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6ICdkaXNoTGlzdCcsXG4gICAgICAgICAgICAgICAgYWNjZXNzOiB7XG4gICAgICAgICAgICAgICAgICAgIHJlcXVpcmVQZXJtaXNzaW9uczogWydBZG1pbiddXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC8vZWRpdCBhIGRpc2ggcGFnZVxuICAgICAgICAgICAgLndoZW4oJy9hZG1pbi9kaXNoZXMvOmRpc2hfaWQnLCB7XG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICduZy92aWV3cy9wYWdlcy9hZG1pbi9kaXNoL3NpbmdsZS5odG1sJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnRGlzaEVkaXRDb250cm9sbGVyJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6ICdkaXNoTWFuYWdlJyxcbiAgICAgICAgICAgICAgICBhY2Nlc3M6IHtcbiAgICAgICAgICAgICAgICAgICAgcmVxdWlyZVBlcm1pc3Npb25zOiBbJ0FkbWluJ11cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLy9sb2dpbiB1c2VyXG4gICAgICAgICAgICAud2hlbignL2xvZ2luJywge1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbmcvdmlld3MvcGFnZXMvdXNlci9sb2dpbi5odG1sJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnTG9naW5Db250cm9sbGVyJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6ICdsb2dpbidcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAvL3VzZXIgcHJvZmlsZVxuICAgICAgICAgICAgLndoZW4oJy9tZScsIHtcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25nL3ZpZXdzL3BhZ2VzL3VzZXIvbWUuaHRtbCcsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ1Byb2ZpbGVDb250cm9sbGVyJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6ICdtZSdcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAud2hlbignL25vdC1hdXRob3JpemUnLCB7XG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICduZy92aWV3cy9wYWdlcy9ub3QtYXV0aG9yaXplLmh0bWwnXG4gICAgICAgICAgICB9KTtcbiAgICB9KTtcbiIsImFuZ3VsYXIubW9kdWxlKCdzcGljeVRhc3RlJylcbiAgICAuY29udHJvbGxlcignRGlubmVyQ29udHJvbGxlcicsIGZ1bmN0aW9uKERpc2hTZXJ2aWNlKSB7XG4gICAgICAgICd1c2Ugc3RyaWN0JztcbiAgICAgICAgdmFyIHZtID0gdGhpcztcblxuICAgIH0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ3NwaWN5VGFzdGUnKVxuICAgIC8vY29udHJvbGxlciBhcHBsaWVkIHRvIGRpc2ggbGlzdCBwYWdlXG4gICAgLmNvbnRyb2xsZXIoJ0Rpc2hMaXN0Q29udHJvbGxlcicsIGZ1bmN0aW9uKERpc2hTZXJ2aWNlLCBTb2NpYWxTZXJ2aWNlLCAkbG9jYXRpb24pIHtcbiAgICAgICAgdmFyIHZtID0gdGhpcztcblxuICAgICAgICAvL2dyYWIgYWxsIHRoZSBkaXNoZXMgYXQgcGFnZSBsb2FkXG4gICAgICAgIERpc2hTZXJ2aWNlLmFsbCgpLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgLy9iaW5kIHRoZSBkaXNoZXNcbiAgICAgICAgICAgIHZtLmRpc2hlcyA9IGRhdGE7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vZnVuY3Rpb24gdG8gZGVsZXRlIGEgZGlzaFxuICAgICAgICB2bS5kZWxldGVEaXNoID0gZnVuY3Rpb24oaW5kZXgpIHtcbiAgICAgICAgICAgIHZhciBkaXNoID0gdm0uZGlzaGVzW2luZGV4XTtcbiAgICAgICAgICAgIERpc2hTZXJ2aWNlLmRlbGV0ZShkaXNoLl9pZCkuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgdm0uZGlzaGVzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICB2bS5hZGREaXNoID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBEaXNoU2VydmljZS5jcmVhdGUoe1xuICAgICAgICAgICAgICAgIG5hbWU6ICduZXcgZGlzaCdcbiAgICAgICAgICAgIH0pLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKCcvYWRtaW4vZGlzaGVzLycgKyBkYXRhLmRpc2guX2lkKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgdm0uZ29Ub0VkaXQgPSBmdW5jdGlvbihpZCkge1xuICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy9hZG1pbi9kaXNoZXMvJyArIGlkKTtcbiAgICAgICAgfVxuXG4gICAgfSlcbiAgICAvL2NvbnRyb2xsZXIgYXBwbGllZCB0byBkaXNoIGRldGFpbCBwYWdlXG4gICAgLmNvbnRyb2xsZXIoJ0Rpc2hEZXRhaWxDb250cm9sbGVyJywgZnVuY3Rpb24oJHNjb3BlLCAkbG9jYXRpb24sICRyb290U2NvcGUsICRyb3V0ZVBhcmFtcywgJGZpbHRlciwgJG1kRGlhbG9nLCBEaXNoU2VydmljZSwgVXNlclNlcnZpY2UsIFNvY2lhbFNlcnZpY2UpIHtcbiAgICAgICAgdmFyIHZtID0gdGhpcztcbiAgICAgICAgdm0uZGlzaCA9IHt9O1xuICAgICAgICBpbml0KCk7XG5cbiAgICAgICAgdm0uZW50ZXJGbGlwQm9vayA9IGZ1bmN0aW9uKGV2bikge1xuICAgICAgICAgICAgJG1kRGlhbG9nLnNob3coe1xuICAgICAgICAgICAgICAgIHRhcmdldEV2ZW50OiBldm4sXG4gICAgICAgICAgICAgICAgY2xpY2tPdXRzaWRlVG9DbG9zZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25nL3ZpZXdzL2RpYWxvZ3MvZmxpcGJvb2suaHRtbCcsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ0Rpc2hEZXRhaWxDb250cm9sbGVyJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6ICdib29rJ1xuICAgICAgICAgICAgfSkuZmluYWxseShmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLnNob3duQm9vayA9IGZhbHNlO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICRyb290U2NvcGUuc2hvd25Cb29rID0gdHJ1ZTtcbiAgICAgICAgfTtcblxuICAgICAgICAvL2NhbGwgYm9va2xldCBwbHVnaW5cbiAgICAgICAgJHNjb3BlLiRvbignb25SZXBlYXRMYXN0JywgZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHJzKSB7XG4gICAgICAgICAgICBhbmd1bGFyLmVsZW1lbnQoZWxlbWVudCkucGFyZW50cygnI2Rpc2hCb29rJykuYm9va2xldCh7XG4gICAgICAgICAgICAgICAgd2lkdGg6ICcxMDAlJyxcbiAgICAgICAgICAgICAgICBoZWlnaHQ6IDYwMCxcbiAgICAgICAgICAgICAgICBjbG9zZWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgYXV0b0NlbnRlcjogdHJ1ZSxcbiAgICAgICAgICAgICAgICBwYWdlTnVtYmVyczogZmFsc2UsXG4gICAgICAgICAgICAgICAgcGFnZVBhZGRpbmc6IDAsXG4gICAgICAgICAgICAgICAgaG92ZXJXaWR0aDogMTAwXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdm0uY2xvc2VEaWFsb2cgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICRtZERpYWxvZy5jYW5jZWwoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZtLmZiU2hhcmUgPSBmdW5jdGlvbihkaXNoKSB7XG4gICAgICAgICAgICB2YXIgZGlzaExpbmsgPSAkbG9jYXRpb24uYWJzVXJsKCkgKyAnLycgKyBkaXNoLl9pZDtcbiAgICAgICAgICAgIFNvY2lhbFNlcnZpY2UuZmJTaGFyZShkaXNoTGluayk7XG4gICAgICAgIH1cblxuICAgICAgICB2bS5yZXBseSA9IGZ1bmN0aW9uKHVzZXIsICRldmVudCkge1xuICAgICAgICAgICAgdmFyIGNvbW1lbnRUaXRsZSA9ICdAJyArIHVzZXIudXNlck5hbWU7XG4gICAgICAgICAgICBvcGVuQ29tbWVudERpYWxvZyhjb21tZW50VGl0bGUsICRldmVudCwgdXNlci5faWQpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHZtLmNvbGxlY3QgPSBmdW5jdGlvbigkZXZlbnQpIHtcbiAgICAgICAgICAgIGlmICghJHJvb3RTY29wZS5jdXJyZW50VXNlcikge1xuICAgICAgICAgICAgICAgICRzY29wZS5zaG93TG9naW5EaWFsb2coJGV2ZW50LCB0cnVlLCAnTG9naW4vU2lnblVwIGZpcnN0IHRvIHNhdmUgYXMgZmF2b3JpdGUnKS50aGVuKGZ1bmN0aW9uKHVzZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5jdXJyZW50VXNlciA9IHVzZXI7XG5cbiAgICAgICAgICAgICAgICAgICAgVXNlclNlcnZpY2UuY29sbGVjdCh2bS5kaXNoLl9pZCkudGhlbihmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5zdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdm0uZGlzaC5pc0NvbGxlY3RlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIFVzZXJTZXJ2aWNlLmNvbGxlY3Qodm0uZGlzaC5faWQpLnRoZW4oZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5zdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2bS5kaXNoLmlzQ29sbGVjdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgdm0uc2hvd0luc3RydWN0aW9uUGhvdG8gPSBmdW5jdGlvbihwaG90b1VybCwgJGV2ZW50KSB7XG4gICAgICAgICAgICBpZiAocGhvdG9VcmwgPT0gbnVsbCB8fCBwaG90b1VybC50cmltKCkgPT0gJycpXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuXG4gICAgICAgICAgICAkbWREaWFsb2cuc2hvdyh7XG4gICAgICAgICAgICAgICAgdGFyZ2V0RXZlbnQ6ICRldmVudCxcbiAgICAgICAgICAgICAgICBjbGlja091dHNpZGVUb0Nsb3NlOiB0cnVlLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlOiAnPG1kLWRpYWxvZz4nICtcbiAgICAgICAgICAgICAgICAgICAgJzxtZC1kaWFsb2ctY29udGVudD48aW1nIHNyYz1cInt7cGhvdG99fVwiPjwvbWQtZGlhbG9nLWNvbnRlbnQ+JyArXG4gICAgICAgICAgICAgICAgICAgICc8L21kLWRpYWxvZz4nLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6IGZ1bmN0aW9uIERpYWxvZ0N0cigkc2NvcGUpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnBob3RvID0gcGhvdG9Vcmw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICB2bS5uZXdDb21tZW50ID0gZnVuY3Rpb24oJGV2ZW50KSB7XG4gICAgICAgICAgICBpZiAoISRyb290U2NvcGUuY3VycmVudFVzZXIpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2hvd0xvZ2luRGlhbG9nKCRldmVudCwgdHJ1ZSwgJ0xvZ2luL1NpZ25VcCBmaXJzdCB0byBsZWF2ZSBhIGNvbW1lbnQnKS50aGVuKGZ1bmN0aW9uKHVzZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5jdXJyZW50VXNlciA9IHVzZXI7XG4gICAgICAgICAgICAgICAgICAgIG9wZW5Db21tZW50RGlhbG9nKCdDb21tZW50JywgJGV2ZW50LCBudWxsKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBvcGVuQ29tbWVudERpYWxvZygnQ29tbWVudCcsICRldmVudCwgbnVsbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBpbml0KCkge1xuICAgICAgICAgICAgdm0uZGlzaCA9IHt9O1xuICAgICAgICAgICAgdm0ucmVsYXRlZERpc2hlcyA9IHt9O1xuXG4gICAgICAgICAgICAvL2dldCB0aGUgZGlzaCBieSBpZFxuICAgICAgICAgICAgRGlzaFNlcnZpY2UuZ2V0KCRyb3V0ZVBhcmFtcy5kaXNoX2lkKS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICB2bS5kaXNoID0gZGF0YTtcbiAgICAgICAgICAgICAgICB2bS5kaXNoLmlzQ29sbGVjdGVkID0gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICAvL2dldCB0aGUgMyByZWxhdGVkIGRpc2hlc1xuICAgICAgICAgICAgICAgIERpc2hTZXJ2aWNlLnJlbGF0ZSh2bS5kaXNoLl9pZCwgdm0uZGlzaC50YWdzLCAzKS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgdm0ucmVsYXRlZERpc2hlcyA9IGRhdGE7XG4gICAgICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgICAgIGlmICgkcm9vdFNjb3BlLmN1cnJlbnRVc2VyKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBmb3VuZCA9ICRmaWx0ZXIoJ2ZpbHRlcicpKCRyb290U2NvcGUuY3VycmVudFVzZXIuZmF2b3VyaXRlRGlzaGVzLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfaWQ6IHZtLmRpc2guX2lkXG4gICAgICAgICAgICAgICAgICAgIH0sIHRydWUpO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChmb3VuZC5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZtLmRpc2guaXNDb2xsZWN0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIG9wZW5Db21tZW50RGlhbG9nKHRpdGxlLCAkZXZlbnQsIHJlcGx5VG8pIHtcbiAgICAgICAgICAgICRtZERpYWxvZy5zaG93KHtcbiAgICAgICAgICAgICAgICB0YXJnZXRFdmVudDogJGV2ZW50LFxuICAgICAgICAgICAgICAgIGNsaWNrT3V0c2lkZVRvQ2xvc2U6IHRydWUsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICduZy92aWV3cy9kaWFsb2dzL2NvbW1lbnQuaHRtbCcsXG4gICAgICAgICAgICAgICAgbG9jYWxzOiB7XG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiB0aXRsZVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogY29tbWVudENvbnRyb2xsZXIsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiAnY29tbWVudCdcbiAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24oY29udGVudCkge1xuICAgICAgICAgICAgICAgIERpc2hTZXJ2aWNlLmFkZENvbW1lbnQodm0uZGlzaC5faWQsIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGVudDogY29udGVudCxcbiAgICAgICAgICAgICAgICAgICAgcmVwbHlUbzogcmVwbHlUb1xuICAgICAgICAgICAgICAgIH0pLnN1Y2Nlc3MoZnVuY3Rpb24oY29tbWVudCkge1xuICAgICAgICAgICAgICAgICAgICB2bS5kaXNoLmNvbW1lbnRzLnB1c2goY29tbWVudCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGNvbW1lbnRDb250cm9sbGVyKHRpdGxlLCAkbWREaWFsb2cpIHtcbiAgICAgICAgICAgIHZhciBkdm0gPSB0aGlzO1xuICAgICAgICAgICAgZHZtLmNvbnRlbnQgPSAnJztcbiAgICAgICAgICAgIGR2bS50aXRsZSA9IHRpdGxlO1xuXG4gICAgICAgICAgICBkdm0uY2xvc2VEaWFsb2cgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAkbWREaWFsb2cuY2FuY2VsKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGR2bS5zdWJtaXQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBpZiAoZHZtLmNvbnRlbnQudHJpbSgpID09ICcnKVxuICAgICAgICAgICAgICAgICAgICAkbWREaWFsb2cuY2FuY2VsKClcbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgICRtZERpYWxvZy5oaWRlKGR2bS5jb250ZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pXG4gICAgLy9jb250cm9sbGVyIGFwcGxpZWQgdG8gZGlzaCBlZGl0IHBhZ2VcbiAgICAuY29udHJvbGxlcignRGlzaEVkaXRDb250cm9sbGVyJywgZnVuY3Rpb24oJG1kRGlhbG9nLCAkcm91dGVQYXJhbXMsIERpc2hTZXJ2aWNlLCAkbG9jYXRpb24sICR0aW1lb3V0KSB7XG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG4gICAgICAgIGluaXQoKTtcblxuICAgICAgICB2bS5zYXZlRGlzaCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgRGlzaFNlcnZpY2UudXBkYXRlKCRyb3V0ZVBhcmFtcy5kaXNoX2lkLCB2bS5kaXNoKS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICB2bS51cGRhdGVTdWNjZXNzID0gdHJ1ZTtcblxuICAgICAgICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICB2bS51cGRhdGVTdWNjZXNzID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfSwgMTAwMCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICB9XG5cbiAgICAgICAgdm0ucmVtb3ZlSW5zdHJ1Y3Rpb24gPSBmdW5jdGlvbihpbmRleCkge1xuICAgICAgICAgICAgRGlzaFNlcnZpY2UucmVtb3ZlSW5zdHJ1Y3Rpb24oJHJvdXRlUGFyYW1zLmRpc2hfaWQsIHZtLmRpc2guaW5zdHJ1Y3Rpb25zW2luZGV4XS5faWQpLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgIHZtLmRpc2guaW5zdHJ1Y3Rpb25zLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZtLnJlbW92ZVBob3RvID0gZnVuY3Rpb24oaW5kZXgpIHtcbiAgICAgICAgICAgIHZtLmRpc2gucGhvdG9zLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICB2bS5zYXZlRGlzaCgpO1xuICAgICAgICB9XG5cbiAgICAgICAgdm0uc2hvd0FkZFBob3RvRGlhbG9nID0gZnVuY3Rpb24oZXZuKSB7XG4gICAgICAgICAgICAkbWREaWFsb2cuc2hvdyh7XG4gICAgICAgICAgICAgICAgdGFyZ2V0RXZlbnQ6IGV2bixcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiBwaG90b0RpYWxvZ0NvbnRyb2xsZXIsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiAncGhvdG9EbGcnLFxuICAgICAgICAgICAgICAgIGNsaWNrT3V0c2lkZVRvQ2xvc2U6IHRydWUsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICduZy92aWV3cy9kaWFsb2dzL2FkZFBob3RvLmh0bWwnXG4gICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uKG5ld1Bob3RvKSB7XG4gICAgICAgICAgICAgICAgdm0uZGlzaC5waG90b3MucHVzaChuZXdQaG90byk7XG4gICAgICAgICAgICAgICAgdm0uc2F2ZURpc2goKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgdm0uc2hvd0FkZEluc3RydWN0aW9uRGlhbG9nID0gZnVuY3Rpb24oZXZuKSB7XG4gICAgICAgICAgICAkbWREaWFsb2cuc2hvdyh7XG4gICAgICAgICAgICAgICAgdGFyZ2V0RXZlbnQ6IGV2bixcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiBpbnN0cnVjdGlvbkRpYWxvZ0NvbnRyb2xsZXIsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiAnaW5zdHJ1Y3Rpb25EbGcnLFxuICAgICAgICAgICAgICAgIGNsaWNrT3V0c2lkZVRvQ2xvc2U6IHRydWUsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICduZy92aWV3cy9kaWFsb2dzL2FkZEluc3RydWN0aW9uLmh0bWwnXG4gICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uKG5ld0luc3RydWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgdm0uZGlzaC5pbnN0cnVjdGlvbnMucHVzaChuZXdJbnN0cnVjdGlvbik7XG4gICAgICAgICAgICAgICAgRGlzaFNlcnZpY2UuYWRkSW5zdHJ1Y3Rpb24oJHJvdXRlUGFyYW1zLmRpc2hfaWQsIG5ld0luc3RydWN0aW9uKS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBwaG90b0RpYWxvZ0NvbnRyb2xsZXIoJG1kRGlhbG9nKSB7XG4gICAgICAgICAgICB2YXIgZHZtID0gdGhpcztcbiAgICAgICAgICAgIGR2bS5uZXdQaG90byA9ICcnO1xuXG4gICAgICAgICAgICBkdm0uY2xvc2VEaWFsb2cgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAkbWREaWFsb2cuY2FuY2VsKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGR2bS5zdWJtaXQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAkbWREaWFsb2cuaGlkZShkdm0ubmV3UGhvdG8pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gaW5zdHJ1Y3Rpb25EaWFsb2dDb250cm9sbGVyKCRtZERpYWxvZykge1xuICAgICAgICAgICAgdmFyIGR2bSA9IHRoaXM7XG5cbiAgICAgICAgICAgIGR2bS5uZXdJbnN0cnVjdGlvbiA9IHtcbiAgICAgICAgICAgICAgICBwaG90bzogJycsXG4gICAgICAgICAgICAgICAgdGV4dDogJydcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGR2bS5jbG9zZURpYWxvZyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICRtZERpYWxvZy5jYW5jZWwoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZHZtLnN1Ym1pdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICRtZERpYWxvZy5oaWRlKGR2bS5uZXdJbnN0cnVjdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBpbml0KCkge1xuICAgICAgICAgICAgLy9nZXQgdGhlIGRpc2ggYnkgaWRcbiAgICAgICAgICAgIERpc2hTZXJ2aWNlLmdldCgkcm91dGVQYXJhbXMuZGlzaF9pZCkuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgdm0uZGlzaCA9IGRhdGE7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHZtLmRpZmZpY3VsdGllcyA9IERpc2hTZXJ2aWNlLmdldERpZmZpY3VsdGllcygpO1xuICAgICAgICB9XG4gICAgfSk7XG4iLG51bGwsImFuZ3VsYXIubW9kdWxlKCdzcGljeVRhc3RlJylcbiAgICAuY29udHJvbGxlcignSG9tZUNvbnRyb2xsZXInLCBmdW5jdGlvbigkc2NvcGUsICRtZE1lZGlhLCBEaXNoU2VydmljZSwgQ09OU1RBTlRTKSB7XG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG4gICAgICAgIGluaXQoKTtcblxuICAgICAgICBmdW5jdGlvbiBpbml0KCkge1xuICAgICAgICAgICAgdm0ucmVjaXBlVGlsZXMgPSBbXTtcbiAgICAgICAgICAgICRzY29wZS4kd2F0Y2goZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICRtZE1lZGlhKCdzbScpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24oaXNTbWFsbCkge1xuICAgICAgICAgICAgICAgICRzY29wZS5zbWFsbFNjcmVlbiA9IGlzU21hbGw7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgYnVpbGRHcmlkKCk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBidWlsZEdyaWQoKSB7XG4gICAgICAgICAgICBEaXNoU2VydmljZS5saW1pdChDT05TVEFOVFMuTEFURVNUX0NPVU5UKS5zdWNjZXNzKGZ1bmN0aW9uKGRpc2hlcykge1xuICAgICAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChkaXNoZXMsIGZ1bmN0aW9uKGRpc2gsIGluZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0aWxlID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgaW1hZ2U6IGRpc2guaW1hZ2VVcmwsXG4gICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogZGlzaC5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IGRpc2guX2lkLFxuICAgICAgICAgICAgICAgICAgICAgICAgcHJlcFRpbWU6IGRpc2gucHJlcFRpbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICB0b3RhbFRpbWU6IGRpc2gudG90YWxUaW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGlmZmljdWx0eTogZGlzaC5kaWZmaWN1bHR5LFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnczogZGlzaC50YWdzLFxuICAgICAgICAgICAgICAgICAgICAgICAgc3Bhbjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvdzogMSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2w6IDFcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKGluZGV4ICsgMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpbGUuc3Bhbi5yb3cgPSB0aWxlLnNwYW4uY29sID0gMjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aWxlLnNwYW4uY29sID0gMjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNTpcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aWxlLnNwYW4ucm93ID0gdGlsZS5zcGFuLmNvbCA9IDI7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDg6XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDk6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDEwOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpbGUuc3Bhbi5jb2wgPSAyO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgdm0ucmVjaXBlVGlsZXMucHVzaCh0aWxlKTtcblxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgIH0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ3NwaWN5VGFzdGUnKVxuICAgIC5jb250cm9sbGVyKCdNYWluQ29udHJvbGxlcicsIGZ1bmN0aW9uKCRyb290U2NvcGUsICRzY29wZSwgJGxvY2F0aW9uLCAkbWREaWFsb2csICRodHRwLCBTZXNzaW9uU2VydmljZSwgVXNlclNlcnZpY2UsIENPTlNUQU5UUykge1xuICAgICAgICAndXNlIHN0cmljdCc7XG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG4gICAgICAgIGluaXQoKTtcblxuICAgICAgICB2bS50b2dnbGVNb2JpbGVNZW51ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2bS5zaG93TW9iaWxlTWVudSA9ICF2bS5zaG93TW9iaWxlTWVudTtcbiAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUuc2V0TWVudUJhciA9IGZ1bmN0aW9uKG1lbnVCYXIpIHtcbiAgICAgICAgICAgIHZtLm1lbnVCYXIgPSBtZW51QmFyO1xuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS5zaG93TG9naW5EaWFsb2cgPSBmdW5jdGlvbihldiwgcG9zdExvZ2luLCB0aXRsZSkge1xuICAgICAgICAgICAgdmFyIHByb21pc2UgPSAkbWREaWFsb2cuc2hvdyh7XG4gICAgICAgICAgICAgICAgY2xpY2tPdXRzaWRlVG9DbG9zZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ25nL3ZpZXdzL2RpYWxvZ3MvbG9naW4uaHRtbCcsXG4gICAgICAgICAgICAgICAgdGFyZ2V0RXZlbnQ6IGV2LFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6IGxvZ2luQ29udHJvbGxlcixcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6ICdsb2dpbicsXG4gICAgICAgICAgICAgICAgbG9jYWxzOiB7XG4gICAgICAgICAgICAgICAgICAgIGRpYWxvZ1RpdGxlOiB0aXRsZVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYgKHBvc3RMb2dpbikge1xuICAgICAgICAgICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBwcm9taXNlLnRoZW4oZnVuY3Rpb24odXNlcikge1xuICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmN1cnJlbnRVc2VyID0gdXNlcjtcbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgKHVzZXIucm9sZSAmJiB1c2VyLnJvbGUgPT0gXCJBZG1pblwiKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAkbG9jYXRpb24ucGF0aCgnL2FkbWluL2Rpc2hlcycpO1xuICAgICAgICAgICAgICAgICAgICAvLyB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvLyAgICAgJGxvY2F0aW9uLnBhdGgoJy8nKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIGZ1bmN0aW9uIGxvZ2luQ29udHJvbGxlcihkaWFsb2dUaXRsZSwgJG1kRGlhbG9nLCBVc2VyU2VydmljZSwgbWQ1KSB7XG4gICAgICAgICAgICB2YXIgZHZtID0gdGhpcztcbiAgICAgICAgICAgIGR2bS50aXRsZSA9IGRpYWxvZ1RpdGxlO1xuICAgICAgICAgICAgZHZtLmVtYWlsID0gJyc7XG4gICAgICAgICAgICBkdm0ucGFzc3dvcmQgPSAnJztcbiAgICAgICAgICAgIGR2bS51c2VyTmFtZSA9ICcnO1xuXG4gICAgICAgICAgICBkdm0uZmJMb2dpbiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIEZCLmxvZ2luKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09ICdjb25uZWN0ZWQnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBMb2dnZWQgaW50byB5b3VyIGFwcCBhbmQgRmFjZWJvb2suXG4gICAgICAgICAgICAgICAgICAgICAgICBGQi5hcGkoJy9tZScsIGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZiVXNlciA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlck5hbWU6IHJlc3BvbnNlLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVtYWlsOiByZXNwb25zZS5lbWFpbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFzc3dvcmQ6IENPTlNUQU5UUy5TT0NJQUxfUEFTUyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGhvdG9Vcmw6ICdodHRwOi8vZ3JhcGguZmFjZWJvb2suY29tLycgKyByZXNwb25zZS5pZCArICcvcGljdHVyZT90eXBlPWxhcmdlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlua2VkU29jaWFsOiBDT05TVEFOVFMuRkFDRUJPT0tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgVXNlclNlcnZpY2Uuc29jaWFsTG9naW4oZmJVc2VyKS50aGVuKGZ1bmN0aW9uKHVzZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlci5sb2dpblR5cGUgPSBDT05TVEFOVFMuRkFDRUJPT0s7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFmdGVyQXV0aCh1c2VyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSAnbm90X2F1dGhvcml6ZWQnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBUaGUgcGVyc29uIGlzIGxvZ2dlZCBpbnRvIEZhY2Vib29rLCBidXQgbm90IHlvdXIgYXBwLlxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhlIHBlcnNvbiBpcyBub3QgbG9nZ2VkIGludG8gRmFjZWJvb2ssIHNvIHdlJ3JlIG5vdCBzdXJlIGlmXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGV5IGFyZSBsb2dnZWQgaW50byB0aGlzIGFwcCBvciBub3QuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlOiAncHVibGljX3Byb2ZpbGUsZW1haWwnXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBkdm0ubG9naW4gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBVc2VyU2VydmljZS5sb2dpbihkdm0uZW1haWwsIGR2bS5wYXNzd29yZCkudGhlbihmdW5jdGlvbih1c2VyKSB7XG4gICAgICAgICAgICAgICAgICAgIHVzZXIubG9naW5UeXBlID0gQ09OU1RBTlRTLkVNQUlMO1xuICAgICAgICAgICAgICAgICAgICBhZnRlckF1dGgodXNlcik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBkdm0uc2lnblVwID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgdmFyIG5ld1VzZXIgPSB7XG4gICAgICAgICAgICAgICAgICAgIHVzZXJOYW1lOiBkdm0udXNlck5hbWUsXG4gICAgICAgICAgICAgICAgICAgIGVtYWlsOiBkdm0uZW1haWwsXG4gICAgICAgICAgICAgICAgICAgIHBhc3N3b3JkOiBkdm0ucGFzc3dvcmQsXG4gICAgICAgICAgICAgICAgICAgIHBob3RvVXJsOiAnaHR0cDovL3d3dy5ncmF2YXRhci5jb20vYXZhdGFyLycgKyBtZDUuY3JlYXRlSGFzaChkdm0uZW1haWwpLFxuICAgICAgICAgICAgICAgICAgICBsaW5rZWRTb2NpYWw6IENPTlNUQU5UUy5FTUFJTFxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICBVc2VyU2VydmljZS5jcmVhdGUobmV3VXNlcikudGhlbihmdW5jdGlvbih1c2VyKSB7XG4gICAgICAgICAgICAgICAgICAgIHVzZXIubG9naW5UeXBlID0gQ09OU1RBTlRTLkVNQUlMO1xuICAgICAgICAgICAgICAgICAgICBhZnRlckF1dGgodXNlcik7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGFmdGVyQXV0aCh1c2VyKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRva2VuID0gJGh0dHAuZGVmYXVsdHMuaGVhZGVycy5jb21tb25bJ1gtQXV0aCddO1xuICAgICAgICAgICAgICAgIFNlc3Npb25TZXJ2aWNlLnNldExvY2FsKENPTlNUQU5UUy5MT0NBTF9TVE9SQUdFX0tFWSwgdG9rZW4pO1xuICAgICAgICAgICAgICAgICRtZERpYWxvZy5oaWRlKHVzZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gaW5pdCgpIHtcbiAgICAgICAgICAgIHZtLnNob3dNb2JpbGVNZW51ID0gZmFsc2U7XG4gICAgICAgICAgICB2bS5zY3JvbGxUYXJnZXRSZWFjaGVkID0gZmFsc2U7XG4gICAgICAgICAgICB2bS5tZW51QmFyID0ge1xuICAgICAgICAgICAgICAgIHByaW1hcnlUaGVtZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgaGlkZGVuOiBmYWxzZSxcbiAgICAgICAgICAgICAgICB0ZXh0OiAnU1BJQ1kgVEFTVEUnXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB2YXIgbG9naW5lZFRva2VuID0gU2Vzc2lvblNlcnZpY2UuZ2V0TG9jYWwoQ09OU1RBTlRTLkxPQ0FMX1NUT1JBR0VfS0VZKTtcbiAgICAgICAgICAgIGlmIChsb2dpbmVkVG9rZW4pIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygndG9rZW4nLCBsb2dpbmVkVG9rZW4pO1xuXG4gICAgICAgICAgICAgICAgJGh0dHAuZGVmYXVsdHMuaGVhZGVycy5jb21tb25bJ1gtQXV0aCddID0gbG9naW5lZFRva2VuO1xuICAgICAgICAgICAgICAgIFVzZXJTZXJ2aWNlLmdldEN1cnJlbnRVc2VyKCkudGhlbihmdW5jdGlvbih1c2VyKSB7XG4gICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuY3VycmVudFVzZXIgPSB1c2VyO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICB9KTtcbiIsImFuZ3VsYXIubW9kdWxlKCdzcGljeVRhc3RlJylcbiAgICAuY29udHJvbGxlcignUHJvZmlsZUNvbnRyb2xsZXInLCBmdW5jdGlvbigkbG9jYXRpb24sICRyb290U2NvcGUsIFVzZXJTZXJ2aWNlKSB7XG4gICAgICAgICd1c2Ugc3RyaWN0JztcblxuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuICAgICAgICBpbml0KCk7XG5cbiAgICAgICAgdm0ubG9nb3V0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBVc2VyU2VydmljZS5sb2dvdXQoKTtcbiAgICAgICAgICAgICRyb290U2NvcGUuY3VycmVudFVzZXIgPSBudWxsO1xuICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy8nKTtcbiAgICAgICAgfTtcblxuICAgICAgICBmdW5jdGlvbiBpbml0KCkge1xuICAgICAgICAgICAgdm0udXNlciA9IHt9O1xuICAgICAgICAgICAgVXNlclNlcnZpY2UuZ2V0QnlJZCgkcm9vdFNjb3BlLmN1cnJlbnRVc2VyLl9pZCkudGhlbihmdW5jdGlvbih1c2VyKSB7XG4gICAgICAgICAgICAgICAgdm0udXNlciA9IHVzZXI7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgfSk7XG4iLCJhbmd1bGFyLm1vZHVsZSgnc3BpY3lUYXN0ZScpXG4gICAgLmRpcmVjdGl2ZSgnY29udGVudGVkaXRhYmxlJywgZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByZXF1aXJlOiAnbmdNb2RlbCcsXG4gICAgICAgICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgICAgICAgbGluazogZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHJpYnV0cywgbmdNb2RlbCkge1xuICAgICAgICAgICAgICAgIG5nTW9kZWwuJHJlbmRlciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICBlbGVtZW50Lmh0bWwobmdNb2RlbC4kdmlld1ZhbHVlIHx8ICcnKTtcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgZWxlbWVudC5iaW5kKCdibHVyJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLiRhcHBseShmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5nTW9kZWwuJHNldFZpZXdWYWx1ZShlbGVtZW50Lmh0bWwoKSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ3NwaWN5VGFzdGUnKVxuICAgIC5kaXJlY3RpdmUoJ2ZsaXBib29rJywgZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB0cmFuc2NsdWRlOiBmYWxzZSxcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgICAgICByZXBsYWNlOiB0cnVlLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICduZy92aWV3cy90ZW1wbGF0ZXMvZmxpcGJvb2suaHRtbCcsXG4gICAgICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgICAgIGRpc2g6ICc9J1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSlcbiIsImFuZ3VsYXIubW9kdWxlKCdzcGljeVRhc3RlJylcbiAgICAuZGlyZWN0aXZlKCdmb2N1c09uJywgZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgICAgICBmb2N1c1ZhbHVlOiBcIj1mb2N1c09uXCJcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBsaW5rOiBmdW5jdGlvbigkc2NvcGUsICRlbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLiR3YXRjaCgnZm9jdXNWYWx1ZScsIGZ1bmN0aW9uKGN1cnJlbnRWYWx1ZSwgcHJldmlvdXNWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudFZhbHVlICYmICFwcmV2aW91c1ZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkZWxlbWVudFswXS5mb2N1cygpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfSk7XG4iLCJhbmd1bGFyLm1vZHVsZSgnc3BpY3lUYXN0ZScpXG4gICAgLmRpcmVjdGl2ZSgnb25MYXN0UmVwZWF0JywgZnVuY3Rpb24oJHRpbWVvdXQpIHtcbiAgICAgICAgJ3VzZSBzdHJpY3QnO1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24oJHNjb3BlLCAkZWxlbWVudCwgJGF0dHJzKSB7XG4gICAgICAgICAgICBpZiAoJHNjb3BlLiRsYXN0KSB7XG4gICAgICAgICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS4kZW1pdCgnb25SZXBlYXRMYXN0JywgJGVsZW1lbnQsICRhdHRycyk7XG4gICAgICAgICAgICAgICAgfSwgMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfSk7XG4iLCJhbmd1bGFyLm1vZHVsZSgnc3BpY3lUYXN0ZScpXG4gICAgLmRpcmVjdGl2ZSgnc2Nyb2xsVG8nLCBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICAgICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgJGVsZW1lbnQsIGF0dHJzKSB7XG4gICAgICAgICAgICAgICAgdmFyICR0YXJnZXQgPSAkKGF0dHJzLnNjcm9sbFRvKTtcbiAgICAgICAgICAgICAgICAkZWxlbWVudC5vbignY2xpY2snLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgJCgnaHRtbCwgYm9keScpLmFuaW1hdGUoe1xuICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsVG9wOiAkdGFyZ2V0Lm9mZnNldCgpLnRvcFxuICAgICAgICAgICAgICAgICAgICB9LCA2MDApO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ3NwaWN5VGFzdGUnKVxuICAgIC5kaXJlY3RpdmUoJ3Nob3dUaW1lJywgZnVuY3Rpb24oJHdpbmRvdykge1xuICAgICAgICAndXNlIHN0cmljdCc7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgICAgICAgc2NvcGU6IHRydWUsXG4gICAgICAgICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgJGVsZW1lbnQsICRhdHRycykge1xuICAgICAgICAgICAgICAgIHZhciBzaG93VGltZSA9IHNjb3BlLiRldmFsKCRhdHRycy5zaG93VGltZSk7XG4gICAgICAgICAgICAgICAgdmFyIG9mZnNldCA9IDA7XG4gICAgICAgICAgICAgICAgaWYgKCFhbmd1bGFyLmlzVW5kZWZpbmVkKHNob3dUaW1lKSkge1xuICAgICAgICAgICAgICAgICAgICBvZmZzZXQgPSBzaG93VGltZS5vZmZzZXQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgYW5ndWxhci5lbGVtZW50KCR3aW5kb3cpLm9uKCdzY3JvbGwnLCBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICgkZWxlbWVudC5oYXNDbGFzcygndmlld2VkJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIHZhciBkb2NUb3AgPSBhbmd1bGFyLmVsZW1lbnQoJHdpbmRvdykuc2Nyb2xsVG9wKCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkb2NCb3R0b20gPSBkb2NUb3AgKyBhbmd1bGFyLmVsZW1lbnQoJHdpbmRvdykuaGVpZ2h0KCk7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGVsZW1Ub3AgPSAkZWxlbWVudC5vZmZzZXQoKS50b3A7XG4gICAgICAgICAgICAgICAgICAgIHZhciBlbGVtQm90dG9tID0gZWxlbVRvcCArICRlbGVtZW50LmhlaWdodCgpO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChvZmZzZXQgIT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkb2NUb3AgLSBlbGVtVG9wID49IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBzY3JvbGxpbmcgdXAgZnJvbSBib3R0b21cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtVG9wICs9IG9mZnNldDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2Nyb2xsaW5nIGRvd24gZnJvbSB0b3BcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtQm90dG9tIC09IG9mZnNldDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGlmIChlbGVtQm90dG9tIDw9IGRvY0JvdHRvbSAmJiBlbGVtVG9wID49IGRvY1RvcCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJGVsZW1lbnQucmVtb3ZlQ2xhc3MoJ25vdFZpZXdlZCcpLmFkZENsYXNzKCd2aWV3ZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfSk7XG4iLCJhbmd1bGFyLm1vZHVsZSgnc3BpY3lUYXN0ZScpXG4gICAgLmRpcmVjdGl2ZSgndG9wTWVudVJlYWNoZWQnLCBmdW5jdGlvbigkd2luZG93KSB7XG4gICAgICAgICd1c2Ugc3RyaWN0JztcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICAgICAgICBzY29wZTogdHJ1ZSxcbiAgICAgICAgICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCAkZWxlbWVudCwgYXR0cnMpIHtcbiAgICAgICAgICAgICAgICB2YXIgb2Zmc2V0ID0gJGVsZW1lbnQub2Zmc2V0KCkudG9wIC0gNjQ7XG4gICAgICAgICAgICAgICAgdmFyIGRlZmF1bHRNZW51QmFyID0ge1xuICAgICAgICAgICAgICAgICAgICBwcmltYXJ5VGhlbWU6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBoaWRkZW46IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICB0ZXh0OiAnc3BpY3kgdGFzdGUnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB2YXIgbWVudUJhciA9IHNjb3BlLiRldmFsKGF0dHJzLnRvcE1lbnVSZWFjaGVkKTtcblxuICAgICAgICAgICAgICAgIGFuZ3VsYXIuZWxlbWVudCgkd2luZG93KS5vbignc2Nyb2xsJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnBhZ2VZT2Zmc2V0ID49IG9mZnNldCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuc2V0TWVudUJhcihtZW51QmFyKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLnNldE1lbnVCYXIoZGVmYXVsdE1lbnVCYXIpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLiRhcHBseSgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ3NwaWN5VGFzdGUnKVxuICAgIC5mYWN0b3J5KCdEaXNoU2VydmljZScsIGZ1bmN0aW9uKCRodHRwKSB7XG5cbiAgICAgICAgLy9jcmVhdGUgYSBuZXcgb2JqZWN0XG4gICAgICAgIHZhciBkaXNoRmFjdG9yeSA9IHt9O1xuXG4gICAgICAgIC8vZ2V0IGFsbCBkaXNoZXNcbiAgICAgICAgZGlzaEZhY3RvcnkuYWxsID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL2Rpc2hlcycpO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vZ2V0IGxpbWl0ZWQgbGF0ZXN0IGRpc2hlc1xuICAgICAgICBkaXNoRmFjdG9yeS5saW1pdCA9IGZ1bmN0aW9uKG51bSkge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS9kaXNoZXM/bGltaXQ9JyArIG51bSk7XG4gICAgICAgIH1cblxuICAgICAgICAvL2dldCByZWxhdGVkIGRpc2hlcyBieSB0YWdzXG4gICAgICAgIGRpc2hGYWN0b3J5LnJlbGF0ZSA9IGZ1bmN0aW9uKGlkLCB0YWdzLCBudW0pIHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cCh7XG4gICAgICAgICAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAgICAgICAgICB1cmw6ICcvYXBpL2Rpc2hlcycsXG4gICAgICAgICAgICAgICAgcGFyYW1zOiB7XG4gICAgICAgICAgICAgICAgICAgIGlkOiBpZCxcbiAgICAgICAgICAgICAgICAgICAgbGltaXQ6IG51bSxcbiAgICAgICAgICAgICAgICAgICAgJ3RhZ3NbXSc6IHRhZ3NcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vY3JlYXRlIGEgZGlzaFxuICAgICAgICBkaXNoRmFjdG9yeS5jcmVhdGUgPSBmdW5jdGlvbihkaXNoKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9kaXNoZXMnLCBkaXNoKTtcbiAgICAgICAgfTtcblxuICAgICAgICAvL2dldCBhIHNpbmdsZSBkaXNoXG4gICAgICAgIGRpc2hGYWN0b3J5LmdldCA9IGZ1bmN0aW9uKGRpc2hfaWQpIHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvZGlzaGVzLycgKyBkaXNoX2lkKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vdXBkYXRlIGEgZGlzaFxuICAgICAgICBkaXNoRmFjdG9yeS51cGRhdGUgPSBmdW5jdGlvbihkaXNoX2lkLCBkaXNoKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucHV0KCcvYXBpL2Rpc2hlcy8nICsgZGlzaF9pZCwgZGlzaCk7XG4gICAgICAgIH1cblxuICAgICAgICAvL2RlbGV0ZSBhIGRpc2hcbiAgICAgICAgZGlzaEZhY3RvcnkuZGVsZXRlID0gZnVuY3Rpb24oZGlzaF9pZCkge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLmRlbGV0ZSgnL2FwaS9kaXNoZXMvJyArIGRpc2hfaWQpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9hZGQgYSBjb21tZW50XG4gICAgICAgIGRpc2hGYWN0b3J5LmFkZENvbW1lbnQgPSBmdW5jdGlvbihkaXNoX2lkLCBjb21tZW50KSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9kaXNoZXMvJyArIGRpc2hfaWQgKyAnL2NvbW1lbnRzJywgY29tbWVudCk7XG4gICAgICAgIH1cblxuICAgICAgICAvL2FkZCBhIGluc3RydWN0aW9uXG4gICAgICAgIGRpc2hGYWN0b3J5LmFkZEluc3RydWN0aW9uID0gZnVuY3Rpb24oZGlzaF9pZCwgaW5zdHJ1Y3Rpb24pIHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL2Rpc2hlcy8nICsgZGlzaF9pZCArICcvaW5zdHJ1Y3Rpb25zJywgaW5zdHJ1Y3Rpb24pO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9yZW1vdmUgYW4gaW5zdHJ1Y3Rpb25cbiAgICAgICAgZGlzaEZhY3RvcnkucmVtb3ZlSW5zdHJ1Y3Rpb24gPSBmdW5jdGlvbihkaXNoX2lkLCBpbnN0cnVjdGlvbl9pZCkge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLmRlbGV0ZSgnL2FwaS9kaXNoZXMvJyArIGRpc2hfaWQgKyAnL2luc3RydWN0aW9ucy8nICsgaW5zdHJ1Y3Rpb25faWQpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9nZXQgZGlmZmljdWx0eVxuICAgICAgICBkaXNoRmFjdG9yeS5nZXREaWZmaWN1bHRpZXMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiBbJ+WIneWtpicsICflrrnmmJMnLCAn5LiA6IisJywgJ+i+g+mavicsICfkuJPkuJonXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZGlzaEZhY3Rvcnk7XG4gICAgfSk7XG4iLCJhbmd1bGFyLm1vZHVsZSgnc3BpY3lUYXN0ZScpXG4gICAgLmZhY3RvcnkoJ1Nlc3Npb25TZXJ2aWNlJywgZnVuY3Rpb24oJHdpbmRvdykge1xuICAgICAgICB2YXIgc2Vzc2lvbkZhY3RvcnkgPSB7fTtcblxuICAgICAgICBzZXNzaW9uRmFjdG9yeS5nZXRMb2NhbCA9IGZ1bmN0aW9uKGtleSkge1xuICAgICAgICAgICAgaWYgKCR3aW5kb3cubG9jYWxTdG9yYWdlKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRhdGEgPSAkd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKGtleSk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gYW5ndWxhci5mcm9tSnNvbihkYXRhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHNlc3Npb25GYWN0b3J5LnNldExvY2FsID0gZnVuY3Rpb24oa2V5LCBkYXRhKSB7XG4gICAgICAgICAgICByZXR1cm4gJHdpbmRvdy5sb2NhbFN0b3JhZ2UgJiYgJHdpbmRvdy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbShrZXksIGFuZ3VsYXIudG9Kc29uKGRhdGEpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBzZXNzaW9uRmFjdG9yeTtcblxuICAgIH0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ3NwaWN5VGFzdGUnKVxuICAgIC5mYWN0b3J5KCdTb2NpYWxTZXJ2aWNlJywgZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBzb2NpYWxGYWN0b3J5ID0ge307XG5cbiAgICAgICAgc29jaWFsRmFjdG9yeS5mYlNoYXJlID0gZnVuY3Rpb24obGluaykge1xuICAgICAgICAgICAgRkIudWkoe1xuICAgICAgICAgICAgICAgIG1ldGhvZDogJ3NoYXJlJyxcbiAgICAgICAgICAgICAgICBocmVmOiBsaW5rLFxuICAgICAgICAgICAgfSwgZnVuY3Rpb24ocmVzcG9uc2UpIHt9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBzb2NpYWxGYWN0b3J5O1xuICAgIH0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ3NwaWN5VGFzdGUnKVxuICAgIC5mYWN0b3J5KCdVc2VyU2VydmljZScsIGZ1bmN0aW9uKCRodHRwLCAkcm9vdFNjb3BlLCAkd2luZG93LCBDT05TVEFOVFMpIHtcbiAgICAgICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgICAgIHZhciB1c2VyRmFjdG9yeSA9IHt9O1xuXG4gICAgICAgIC8vc29jaWFsIGxvZ2luXG4gICAgICAgIHVzZXJGYWN0b3J5LnNvY2lhbExvZ2luID0gZnVuY3Rpb24oc29jaWFsVXNlcikge1xuICAgICAgICAgICAgcmV0dXJuIHVzZXJGYWN0b3J5LnNlYXJjaEJ5KCdlbWFpbD0nICsgc29jaWFsVXNlci5lbWFpbCkudGhlbihmdW5jdGlvbihkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICBpZiAoIWRhdGEuc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICAvL25vdCBmb3VuZCwgdGhlbiBjcmVhdGVcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVzZXJGYWN0b3J5LmNyZWF0ZShzb2NpYWxVc2VyKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvL2ZvdW5kIHRoZSB1c2VyIHdpdGggZW1haWxcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVzZXJGYWN0b3J5LmxvZ2luKHNvY2lhbFVzZXIuZW1haWwsIENPTlNUQU5UUy5TT0NJQUxfUEFTUyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy9sb2dpbiB1c2VyXG4gICAgICAgIHVzZXJGYWN0b3J5LmxvZ2luID0gZnVuY3Rpb24oZW1haWwsIHBhc3N3b3JkKSB7XG5cbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL2F1dGgnLCB7XG4gICAgICAgICAgICAgICAgZW1haWw6IGVtYWlsLFxuICAgICAgICAgICAgICAgIHBhc3N3b3JkOiBwYXNzd29yZFxuICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICRodHRwLmRlZmF1bHRzLmhlYWRlcnMuY29tbW9uWydYLUF1dGgnXSA9IHJlc3BvbnNlLmRhdGEudG9rZW47XG4gICAgICAgICAgICAgICAgcmV0dXJuIHVzZXJGYWN0b3J5LmdldEJ5SWQocmVzcG9uc2UuZGF0YS51c2VySWQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy9sb2dvdXQgdXNlclxuICAgICAgICB1c2VyRmFjdG9yeS5sb2dvdXQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGRlbGV0ZSAkaHR0cC5kZWZhdWx0cy5oZWFkZXJzLmNvbW1vblsnWC1BdXRoJ107XG4gICAgICAgICAgICAkd2luZG93LmxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKENPTlNUQU5UUy5MT0NBTF9TVE9SQUdFX0tFWSk7XG4gICAgICAgICAgICB1c2VyRmFjdG9yeS5sb2dpbmVkVXNlciA9IG51bGw7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy9zZWFyY2ggdXNlciBieSBmaWVsZFxuICAgICAgICB1c2VyRmFjdG9yeS5zZWFyY2hCeSA9IGZ1bmN0aW9uKHF1ZXJ5KSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3VzZXJzPycgKyBxdWVyeSkudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5kYXRhO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgdXNlckZhY3RvcnkuZ2V0Q3VycmVudFVzZXIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvbWUnKS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHVzZXJGYWN0b3J5LmdldEJ5SWQocmVzcG9uc2UuZGF0YSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICAvL2dldCB1c2VyIGJ5IGlkXG4gICAgICAgIHVzZXJGYWN0b3J5LmdldEJ5SWQgPSBmdW5jdGlvbih1c2VyX2lkKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3VzZXJzLycgKyB1c2VyX2lkKS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGE7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICAvL2NyZWF0ZSBhIG5ldyB1c2VyXG4gICAgICAgIHVzZXJGYWN0b3J5LmNyZWF0ZSA9IGZ1bmN0aW9uKHVzZXIpIHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3VzZXJzLycsIHVzZXIpLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHVzZXJGYWN0b3J5LmxvZ2luKHVzZXIuZW1haWwsIHVzZXIucGFzc3dvcmQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy91cGRhdGUgdXNlclxuICAgICAgICB1c2VyRmFjdG9yeS51cGRhdGUgPSBmdW5jdGlvbih1c2VyKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucHV0KCcvYXBpL3VzZXJzLycgKyB1c2VyLnVzZXJfaWQsIHVzZXIpLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vY29sbGVjdCBkaXNoIGFzIGZhdm91cml0ZVxuICAgICAgICB1c2VyRmFjdG9yeS5jb2xsZWN0ID0gZnVuY3Rpb24oZGlzaF9pZCkge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLnB1dCgnL2FwaS91c2Vycy8nICsgJHJvb3RTY29wZS5jdXJyZW50VXNlci5faWQgKyAnL2Rpc2hlcy8nICsgZGlzaF9pZCkudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5kYXRhO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy9hdXRob3JpemUgdXNlclxuICAgICAgICB1c2VyRmFjdG9yeS5hdXRob3JpemUgPSBmdW5jdGlvbihyZXF1aXJlUGVybWlzc2lvbnMpIHtcbiAgICAgICAgICAgIHJldHVybiB1c2VyRmFjdG9yeS5nZXRDdXJyZW50VXNlcigpLnRoZW4oZnVuY3Rpb24odXNlcikge1xuICAgICAgICAgICAgICAgIGlmICh1c2VyICYmIHJlcXVpcmVQZXJtaXNzaW9ucy5pbmRleE9mKHVzZXIucm9sZSkgPj0gMCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwgZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gdXNlckZhY3Rvcnk7XG4gICAgfSk7XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=